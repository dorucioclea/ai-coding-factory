{
  "$schema": "https://json.schemastore.org/cody.json",
  "commands": {
    "verify": {
      "prompt": "# Verification Command\n\nRun comprehensive verification on current codebase state.\n\n## Instructions\n\nExecute verification in this exact order:\n\n1. **Build Check**\n   - Run the build command for this project\n   - If it fails, report errors and STOP\n\n2. **Type Check**\n   - Run TypeScript/type checker\n   - Report all errors with file:line\n\n3. **Lint Check**\n   - Run linter\n   - Report warnings and errors\n\n4. **Test Suite**\n   - Run all tests\n   - Report pass/fail count\n   - Report coverage percentage\n\n5. **Console.log Audit**\n   - Search for console.log in source files\n   - Report locations\n\n6. **Git Status**\n   - Show uncommitted changes\n   - Show files modified since last commit\n\n## Output\n\nProduce a concise verification report:\n\n```\nVERIFICATION: [PASS/FAIL]\n\nBuild:    [OK/FAIL]\nTypes:    [OK/X errors]\nLint:     [OK/X issues]\nTests:    [X/Y passed, Z% coverage]\nSecrets:  [OK/X found]\nLogs:     [OK/X console.logs]\n\nReady for PR: [YES/NO]\n```\n\nIf any critical issues, list them with fix suggestions.\n\n## Arguments\n\n$ARGUMENTS can be:\n- `quick` - Only build + types\n- `full` - All checks (default)\n- `pre-commit` - Checks relevant for commits\n- `pre-pr` - Full checks plus security scan\n"
    },
    "validate": {
      "prompt": "# /validate - Run All Validation Scripts\n\nExecute all platform validation scripts and report results.\n\n## Usage\n```\n/validate [scope]\n```\n\nWhere scope can be:\n- `all` (default) - Run all validations\n- `project` - Validate project structure only\n- `docs` - Validate documentation only\n- `policy` - Validate R&D policy compliance only\n- `traceability` - Validate story-test-commit linkage only\n- `coverage` - Check code coverage (requires coverage.xml)\n\n## Instructions\n\nWhen invoked, run the appropriate validation scripts:\n\n### Full Validation (`/validate` or `/validate all`)\n\n```bash\n# 1. Project structure validation\n./scripts/validate-project.sh\n\n# 2. Documentation validation\n./scripts/validate-documentation.sh\n\n# 3. R&D Policy validation\n./scripts/validate-rnd-policy.sh\n\n# 4. Traceability validation\npython3 scripts/traceability/traceability.py validate\n\n# 5. If in a .NET project with coverage, check coverage\nif [ -f \"coverage.xml\" ]; then\n    python3 scripts/coverage/check-coverage.py coverage.xml\nfi\n```\n\n### Scoped Validation\n\nFor each scope, run only the relevant script:\n\n- `/validate project`: `./scripts/validate-project.sh`\n- `/validate docs`: `./scripts/validate-documentation.sh`\n- `/validate policy`: `./scripts/validate-rnd-policy.sh`\n- `/validate traceability`: `python3 scripts/traceability/traceability.py validate`\n- `/validate coverage`: `python3 scripts/coverage/check-coverage.py coverage.xml`\n\n## Output Format\n\nProvide a summary report:\n\n```\n## Validation Results\n\n| Check | Status | Details |\n|-------|--------|---------|\n| Project Structure | PASS/FAIL | <details> |\n| Documentation | PASS/FAIL | <details> |\n| R&D Policy | PASS/FAIL | <details> |\n| Traceability | PASS/FAIL | <details> |\n| Coverage | PASS/FAIL/N/A | <details> |\n\n### Summary\n- Total checks: X\n- Passed: X\n- Failed: X\n- Skipped: X\n\n### Required Actions\n<List any failures that need to be addressed>\n```\n\n## Exit Criteria\n\n- All validations must pass before claiming work is complete\n- If any validation fails, list specific remediation steps\n- Do not proceed with commits or releases until all pass\n"
    },
    "update-docs": {
      "prompt": "# Update Documentation\n\nSync documentation from source-of-truth:\n\n1. Read package.json scripts section\n   - Generate scripts reference table\n   - Include descriptions from comments\n\n2. Read .env.example\n   - Extract all environment variables\n   - Document purpose and format\n\n3. Generate docs/CONTRIB.md with:\n   - Development workflow\n   - Available scripts\n   - Environment setup\n   - Testing procedures\n\n4. Generate docs/RUNBOOK.md with:\n   - Deployment procedures\n   - Monitoring and alerts\n   - Common issues and fixes\n   - Rollback procedures\n\n5. Identify obsolete documentation:\n   - Find docs not modified in 90+ days\n   - List for manual review\n\n6. Show diff summary\n\nSingle source of truth: package.json and .env.example\n"
    },
    "update-codemaps": {
      "prompt": "# Update Codemaps\n\nAnalyze the codebase structure and update architecture documentation:\n\n1. Scan all source files for imports, exports, and dependencies\n2. Generate token-lean codemaps in the following format:\n   - codemaps/architecture.md - Overall architecture\n   - codemaps/backend.md - Backend structure  \n   - codemaps/frontend.md - Frontend structure\n   - codemaps/data.md - Data models and schemas\n\n3. Calculate diff percentage from previous version\n4. If changes > 30%, request user approval before updating\n5. Add freshness timestamp to each codemap\n6. Save reports to .reports/codemap-diff.txt\n\nUse TypeScript/Node.js for analysis. Focus on high-level structure, not implementation details.\n"
    },
    "traceability": {
      "prompt": "# /traceability - Generate Traceability Report\n\nGenerate and validate the story ‚Üí test ‚Üí commit ‚Üí release traceability chain.\n\n## Usage\n```\n/traceability [action]\n```\n\nWhere action is:\n- `report` (default) - Generate full traceability report\n- `validate` - Validate linkage without generating report\n- `gaps` - Show only stories missing test coverage\n- `release-notes` - Generate release notes from completed stories\n\n## Instructions\n\n### Generate Report (`/traceability` or `/traceability report`)\n\n```bash\npython3 scripts/traceability/traceability.py report \\\n  --story-root artifacts/stories \\\n  --test-root tests \\\n  --output artifacts/traceability/traceability-report.md\n```\n\n### Validate Linkage (`/traceability validate`)\n\n```bash\npython3 scripts/traceability/traceability.py validate \\\n  --story-root artifacts/stories \\\n  --test-root tests\n```\n\n### Show Gaps (`/traceability gaps`)\n\nParse the validation output and show only:\n- Stories without linked tests\n- Tests without story references\n- Commits without story IDs\n\n### Generate Release Notes (`/traceability release-notes`)\n\n```bash\npython3 scripts/traceability/traceability.py release-notes \\\n  --story-root artifacts/stories \\\n  --output artifacts/traceability/release-notes.md\n```\n\n## Report Format\n\nThe traceability report should include:\n\n```markdown\n# Traceability Report\nGenerated: <timestamp>\n\n## Summary\n| Metric | Count |\n|--------|-------|\n| Total Stories | X |\n| Stories with Tests | X |\n| Stories without Tests | X |\n| Coverage Percentage | X% |\n\n## Story Coverage Matrix\n\n| Story ID | Title | Tests | Commits | Status |\n|----------|-------|-------|---------|--------|\n| ACF-001 | <title> | 5 | 3 | Complete |\n| ACF-002 | <title> | 0 | 0 | No Coverage |\n\n## Detailed Linkage\n\n### ACF-001 - <Title>\n**Status**: Complete\n**Tests**:\n- OrderTests.cs:CreateOrder_ValidInput_ReturnsSuccess\n- OrderTests.cs:CreateOrder_InvalidInput_ThrowsValidation\n\n**Commits**:\n- abc1234 ACF-001 Implement order creation\n- def5678 ACF-001 Add validation tests\n\n---\n\n## Gaps and Recommendations\n\n### Stories Missing Tests\n- ACF-003: <title> - Requires unit tests\n\n### Tests Missing Story IDs\n- SomeTest.cs:TestMethod - Add [Trait(\"Story\", \"ACF-###\")]\n\n### Commits Missing Story IDs\n- xyz9999 \"Fixed bug\" - Should reference ACF-###\n```\n\n## Exit Criteria\n\nFor `/traceability validate`:\n- Exit 0 if all stories have linked tests\n- Exit 1 if any gaps exist\n\nBefore any release, ensure:\n- 100% story coverage (all stories have tests)\n- All tests reference their story IDs\n- All commits include story IDs\n\n## Example\n\n```\nUser: /traceability\n\nClaude: Generating traceability report...\n\n## Traceability Summary\n\n| Metric | Count |\n|--------|-------|\n| Total Stories | 12 |\n| Stories with Tests | 10 |\n| Stories without Tests | 2 |\n| Coverage | 83% |\n\n### Gaps Found\n\nStories missing test coverage:\n- ACF-011: API rate limiting\n- ACF-012: Audit logging\n\nRecommendations:\n1. Add tests for ACF-011 with trait [Trait(\"Story\", \"ACF-011\")]\n2. Add tests for ACF-012 with trait [Trait(\"Story\", \"ACF-012\")]\n\nFull report: artifacts/traceability/traceability-report.md\n```\n"
    },
    "test-coverage": {
      "prompt": "# Test Coverage\n\nAnalyze test coverage and generate missing tests:\n\n1. Run tests with coverage: npm test --coverage or pnpm test --coverage\n\n2. Analyze coverage report (coverage/coverage-summary.json)\n\n3. Identify files below 80% coverage threshold\n\n4. For each under-covered file:\n   - Analyze untested code paths\n   - Generate unit tests for functions\n   - Generate integration tests for APIs\n   - Generate E2E tests for critical flows\n\n5. Verify new tests pass\n\n6. Show before/after coverage metrics\n\n7. Ensure project reaches 80%+ overall coverage\n\nFocus on:\n- Happy path scenarios\n- Error handling\n- Edge cases (null, undefined, empty)\n- Boundary conditions\n"
    },
    "tdd": {
      "prompt": "---\ndescription: Enforce test-driven development workflow. Scaffold interfaces, generate tests FIRST, then implement minimal code to pass. Ensure 80%+ coverage.\n---\n\n# TDD Command\n\nThis command invokes the **tdd-guide** agent to enforce test-driven development methodology.\n\n## What This Command Does\n\n1. **Scaffold Interfaces** - Define types/interfaces first\n2. **Generate Tests First** - Write failing tests (RED)\n3. **Implement Minimal Code** - Write just enough to pass (GREEN)\n4. **Refactor** - Improve code while keeping tests green (REFACTOR)\n5. **Verify Coverage** - Ensure 80%+ test coverage\n\n## When to Use\n\nUse `/tdd` when:\n- Implementing new features\n- Adding new functions/components\n- Fixing bugs (write test that reproduces bug first)\n- Refactoring existing code\n- Building critical business logic\n\n## How It Works\n\nThe tdd-guide agent will:\n\n1. **Define interfaces** for inputs/outputs\n2. **Write tests that will FAIL** (because code doesn't exist yet)\n3. **Run tests** and verify they fail for the right reason\n4. **Write minimal implementation** to make tests pass\n5. **Run tests** and verify they pass\n6. **Refactor** code while keeping tests green\n7. **Check coverage** and add more tests if below 80%\n\n## TDD Cycle\n\n```\nRED ‚Üí GREEN ‚Üí REFACTOR ‚Üí REPEAT\n\nRED:      Write a failing test\nGREEN:    Write minimal code to pass\nREFACTOR: Improve code, keep tests passing\nREPEAT:   Next feature/scenario\n```\n\n## Example Usage\n\n```\nUser: /tdd I need a function to calculate market liquidity score\n\nAgent (tdd-guide):\n# TDD Session: Market Liquidity Score Calculator\n\n## Step 1: Define Interface (SCAFFOLD)\n\n```typescript\n// lib/liquidity.ts\nexport interface MarketData {\n  totalVolume: number\n  bidAskSpread: number\n  activeTraders: number\n  lastTradeTime: Date\n}\n\nexport function calculateLiquidityScore(market: MarketData): number {\n  // TODO: Implementation\n  throw new Error('Not implemented')\n}\n```\n\n## Step 2: Write Failing Test (RED)\n\n```typescript\n// lib/liquidity.test.ts\nimport { calculateLiquidityScore } from './liquidity'\n\ndescribe('calculateLiquidityScore', () => {\n  it('should return high score for liquid market', () => {\n    const market = {\n      totalVolume: 100000,\n      bidAskSpread: 0.01,\n      activeTraders: 500,\n      lastTradeTime: new Date()\n    }\n\n    const score = calculateLiquidityScore(market)\n\n    expect(score).toBeGreaterThan(80)\n    expect(score).toBeLessThanOrEqual(100)\n  })\n\n  it('should return low score for illiquid market', () => {\n    const market = {\n      totalVolume: 100,\n      bidAskSpread: 0.5,\n      activeTraders: 2,\n      lastTradeTime: new Date(Date.now() - 86400000) // 1 day ago\n    }\n\n    const score = calculateLiquidityScore(market)\n\n    expect(score).toBeLessThan(30)\n    expect(score).toBeGreaterThanOrEqual(0)\n  })\n\n  it('should handle edge case: zero volume', () => {\n    const market = {\n      totalVolume: 0,\n      bidAskSpread: 0,\n      activeTraders: 0,\n      lastTradeTime: new Date()\n    }\n\n    const score = calculateLiquidityScore(market)\n\n    expect(score).toBe(0)\n  })\n})\n```\n\n## Step 3: Run Tests - Verify FAIL\n\n```bash\nnpm test lib/liquidity.test.ts\n\nFAIL lib/liquidity.test.ts\n  ‚úï should return high score for liquid market (2 ms)\n    Error: Not implemented\n\n1 test failed, 0 passed\n```\n\n‚úÖ Tests fail as expected. Ready to implement.\n\n## Step 4: Implement Minimal Code (GREEN)\n\n```typescript\n// lib/liquidity.ts\nexport function calculateLiquidityScore(market: MarketData): number {\n  // Handle zero volume edge case\n  if (market.totalVolume === 0) {\n    return 0\n  }\n\n  // Calculate component scores (0-100 scale)\n  const volumeScore = Math.min(market.totalVolume / 1000, 100)\n  const spreadScore = Math.max(100 - (market.bidAskSpread * 1000), 0)\n  const traderScore = Math.min(market.activeTraders / 10, 100)\n\n  // Recent activity bonus\n  const hoursSinceLastTrade = (Date.now() - market.lastTradeTime.getTime()) / (1000 * 60 * 60)\n  const recencyScore = Math.max(100 - (hoursSinceLastTrade * 10), 0)\n\n  // Weighted average\n  const score = (\n    volumeScore * 0.4 +\n    spreadScore * 0.3 +\n    traderScore * 0.2 +\n    recencyScore * 0.1\n  )\n\n  return Math.min(Math.max(score, 0), 100) // Clamp to 0-100\n}\n```\n\n## Step 5: Run Tests - Verify PASS\n\n```bash\nnpm test lib/liquidity.test.ts\n\nPASS lib/liquidity.test.ts\n  ‚úì should return high score for liquid market (3 ms)\n  ‚úì should return low score for illiquid market (2 ms)\n  ‚úì should handle edge case: zero volume (1 ms)\n\n3 tests passed\n```\n\n‚úÖ All tests passing!\n\n## Step 6: Refactor (IMPROVE)\n\n```typescript\n// lib/liquidity.ts - Refactored with constants and better readability\nconst WEIGHTS = {\n  VOLUME: 0.4,\n  SPREAD: 0.3,\n  TRADERS: 0.2,\n  RECENCY: 0.1,\n} as const\n\nconst SCALE_FACTORS = {\n  VOLUME: 1000,\n  SPREAD: 1000,\n  TRADERS: 10,\n  RECENCY_PENALTY: 10,\n} as const\n\nfunction clamp(value: number, min: number, max: number): number {\n  return Math.min(Math.max(value, min), max)\n}\n\nexport function calculateLiquidityScore(market: MarketData): number {\n  if (market.totalVolume === 0) return 0\n\n  const volumeScore = Math.min(market.totalVolume / SCALE_FACTORS.VOLUME, 100)\n  const spreadScore = clamp(100 - (market.bidAskSpread * SCALE_FACTORS.SPREAD), 0, 100)\n  const traderScore = Math.min(market.activeTraders / SCALE_FACTORS.TRADERS, 100)\n\n  const hoursSinceLastTrade = (Date.now() - market.lastTradeTime.getTime()) / (1000 * 60 * 60)\n  const recencyScore = clamp(100 - (hoursSinceLastTrade * SCALE_FACTORS.RECENCY_PENALTY), 0, 100)\n\n  const weightedScore =\n    volumeScore * WEIGHTS.VOLUME +\n    spreadScore * WEIGHTS.SPREAD +\n    traderScore * WEIGHTS.TRADERS +\n    recencyScore * WEIGHTS.RECENCY\n\n  return clamp(weightedScore, 0, 100)\n}\n```\n\n## Step 7: Verify Tests Still Pass\n\n```bash\nnpm test lib/liquidity.test.ts\n\nPASS lib/liquidity.test.ts\n  ‚úì should return high score for liquid market (3 ms)\n  ‚úì should return low score for illiquid market (2 ms)\n  ‚úì should handle edge case: zero volume (1 ms)\n\n3 tests passed\n```\n\n‚úÖ Refactoring complete, tests still passing!\n\n## Step 8: Check Coverage\n\n```bash\nnpm test -- --coverage lib/liquidity.test.ts\n\nFile           | % Stmts | % Branch | % Funcs | % Lines\n---------------|---------|----------|---------|--------\nliquidity.ts   |   100   |   100    |   100   |   100\n\nCoverage: 100% ‚úÖ (Target: 80%)\n```\n\n‚úÖ TDD session complete!\n```\n\n## TDD Best Practices\n\n**DO:**\n- ‚úÖ Write the test FIRST, before any implementation\n- ‚úÖ Run tests and verify they FAIL before implementing\n- ‚úÖ Write minimal code to make tests pass\n- ‚úÖ Refactor only after tests are green\n- ‚úÖ Add edge cases and error scenarios\n- ‚úÖ Aim for 80%+ coverage (100% for critical code)\n\n**DON'T:**\n- ‚ùå Write implementation before tests\n- ‚ùå Skip running tests after each change\n- ‚ùå Write too much code at once\n- ‚ùå Ignore failing tests\n- ‚ùå Test implementation details (test behavior)\n- ‚ùå Mock everything (prefer integration tests)\n\n## Test Types to Include\n\n**Unit Tests** (Function-level):\n- Happy path scenarios\n- Edge cases (empty, null, max values)\n- Error conditions\n- Boundary values\n\n**Integration Tests** (Component-level):\n- API endpoints\n- Database operations\n- External service calls\n- React components with hooks\n\n**E2E Tests** (use `/e2e` command):\n- Critical user flows\n- Multi-step processes\n- Full stack integration\n\n## Coverage Requirements\n\n- **80% minimum** for all code\n- **100% required** for:\n  - Financial calculations\n  - Authentication logic\n  - Security-critical code\n  - Core business logic\n\n## Important Notes\n\n**MANDATORY**: Tests must be written BEFORE implementation. The TDD cycle is:\n\n1. **RED** - Write failing test\n2. **GREEN** - Implement to pass\n3. **REFACTOR** - Improve code\n\nNever skip the RED phase. Never write code before tests.\n\n## Integration with Other Commands\n\n- Use `/plan` first to understand what to build\n- Use `/tdd` to implement with tests\n- Use `/build-and-fix` if build errors occur\n- Use `/code-review` to review implementation\n- Use `/test-coverage` to verify coverage\n\n## Related Agents\n\nThis command invokes the `tdd-guide` agent located at:\n`~/.claude/agents/tdd-guide.md`\n\nAnd can reference the `tdd-workflow` skill at:\n`~/.claude/skills/tdd-workflow/`\n",
      "description": "Enforce test-driven development workflow. Scaffold interfaces, generate tests FIRST, then implement minimal code to pass. Ensure 80%+ coverage."
    },
    "switch": {
      "prompt": "# /switch - Multi-Project Support\n\nSwitch between multiple projects in a monorepo or multi-project workspace.\n\n## Usage\n```\n/switch [project-name] [options]\n```\n\nOptions:\n- `--list` - List all available projects\n- `--status` - Show current project context\n- `--new <name>` - Create a new project\n- `--template <template>` - Template for new project\n\n## Instructions\n\n### Project Discovery\n\nWhen invoked, scan for projects:\n\n```bash\n# Find solution files\nfind . -name \"*.sln\" -type f\n\n# Find project directories\nfind ./projects -maxdepth 1 -type d\n\n# Find docker-compose services\ngrep -E \"^\\s+\\w+:\" docker-compose.yml | grep -v \"version\\|services\\|volumes\\|networks\"\n\n# Check for monorepo structure\nls -la packages/ services/ apps/ 2>/dev/null\n```\n\n### Project Context File\n\nMaintain project context in `.claude/current-project.json`:\n\n```json\n{\n  \"currentProject\": {\n    \"name\": \"OrderService\",\n    \"path\": \"services/OrderService\",\n    \"solution\": \"services/OrderService/OrderService.sln\",\n    \"type\": \"microservice\",\n    \"framework\": \"net8.0\",\n    \"switchedAt\": \"2025-01-20T10:30:00Z\"\n  },\n  \"recentProjects\": [\n    {\n      \"name\": \"OrderService\",\n      \"path\": \"services/OrderService\",\n      \"lastUsed\": \"2025-01-20T10:30:00Z\"\n    },\n    {\n      \"name\": \"UserService\",\n      \"path\": \"services/UserService\",\n      \"lastUsed\": \"2025-01-19T15:45:00Z\"\n    }\n  ],\n  \"projectRegistry\": {\n    \"OrderService\": {\n      \"path\": \"services/OrderService\",\n      \"type\": \"microservice\",\n      \"dependencies\": [\"SharedKernel\", \"Messaging\"]\n    },\n    \"UserService\": {\n      \"path\": \"services/UserService\",\n      \"type\": \"microservice\",\n      \"dependencies\": [\"SharedKernel\"]\n    },\n    \"SharedKernel\": {\n      \"path\": \"shared/SharedKernel\",\n      \"type\": \"library\",\n      \"dependencies\": []\n    },\n    \"Gateway\": {\n      \"path\": \"services/Gateway\",\n      \"type\": \"api-gateway\",\n      \"dependencies\": [\"OrderService\", \"UserService\"]\n    }\n  }\n}\n```\n\n### List Projects (`/switch --list`)\n\n```markdown\n================================================================================\n                         AVAILABLE PROJECTS\n================================================================================\n\n## Microservices\n| Name | Path | Framework | Status |\n|------|------|-----------|--------|\n| OrderService | services/OrderService | .NET 8.0 | ‚úÖ Healthy |\n| UserService | services/UserService | .NET 8.0 | ‚úÖ Healthy |\n| PaymentService | services/PaymentService | .NET 8.0 | ‚ö†Ô∏è Outdated deps |\n| NotificationService | services/NotificationService | .NET 8.0 | ‚úÖ Healthy |\n\n## Libraries\n| Name | Path | Framework | Used By |\n|------|------|-----------|---------|\n| SharedKernel | shared/SharedKernel | .NET 8.0 | All services |\n| Messaging | shared/Messaging | .NET 8.0 | Order, Notification |\n\n## Infrastructure\n| Name | Path | Type |\n|------|------|------|\n| Gateway | services/Gateway | API Gateway |\n| docker-compose | ./ | Container orchestration |\n\n## Current Context\nüìç Active: OrderService (services/OrderService)\n   Switched: 2 hours ago\n\n## Quick Switch\n  /switch UserService\n  /switch SharedKernel\n  /switch Gateway\n```\n\n### Switch Project (`/switch <project>`)\n\n```\nUser: /switch UserService\n\nClaude: Switching to UserService...\n\n## Context Switch\n\nFrom: OrderService (services/OrderService)\nTo:   UserService (services/UserService)\n\n## UserService Overview\n\n**Type**: Microservice\n**Framework**: .NET 8.0\n**Solution**: services/UserService/UserService.sln\n\n### Project Structure\n```\nservices/UserService/\n‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îú‚îÄ‚îÄ UserService.Domain/\n‚îÇ   ‚îú‚îÄ‚îÄ UserService.Application/\n‚îÇ   ‚îú‚îÄ‚îÄ UserService.Infrastructure/\n‚îÇ   ‚îî‚îÄ‚îÄ UserService.API/\n‚îî‚îÄ‚îÄ tests/\n    ‚îú‚îÄ‚îÄ UserService.UnitTests/\n    ‚îî‚îÄ‚îÄ UserService.IntegrationTests/\n```\n\n### Dependencies\n- SharedKernel (shared library)\n\n### Recent Activity\n- Last commit: 3 hours ago \"ACF-089 Add user preferences\"\n- Open stories: 2 (ACF-091, ACF-092)\n- Test status: 142 passing\n\n### Quick Commands (project-scoped)\n- Build: `dotnet build services/UserService/UserService.sln`\n- Test: `dotnet test services/UserService/`\n- Run: `dotnet run --project services/UserService/src/UserService.API`\n\n‚úÖ Switched to UserService\n\nAll commands now scoped to: services/UserService/\n```\n\n### Project Status (`/switch --status`)\n\n```\nUser: /switch --status\n\nClaude: üìç Current Project Context\n\n## Active Project: OrderService\n\n**Path**: services/OrderService\n**Solution**: services/OrderService/OrderService.sln\n**Switched**: 2025-01-20 10:30 (2 hours ago)\n\n### Project Health\n- Build: ‚úÖ Passing\n- Tests: ‚úÖ 168/168 passing\n- Coverage: 87%\n- Dependencies: ‚ö†Ô∏è 2 outdated\n\n### Active Work\n- Current sprint: Sprint 12\n- Open stories: ACF-088, ACF-090\n- In progress: ACF-088 (Order validation)\n\n### Dependencies\n```\nOrderService\n‚îú‚îÄ‚îÄ SharedKernel (v1.2.0)\n‚îú‚îÄ‚îÄ Messaging (v1.0.0)\n‚îî‚îÄ‚îÄ External\n    ‚îú‚îÄ‚îÄ MediatR (12.2.0)\n    ‚îî‚îÄ‚îÄ FluentValidation (11.9.0)\n```\n\n### Recent Commands\n- /implement ACF-088 (30 min ago)\n- /add-test OrderValidator (1 hour ago)\n- /coverage (2 hours ago)\n\n### Dependent Services\n- Gateway (routes to this service)\n- NotificationService (receives events)\n```\n\n### Create New Project (`/switch --new`)\n\n```\nUser: /switch --new InventoryService --template microservice\n\nClaude: Creating new project: InventoryService\n\n## Project Setup\n\nUsing template: microservice\nLocation: services/InventoryService\n\n### Creating Structure\n```\nservices/InventoryService/\n‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îú‚îÄ‚îÄ InventoryService.Domain/         ‚úÖ Created\n‚îÇ   ‚îú‚îÄ‚îÄ InventoryService.Application/    ‚úÖ Created\n‚îÇ   ‚îú‚îÄ‚îÄ InventoryService.Infrastructure/ ‚úÖ Created\n‚îÇ   ‚îî‚îÄ‚îÄ InventoryService.API/            ‚úÖ Created\n‚îú‚îÄ‚îÄ tests/\n‚îÇ   ‚îú‚îÄ‚îÄ InventoryService.UnitTests/      ‚úÖ Created\n‚îÇ   ‚îî‚îÄ‚îÄ InventoryService.IntegrationTests/ ‚úÖ Created\n‚îú‚îÄ‚îÄ InventoryService.sln                  ‚úÖ Created\n‚îú‚îÄ‚îÄ Dockerfile                            ‚úÖ Created\n‚îî‚îÄ‚îÄ README.md                             ‚úÖ Created\n```\n\n### Dependencies Added\n- SharedKernel (project reference)\n- Standard NuGet packages\n\n### Registration\n- Added to docker-compose.yml\n- Added to project registry\n- Added to Gateway routes (if applicable)\n\n### Configuration\n- appsettings.json created\n- appsettings.Development.json created\n- Connection strings templated\n\n‚úÖ InventoryService created and registered\n\nSwitched to: InventoryService\n\nNext steps:\n1. Define domain entities: /add-entity\n2. Create first story: /new-story\n3. Run initial build: dotnet build\n```\n\n### Cross-Project Commands\n\nSome commands can target specific projects:\n\n```bash\n# Run tests for specific project\n/coverage --project UserService\n\n# Implement story in specific project\n/implement ACF-091 --project UserService\n\n# Health check specific project\n/health --project OrderService\n\n# View dependencies across projects\n/dependencies --all\n```\n\n### Project-Aware Paths\n\nWhen a project is selected, paths are relative to that project:\n\n```\n# Without project context (from repo root)\nsrc/OrderService.Domain/Entities/Order.cs\n\n# With OrderService context\nsrc/Domain/Entities/Order.cs   ‚Üí resolves to ‚Üí services/OrderService/src/OrderService.Domain/Entities/Order.cs\n```\n\n### Monorepo Detection\n\nAutomatically detect monorepo patterns:\n\n```bash\n# Check for common monorepo structures\nif [ -d \"packages\" ] || [ -d \"services\" ] || [ -d \"apps\" ]; then\n  REPO_TYPE=\"monorepo\"\nfi\n\n# Check for workspace files\nif [ -f \"pnpm-workspace.yaml\" ] || [ -f \"lerna.json\" ] || [ -f \"rush.json\" ]; then\n  REPO_TYPE=\"monorepo\"\nfi\n\n# Check for multiple solutions\nSOLUTION_COUNT=$(find . -name \"*.sln\" -type f | wc -l)\nif [ $SOLUTION_COUNT -gt 1 ]; then\n  REPO_TYPE=\"multi-solution\"\nfi\n```\n\n### Workspace Configuration\n\nOptional `.claude/workspace.json` for custom project configuration:\n\n```json\n{\n  \"workspace\": {\n    \"name\": \"E-Commerce Platform\",\n    \"type\": \"monorepo\"\n  },\n  \"projects\": {\n    \"OrderService\": {\n      \"path\": \"services/OrderService\",\n      \"type\": \"microservice\",\n      \"port\": 5001,\n      \"database\": \"orders_db\",\n      \"team\": \"orders-team\"\n    },\n    \"UserService\": {\n      \"path\": \"services/UserService\",\n      \"type\": \"microservice\",\n      \"port\": 5002,\n      \"database\": \"users_db\",\n      \"team\": \"identity-team\"\n    }\n  },\n  \"shared\": {\n    \"SharedKernel\": {\n      \"path\": \"shared/SharedKernel\",\n      \"type\": \"library\"\n    }\n  },\n  \"infrastructure\": {\n    \"Gateway\": {\n      \"path\": \"services/Gateway\",\n      \"type\": \"api-gateway\",\n      \"port\": 5000\n    }\n  },\n  \"defaultProject\": \"OrderService\"\n}\n```\n\n## Example Session\n\n```\nUser: /switch --list\n\nClaude: Available projects:\n\n  MICROSERVICES\n  1. OrderService (current) - services/OrderService\n  2. UserService - services/UserService\n  3. PaymentService - services/PaymentService\n\n  LIBRARIES\n  4. SharedKernel - shared/SharedKernel\n\n  INFRASTRUCTURE\n  5. Gateway - services/Gateway\n\nUser: /switch UserService\n\nClaude: Switching to UserService...\n\n‚úÖ Switched to UserService\n\n  Path: services/UserService\n  Type: Microservice\n  Stories: 2 open (ACF-091, ACF-092)\n\n  All commands now scoped to UserService.\n\nUser: /add-entity UserPreference\n\nClaude: Creating entity in UserService...\n\n  File: services/UserService/src/UserService.Domain/Entities/UserPreference.cs\n\n  [Creates entity in UserService context]\n```\n\n```\nUser: /switch --status\n\nClaude: üìç Current: UserService (services/UserService)\n\n  Health: ‚úÖ Healthy\n  Tests: 142 passing\n  Open stories: ACF-091, ACF-092\n\n  Related projects:\n  - SharedKernel (dependency)\n  - Gateway (consumer)\n```\n"
    },
    "sprint": {
      "prompt": "# /sprint - Sprint Management\n\nManage sprint planning, tracking, and ceremonies with automated insights.\n\n## Usage\n```\n/sprint <action> [args]\n```\n\nActions:\n- `plan` - Start sprint planning\n- `daily` - Generate daily standup report (automated from git)\n- `review` - Prepare sprint review with demo script\n- `retro` - Run retrospective with automated metrics\n- `status` - Show sprint status with burndown\n- `velocity` - Calculate and trend team velocity\n- `metrics` - Deep dive into sprint metrics\n\n## Instructions\n\n### Sprint Planning (`/sprint plan`)\n\n#### 1. Automated Backlog Analysis\n\n```bash\n# Find all stories and their status\nfind artifacts/stories -name \"ACF-*.md\" -exec grep -l \"Status: ready\\|Status: draft\" {} \\;\n\n# Extract story metadata\nfor story in artifacts/stories/ACF-*.md; do\n  echo \"---\"\n  grep -E \"^# |^Status:|^Priority:|^Points:\" \"$story\"\ndone\n```\n\n#### 2. Velocity-Based Capacity Calculation\n\n```bash\n# Calculate average velocity from past sprints\ncat artifacts/sprints/sprint-*.md | grep \"Completed Points:\" | \\\n  awk -F': ' '{sum+=$2; count++} END {print \"Average:\", sum/count}'\n```\n\n#### 3. Create Sprint File\n\n**Location**: `artifacts/sprints/sprint-<N>.md`\n\n```markdown\n# Sprint <N>\n\n**Start Date**: {{START_DATE}}\n**End Date**: {{END_DATE}}\n**Goal**: {{SPRINT_GOAL}}\n\n## Sprint Metrics\n- **Team Capacity**: {{CAPACITY}} points\n- **Committed Points**: {{COMMITTED}} points\n- **Buffer**: {{BUFFER}}% for unplanned work\n\n## Committed Stories\n\n| Story | Title | Points | Assignee | Status |\n|-------|-------|--------|----------|--------|\n| ACF-040 | Feature A | 5 | Developer | Not Started |\n| ACF-041 | Feature B | 3 | Developer | Not Started |\n| ACF-042 | Bug Fix | 2 | Developer | Not Started |\n\n**Total Committed**: {{TOTAL}} points\n\n## Sprint Backlog\n\n### ACF-040 - Feature A (5 points)\n\n**Acceptance Criteria**: (from story)\n\n**Tasks**:\n- [ ] Design domain model (1 pt)\n- [ ] Implement repository (1 pt)\n- [ ] Add API endpoint (1 pt)\n- [ ] Write unit tests (1 pt)\n- [ ] Write integration tests (1 pt)\n\n### ACF-041 - Feature B\n...\n\n## Risks and Dependencies\n\n| Risk/Dependency | Impact | Mitigation |\n|-----------------|--------|------------|\n| {{RISK}} | {{IMPACT}} | {{MITIGATION}} |\n\n## Definition of Done Checklist\n- [ ] All committed stories complete\n- [ ] All tests passing in CI\n- [ ] Code coverage ‚â•80% for Domain/Application\n- [ ] No high/critical security vulnerabilities\n- [ ] Documentation updated\n- [ ] Demo prepared and rehearsed\n```\n\n---\n\n### Daily Standup (`/sprint daily`)\n\n#### Automated Git Analysis\n\n```bash\n# Get yesterday's commits\ngit log --since=\"yesterday\" --until=\"today\" --oneline --all\n\n# Extract story IDs from commits\ngit log --since=\"yesterday\" --format=\"%s\" | grep -oE \"ACF-[0-9]+\" | sort -u\n\n# Get files changed per story\nfor story in $(git log --since=\"yesterday\" --format=\"%s\" | grep -oE \"ACF-[0-9]+\" | sort -u); do\n  echo \"=== $story ===\"\n  git log --since=\"yesterday\" --grep=\"$story\" --name-only --format=\"\"\ndone\n\n# Calculate lines changed\ngit diff --stat $(git log --since=\"yesterday\" --format=\"%H\" | tail -1)..HEAD\n```\n\n#### Generated Report\n\n```markdown\n# Daily Standup - {{DATE}}\n\n## Yesterday's Activity (Auto-generated from Git)\n\n### Commits by Story\n| Story | Commits | Files Changed | Lines |\n|-------|---------|---------------|-------|\n| ACF-040 | 3 | 8 | +245/-32 |\n| ACF-041 | 2 | 4 | +89/-12 |\n\n### Detailed Commit Log\n```\n09:15 ACF-040 Implement Order aggregate root\n10:30 ACF-040 Add OrderRepository with EF Core\n14:22 ACF-040 Write unit tests for Order\n15:45 ACF-041 Add CreateOrderCommand handler\n17:00 ACF-041 Add validation for OrderDto\n```\n\n### Tests Status\n- Unit Tests: 145 passing, 0 failing\n- New Tests Added: 8\n- Coverage Delta: +2.3%\n\n## Today's Plan\n\nBased on sprint backlog and completed tasks:\n\n| Story | Remaining Tasks | Priority |\n|-------|-----------------|----------|\n| ACF-040 | Integration tests, docs | High |\n| ACF-041 | API endpoint, tests | High |\n| ACF-042 | Not started | Medium |\n\n## Blockers Detected\n\n### From Code Comments\n```bash\n# Auto-scan for TODO, FIXME, BLOCKED tags\ngrep -rn \"TODO\\|FIXME\\|BLOCKED\" src/ --include=\"*.cs\" | head -10\n```\n\n### From Recent Commits\n- None detected (or list issues)\n\n## Sprint Progress\n\n```\nDay 3 of 10\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 30%\n\nStories: 1/3 complete (33%)\nPoints:  3/10 complete (30%)\nStatus:  ‚úÖ On Track\n```\n\n## Burndown\n\n```\nPoints ‚îÇ ¬∑\n  10   ‚îÇ ‚ñà¬∑\n   8   ‚îÇ ‚ñà‚ñà¬∑‚ñë\n   6   ‚îÇ ‚ñà‚ñà‚ñà¬∑‚ñë‚ñë\n   4   ‚îÇ     ¬∑‚ñë‚ñë‚ñë\n   2   ‚îÇ      ¬∑‚ñë‚ñë\n   0   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n       1 2 3 4 5 6 7 8 9 10\n       ‚ñà Actual  ¬∑ Ideal  ‚ñë Remaining\n```\n```\n\n---\n\n### Sprint Review (`/sprint review`)\n\n#### Automated Demo Script Generation\n\n```bash\n# Get completed stories\ngrep -l \"Status: complete\\|Status: done\" artifacts/stories/ACF-*.md\n\n# Extract acceptance criteria for demo points\nfor story in $(grep -l \"Status: complete\" artifacts/stories/ACF-*.md); do\n  echo \"=== Demo: $(basename $story .md) ===\"\n  sed -n '/## Acceptance Criteria/,/## /p' \"$story\" | head -20\ndone\n```\n\n#### Generated Review Document\n\n```markdown\n# Sprint {{N}} Review\n\n**Date**: {{DATE}}\n**Sprint Goal**: {{GOAL}}\n**Goal Status**: ‚úÖ Achieved | ‚ö†Ô∏è Partially Achieved | ‚ùå Not Achieved\n\n## Executive Summary\n\n- **Committed**: {{COMMITTED}} points ({{STORY_COUNT}} stories)\n- **Completed**: {{COMPLETED}} points ({{DONE_COUNT}} stories)\n- **Velocity**: {{VELOCITY}} points\n- **Completion Rate**: {{RATE}}%\n\n## Completed Work\n\n### ACF-040: Order Management System (5 points)\n\n**Demo Script**:\n1. Navigate to `/orders` page\n2. Click \"Create New Order\"\n3. Fill in customer and product details\n4. Submit order - show success notification\n5. View order in list with status \"Pending\"\n6. Show order details with line items\n\n**Key Features Delivered**:\n- Order creation with validation\n- Order listing with filtering\n- Order detail view\n- Real-time status updates\n\n**Technical Highlights**:\n- Clean Architecture implementation\n- CQRS with MediatR\n- 92% test coverage\n\n### ACF-041: Email Notifications (3 points)\n...\n\n## Incomplete Work\n\n| Story | Remaining | Reason | Next Sprint? |\n|-------|-----------|--------|--------------|\n| ACF-042 | 2 tasks | External API delay | Yes |\n\n## Sprint Metrics\n\n| Metric | Value | Trend |\n|--------|-------|-------|\n| Velocity | 8 pts | ‚Üë +2 |\n| Completion Rate | 80% | ‚Üì -5% |\n| Bug Escape Rate | 0 | = 0 |\n| Test Coverage | 87% | ‚Üë +3% |\n| Cycle Time | 2.5 days | ‚Üì -0.5 |\n\n## Demo Environment\n\n| Item | Status | URL/Details |\n|------|--------|-------------|\n| Application | ‚úÖ Ready | https://staging.example.com |\n| Test Data | ‚úÖ Loaded | 50 sample orders |\n| Accounts | ‚úÖ Ready | demo@example.com / demo123 |\n\n## Demo Checklist\n\n- [ ] Environment verified working\n- [ ] Test data refreshed\n- [ ] Screen sharing tested\n- [ ] Recording setup (optional)\n- [ ] Stakeholder calendar confirmed\n- [ ] Backup presenter assigned\n\n## Feedback Capture Template\n\n| Feedback | From | Priority | Action |\n|----------|------|----------|--------|\n| | | | |\n\n## Stakeholder Sign-off\n\n| Stakeholder | Approved | Notes |\n|-------------|----------|-------|\n| Product Owner | ‚òê | |\n| Tech Lead | ‚òê | |\n```\n\n---\n\n### Sprint Retrospective (`/sprint retro`)\n\n#### Automated Metrics Analysis\n\n```bash\n# Commit frequency by day\ngit log --format=\"%ad\" --date=short | sort | uniq -c | tail -10\n\n# Code churn analysis\ngit log --numstat --format=\"\" | awk '{add+=$1; del+=$2} END {print \"Added:\", add, \"Deleted:\", del}'\n\n# Build failure rate (if CI logs available)\n# Review rate\n# PR turnaround time\n```\n\n#### Generated Retrospective\n\n```markdown\n# Sprint {{N}} Retrospective\n\n**Date**: {{DATE}}\n**Facilitator**: Claude Code\n**Attendees**: {{ATTENDEES}}\n\n## Sprint Health Score: {{SCORE}}/10\n\n### Automated Health Metrics\n\n| Metric | Value | Target | Status |\n|--------|-------|--------|--------|\n| Velocity | 8 pts | 10 pts | ‚ö†Ô∏è Below |\n| Completion Rate | 80% | 90% | ‚ö†Ô∏è Below |\n| Test Coverage | 87% | 80% | ‚úÖ Above |\n| Build Success | 95% | 95% | ‚úÖ Met |\n| PR Review Time | 4 hrs | 8 hrs | ‚úÖ Above |\n| Bug Escape | 0 | 0 | ‚úÖ Met |\n\n### Code Quality Trends\n\n```\nCoverage: ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë 87%\n                            ‚Üë +3% from last sprint\n\nTech Debt: ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 25%\n                 ‚Üì -5% from last sprint\n```\n\n## What Went Well ‚úÖ\n\n### Team Observations\n- {{ITEM_1}}\n- {{ITEM_2}}\n\n### Data-Backed Wins\n- PR review time improved by 50%\n- Zero production incidents\n- Test coverage increased 3%\n- All code reviews completed same-day\n\n## What Could Be Improved ‚ö†Ô∏è\n\n### Team Observations\n- {{ITEM_1}}\n- {{ITEM_2}}\n\n### Data-Backed Concerns\n- Velocity 20% below target\n- 1 story carried over\n- Late sprint scope addition\n- Commit clustering on final day\n\n### Commit Distribution Analysis\n\n```\nMon  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 20%\nTue  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë 35%\nWed  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 20%\nThu  ‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 10%\nFri  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 15%\n\n‚ö†Ô∏è Uneven distribution - consider WIP limits\n```\n\n## Action Items\n\n| Action | Owner | Due | Tracking |\n|--------|-------|-----|----------|\n| Implement WIP limits | Scrum Master | Sprint {{N+1}} | |\n| Add integration test stage | DevOps | {{DATE}} | |\n| Story refinement session | PO + Team | Weekly | |\n\n## Previous Sprint Actions Status\n\n| Action | Owner | Status | Notes |\n|--------|-------|--------|-------|\n| Add pre-commit hooks | Dev | ‚úÖ Done | Reduced lint issues 90% |\n| Automate deployments | DevOps | ‚úÖ Done | CI/CD now fully automated |\n| Story pointing session | Team | ‚ö†Ô∏è Partial | 2 of 3 sessions held |\n\n## Velocity Trend\n\n```\nSprint ‚îÇ\n   1   ‚îÇ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 6 pts\n   2   ‚îÇ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 8 pts\n   3   ‚îÇ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 8 pts\n   4   ‚îÇ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 10 pts\n   5   ‚îÇ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 8 pts (current)\n       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n       Average: 8 pts ‚îÇ Target: 10 pts\n```\n\n## Team Happiness Index\n\nRate 1-5: How was this sprint?\n- Collaboration: {{RATING}}\n- Workload: {{RATING}}\n- Technical challenges: {{RATING}}\n- Support from leadership: {{RATING}}\n\n## Next Sprint Focus\n\nBased on this retrospective:\n1. {{FOCUS_1}}\n2. {{FOCUS_2}}\n3. {{FOCUS_3}}\n```\n\n---\n\n### Sprint Status (`/sprint status`)\n\nReal-time sprint status with burndown visualization.\n\n```markdown\n# Sprint {{N}} Status\n\n**Updated**: {{TIMESTAMP}}\n**Days Remaining**: {{DAYS}} of {{TOTAL_DAYS}}\n\n## Goal Progress\n\n**Goal**: {{SPRINT_GOAL}}\n**Status**: ‚úÖ On Track | ‚ö†Ô∏è At Risk | ‚ùå Off Track\n\n## Burndown Chart\n\n```\nPoints\n  12 ‚îÇ ¬∑\n  10 ‚îÇ ‚ñà¬∑\n   8 ‚îÇ ‚ñà‚ñà¬∑‚ñë\n   6 ‚îÇ ‚ñà‚ñà‚ñà¬∑‚ñë‚ñë\n   4 ‚îÇ ‚ñà‚ñà‚ñà‚ñà¬∑‚ñë‚ñë‚ñë\n   2 ‚îÇ      ¬∑‚ñë‚ñë‚ñë‚ñë\n   0 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n     ‚îÇ 1  2  3  4  5  6  7  8  9  10\n     Day\n\nLegend: ‚ñà Completed  ¬∑ Ideal  ‚ñë Remaining\nCurrent: 6 pts done ‚îÇ Ideal: 4.8 pts ‚îÇ Œî: +1.2 pts ahead\n```\n\n## Story Status\n\n| Story | Title | Points | Progress | Status |\n|-------|-------|--------|----------|--------|\n| ACF-040 | Order Management | 5 | ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë 80% | üîµ In Progress |\n| ACF-041 | Notifications | 3 | ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100% | ‚úÖ Complete |\n| ACF-042 | Dashboard | 2 | ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 0% | ‚ö™ Not Started |\n\n## Task Breakdown\n\n### ACF-040 - Order Management (4/5 tasks)\n- [x] Design domain model\n- [x] Implement repository\n- [x] Add API endpoint\n- [x] Write unit tests\n- [ ] Write integration tests ‚Üê In Progress\n\n### ACF-042 - Dashboard (0/4 tasks)\n- [ ] Design wireframe\n- [ ] Create React components\n- [ ] Implement data fetching\n- [ ] Write tests\n\n## Blockers\n\n| Blocker | Story | Raised | Owner | Status |\n|---------|-------|--------|-------|--------|\n| External API unavailable | ACF-042 | Day 3 | Tech Lead | üî¥ Active |\n\n## Risks\n\n| Risk | Probability | Impact | Mitigation |\n|------|-------------|--------|------------|\n| ACF-042 may not complete | High | Medium | Move to next sprint |\n\n## Today's Git Activity\n\n```bash\n# Commits today\n3 commits by team\n‚îú‚îÄ‚îÄ ACF-040: Add integration test setup\n‚îú‚îÄ‚îÄ ACF-040: Fix order validation bug\n‚îî‚îÄ‚îÄ ACF-041: Update email template\n```\n\n## Sprint Health\n\n| Indicator | Status |\n|-----------|--------|\n| Burndown | ‚úÖ Ahead of plan |\n| Scope | ‚úÖ Stable (no changes) |\n| Quality | ‚úÖ All tests passing |\n| Blockers | ‚ö†Ô∏è 1 active blocker |\n```\n\n---\n\n### Velocity (`/sprint velocity`)\n\nHistorical velocity analysis with predictions.\n\n```markdown\n# Team Velocity Analysis\n\n**Generated**: {{DATE}}\n**Analysis Period**: Last 6 sprints\n\n## Velocity History\n\n| Sprint | Planned | Committed | Completed | Velocity |\n|--------|---------|-----------|-----------|----------|\n| Sprint 6 | 12 | 10 | 10 | 10 |\n| Sprint 5 | 10 | 10 | 8 | 8 |\n| Sprint 4 | 12 | 12 | 10 | 10 |\n| Sprint 3 | 10 | 8 | 8 | 8 |\n| Sprint 2 | 8 | 8 | 6 | 6 |\n| Sprint 1 | 10 | 10 | 6 | 6 |\n\n## Velocity Chart\n\n```\nPoints\n  12 ‚îÇ          ‚îå‚îÄ‚îÄ‚îÄ‚îê\n  10 ‚îÇ      ‚îå‚îÄ‚îÄ‚îÄ‚î§   ‚îú‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îê\n   8 ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚î§   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ\n   6 ‚îÇ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ\n     ‚îÇ  S1  S2  S3  S4  S5  S6\n\n     ‚ïê‚ïê‚ïê Committed  ‚îÄ‚îÄ‚îÄ Completed\n```\n\n## Statistical Analysis\n\n| Metric | Value |\n|--------|-------|\n| **Average Velocity** | 8.0 points |\n| **Median Velocity** | 8.0 points |\n| **Standard Deviation** | 1.6 points |\n| **Min Velocity** | 6 points |\n| **Max Velocity** | 10 points |\n| **Trend** | ‚Üë Improving |\n\n## Commitment Accuracy\n\n```\nSprint 6: ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100% (10/10)\nSprint 5: ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë 80% (8/10)\nSprint 4: ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë 83% (10/12)\nSprint 3: ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100% (8/8)\nSprint 2: ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë 75% (6/8)\nSprint 1: ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë 60% (6/10)\n\nAverage Accuracy: 83%\n```\n\n## Recommendations\n\n### For Next Sprint Planning\n\nBased on velocity analysis:\n\n| Scenario | Recommended Points | Confidence |\n|----------|-------------------|------------|\n| Conservative | 6 points | 95% |\n| Normal | 8 points | 80% |\n| Optimistic | 10 points | 60% |\n\n**Suggestion**: Commit to **8 points** with 1-2 stretch goals\n\n### Improvement Opportunities\n\n1. **Reduce variability**: Current œÉ=1.6 ‚Üí Target œÉ<1.0\n2. **Improve accuracy**: Invest in story refinement\n3. **Sustain trend**: Velocity improving +33% over 6 sprints\n\n## Factors Affecting Velocity\n\n| Factor | Impact | Sprint(s) |\n|--------|--------|-----------|\n| Holiday | -2 pts | Sprint 2 |\n| New team member | -2 pts | Sprint 1-2 |\n| Technical debt sprint | -3 pts | Sprint 3 |\n| Normal capacity | Baseline | Sprint 4-6 |\n```\n\n---\n\n### Metrics Deep Dive (`/sprint metrics`)\n\nComprehensive sprint metrics analysis.\n\n```markdown\n# Sprint Metrics Dashboard\n\n**Sprint**: {{N}}\n**Period**: {{START}} to {{END}}\n\n## Delivery Metrics\n\n| Metric | Value | Target | Status |\n|--------|-------|--------|--------|\n| Velocity | 8 pts | 10 pts | ‚ö†Ô∏è 80% |\n| Throughput | 3 stories | 4 stories | ‚ö†Ô∏è 75% |\n| Cycle Time | 2.5 days | 3 days | ‚úÖ Better |\n| Lead Time | 5 days | 7 days | ‚úÖ Better |\n\n## Quality Metrics\n\n| Metric | Value | Target | Status |\n|--------|-------|--------|--------|\n| Test Coverage | 87% | 80% | ‚úÖ Exceeded |\n| Bug Escape Rate | 0 | 0 | ‚úÖ Met |\n| Code Review Coverage | 100% | 100% | ‚úÖ Met |\n| Build Success Rate | 95% | 95% | ‚úÖ Met |\n\n## Process Metrics\n\n| Metric | Value | Target | Status |\n|--------|-------|--------|--------|\n| Sprint Goal Met | Yes | Yes | ‚úÖ |\n| Scope Stability | 100% | 90% | ‚úÖ |\n| Unplanned Work | 5% | <10% | ‚úÖ |\n| Blocked Time | 8 hrs | <16 hrs | ‚úÖ |\n\n## Trend Charts\n\n### Velocity Trend\n```\n  10 ‚îÇ      ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óè\n   8 ‚îÇ  ‚óè‚îÄ‚îÄ‚îÄ‚óè\n   6 ‚îÇ‚îÄ‚îÄ‚óè\n     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n       S1 S2 S3 S4 S5\n```\n\n### Quality Trend\n```\n 100‚îÇ  ‚óè‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚óè\n  80‚îÇ\n  60‚îÇ\n     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n       S1 S2 S3 S4 S5\n       Coverage %\n```\n\n## Actionable Insights\n\n1. **Velocity Gap**: 2 points below target\n   - Root cause: 1 blocked story (8 hrs)\n   - Action: Improve dependency management\n\n2. **Cycle Time Improved**: Down from 3.2 to 2.5 days\n   - Contributing factor: Better story refinement\n   - Action: Continue refinement practices\n\n3. **Coverage Stable**: Maintaining 87%\n   - Action: Focus on critical path coverage\n```\n\n## Example\n\n```\nUser: /sprint daily\n\nClaude: Generating daily standup report from git activity...\n\n## Yesterday's Activity (Auto-generated)\n\nAnalyzed 5 commits from yesterday:\n\n| Story | Commits | Activity |\n|-------|---------|----------|\n| ACF-040 | 3 | Domain model, repository, tests |\n| ACF-041 | 2 | Command handler, validation |\n\n## Sprint Progress\n\nDay 4 of 10 | 3/10 points complete | ‚úÖ On Track\n\nBurndown shows we're 0.5 points ahead of ideal.\n\n## Today's Suggested Focus\n\nBased on sprint backlog:\n1. ACF-040: Integration tests (final task)\n2. ACF-041: API endpoint implementation\n3. ACF-042: Can start after ACF-040 complete\n\nAny blockers to discuss?\n```\n"
    },
    "setup-pm": {
      "prompt": "---\ndescription: Configure your preferred package manager (npm/pnpm/yarn/bun)\ndisable-model-invocation: true\n---\n\n# Package Manager Setup\n\nConfigure your preferred package manager for this project or globally.\n\n## Usage\n\n```bash\n# Detect current package manager\nnode scripts/setup-package-manager.js --detect\n\n# Set global preference\nnode scripts/setup-package-manager.js --global pnpm\n\n# Set project preference\nnode scripts/setup-package-manager.js --project bun\n\n# List available package managers\nnode scripts/setup-package-manager.js --list\n```\n\n## Detection Priority\n\nWhen determining which package manager to use, the following order is checked:\n\n1. **Environment variable**: `CLAUDE_PACKAGE_MANAGER`\n2. **Project config**: `.claude/package-manager.json`\n3. **package.json**: `packageManager` field\n4. **Lock file**: Presence of package-lock.json, yarn.lock, pnpm-lock.yaml, or bun.lockb\n5. **Global config**: `~/.claude/package-manager.json`\n6. **Fallback**: First available package manager (pnpm > bun > yarn > npm)\n\n## Configuration Files\n\n### Global Configuration\n```json\n// ~/.claude/package-manager.json\n{\n  \"packageManager\": \"pnpm\"\n}\n```\n\n### Project Configuration\n```json\n// .claude/package-manager.json\n{\n  \"packageManager\": \"bun\"\n}\n```\n\n### package.json\n```json\n{\n  \"packageManager\": \"pnpm@8.6.0\"\n}\n```\n\n## Environment Variable\n\nSet `CLAUDE_PACKAGE_MANAGER` to override all other detection methods:\n\n```bash\n# Windows (PowerShell)\n$env:CLAUDE_PACKAGE_MANAGER = \"pnpm\"\n\n# macOS/Linux\nexport CLAUDE_PACKAGE_MANAGER=pnpm\n```\n\n## Run the Detection\n\nTo see current package manager detection results, run:\n\n```bash\nnode scripts/setup-package-manager.js --detect\n```\n",
      "description": "Configure your preferred package manager (npm/pnpm/yarn/bun)"
    },
    "security-review": {
      "prompt": "# /security-review - Perform Security Review\n\nConduct a security review of code changes or the entire codebase.\n\n## Usage\n```\n/security-review [scope]\n```\n\nWhere scope is:\n- `staged` (default) - Review staged git changes\n- `recent` - Review last N commits (default 5)\n- `file <path>` - Review specific file\n- `full` - Full codebase security audit\n\n## Instructions\n\n### Security Review Checklist\n\nFor each scope, check for:\n\n#### 1. Secrets Detection\n- Hardcoded passwords, API keys, tokens\n- Private keys or certificates\n- Connection strings with credentials\n- AWS/Azure/GCP credentials\n\n```bash\n# Patterns to search for\ngrep -rn \"password\\s*=\" --include=\"*.cs\" --include=\"*.json\"\ngrep -rn \"apikey\\|api_key\\|api-key\" --include=\"*.cs\" --include=\"*.json\"\ngrep -rn \"secret\\s*=\" --include=\"*.cs\" --include=\"*.json\"\ngrep -rn \"connectionstring\\|connection_string\" --include=\"*.cs\" --include=\"*.json\"\n```\n\n#### 2. SQL Injection Vulnerabilities\n- Raw SQL queries with string concatenation\n- Non-parameterized queries\n- Dynamic SQL construction\n\n```csharp\n// BAD: Vulnerable to SQL injection\nvar query = $\"SELECT * FROM Users WHERE Id = {userId}\";\n\n// GOOD: Parameterized query\nvar user = await context.Users.FindAsync(userId);\n```\n\n#### 3. XSS Vulnerabilities\n- Unencoded user input in responses\n- Raw HTML rendering\n- Missing Content-Security-Policy headers\n\n#### 4. Authentication/Authorization\n- Missing [Authorize] attributes\n- Improper role checks\n- JWT configuration issues\n- Session management problems\n\n#### 5. Input Validation\n- Missing FluentValidation rules\n- Unvalidated file uploads\n- Missing size limits\n- Path traversal vulnerabilities\n\n#### 6. Dependency Vulnerabilities\n```bash\ndotnet list package --vulnerable\n```\n\n#### 7. Configuration Security\n- Debug mode in production\n- Verbose error messages\n- Missing HTTPS enforcement\n- Weak CORS policies\n\n### Output Format\n\n```markdown\n# Security Review Report\nDate: <timestamp>\nScope: <scope>\nReviewer: Claude Code\n\n## Summary\n| Severity | Count |\n|----------|-------|\n| Critical | X |\n| High | X |\n| Medium | X |\n| Low | X |\n| Info | X |\n\n## Findings\n\n### Critical\n\n#### [CRIT-001] Hardcoded API Key\n**File**: src/Services/PaymentService.cs:45\n**Issue**: API key hardcoded in source code\n**Risk**: Credential exposure in version control\n**Remediation**: Move to environment variable or secret store\n\n```csharp\n// Current (vulnerable)\nvar apiKey = \"sk_live_abc123\";\n\n// Recommended\nvar apiKey = Environment.GetEnvironmentVariable(\"PAYMENT_API_KEY\");\n```\n\n---\n\n### High\n\n#### [HIGH-001] SQL Injection Risk\n**File**: src/Repositories/UserRepository.cs:78\n**Issue**: String concatenation in SQL query\n...\n\n---\n\n## Recommendations\n\n1. Immediate action required for Critical findings\n2. Address High findings before release\n3. Plan remediation for Medium findings\n4. Consider addressing Low/Info in next sprint\n\n## Security Checklist Status\n\n- [ ] No hardcoded secrets\n- [ ] All queries parameterized\n- [ ] Input validation on all endpoints\n- [ ] Authentication on protected routes\n- [ ] HTTPS enforced\n- [ ] Security headers configured\n- [ ] Dependencies updated\n- [ ] Error messages sanitized\n```\n\n## Severity Guidelines\n\n- **Critical**: Immediate exploitation possible, data breach risk\n- **High**: Significant security weakness, requires prompt attention\n- **Medium**: Security best practice violation, should be addressed\n- **Low**: Minor issues, defense in depth improvements\n- **Info**: Recommendations for hardening\n\n## Example\n\n```\nUser: /security-review staged\n\nClaude: Reviewing staged changes for security issues...\n\n## Security Review Results\n\n### Files Reviewed\n- src/Controllers/UserController.cs\n- src/Services/AuthService.cs\n\n### Findings\n\n| Severity | Count |\n|----------|-------|\n| Critical | 0 |\n| High | 1 |\n| Medium | 2 |\n| Low | 0 |\n\n#### [HIGH-001] Missing Authorization\n**File**: src/Controllers/UserController.cs:34\n**Issue**: DELETE endpoint missing [Authorize] attribute\n**Risk**: Unauthenticated users could delete records\n\nRecommendation: Add `[Authorize(Roles = \"Admin\")]` to the endpoint.\n\n---\n\nAll critical issues: 0\nReady for commit: Yes (after addressing HIGH finding)\n```\n"
    },
    "scaffold": {
      "prompt": "# /scaffold - Create New Project from Template\n\nScaffold a new project using enterprise templates.\n\n## Usage\n```\n/scaffold <project-name> [template]\n```\n\nWhere:\n- `project-name`: The name for the new project (PascalCase recommended)\n- `template`: One of:\n  - `clean-architecture` (default) - Full .NET Clean Architecture solution\n  - `microservice` - Lightweight .NET microservice\n  - `react-frontend` - Next.js 14+ React frontend with auth\n  - `react-native` - Expo SDK 52+ mobile app with auth, observability\n\n## Instructions\n\nWhen invoked, perform the following steps:\n\n### 1. Validate Project Name\n- Must be valid identifier (PascalCase, no spaces/special chars)\n- Cannot conflict with existing projects in `projects/`\n\n### 2. Detect Template Type\n\n**For .NET templates** (`clean-architecture`, `microservice`):\n```bash\nmkdir -p projects/<ProjectName>\n```\n\n**For React template** (`react-frontend`):\n```bash\nmkdir -p projects/<ProjectName>-frontend\n```\n\n**For React Native template** (`react-native`):\n```bash\nmkdir -p projects/<ProjectName>-mobile\n```\n\n### 3. Copy Template Structure\n\n| Template | Source Path |\n|----------|-------------|\n| `clean-architecture` | `templates/clean-architecture-solution/` |\n| `microservice` | `templates/microservice-template/` |\n| `react-frontend` | `templates/react-frontend-template/` |\n| `react-native` | `templates/react-native-template/` |\n\n### 4. Replace Placeholders\n\nReplace `ProjectName` / `projectname` with the actual project name in:\n- Directory names\n- File names\n- File contents\n\n**For .NET**: `.csproj`, `.cs`, `.json`, `.yml`, `.sln` files\n**For React**: `package.json`, `.tsx`, `.ts`, `.env.example` files\n\n### 5. Initialize Project\n\n**For .NET templates**:\n```bash\ndotnet restore\ndotnet build\ndotnet test\n```\n\n**For React template**:\n```bash\nnpm install\nnpm run lint\nnpm run type-check\nnpm run build\n```\n\n**For React Native template**:\n```bash\nnpm install\nnpm run lint\nnpm run type-check\nnpm test\n```\n\n### 6. Create Initial Story\n- Create `artifacts/stories/ACF-001.md` for project setup\n- Include project scaffolding as the first tracked story\n\n### 7. Initialize Git (if not in repo)\n```bash\ngit init\ngit add .\ngit commit -m \"ACF-001 Initial project scaffold from template\"\n```\n\n## Output Structures\n\n### Clean Architecture (.NET)\n```\nprojects/<ProjectName>/\n‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îú‚îÄ‚îÄ <ProjectName>.Api/\n‚îÇ   ‚îú‚îÄ‚îÄ <ProjectName>.Application/\n‚îÇ   ‚îú‚îÄ‚îÄ <ProjectName>.Domain/\n‚îÇ   ‚îî‚îÄ‚îÄ <ProjectName>.Infrastructure/\n‚îú‚îÄ‚îÄ tests/\n‚îÇ   ‚îú‚îÄ‚îÄ <ProjectName>.UnitTests/\n‚îÇ   ‚îú‚îÄ‚îÄ <ProjectName>.IntegrationTests/\n‚îÇ   ‚îî‚îÄ‚îÄ <ProjectName>.ArchitectureTests/\n‚îú‚îÄ‚îÄ docker/\n‚îú‚îÄ‚îÄ docs/\n‚îú‚îÄ‚îÄ artifacts/stories/\n‚îú‚îÄ‚îÄ <ProjectName>.sln\n‚îî‚îÄ‚îÄ README.md\n```\n\n### React Frontend\n```\nprojects/<ProjectName>-frontend/\n‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îú‚îÄ‚îÄ app/                 # Next.js pages\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/           # Login, Register, Forgot Password\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dashboard/      # Protected pages\n‚îÇ   ‚îú‚îÄ‚îÄ components/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/             # shadcn/ui components\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout/         # Header, Sidebar\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ forms/          # Form components\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ tables/         # Data tables\n‚îÇ   ‚îú‚îÄ‚îÄ hooks/              # useAuth, custom hooks\n‚îÇ   ‚îú‚îÄ‚îÄ lib/                # API client, auth, utils\n‚îÇ   ‚îú‚îÄ‚îÄ stores/             # Zustand stores\n‚îÇ   ‚îú‚îÄ‚îÄ types/              # TypeScript types\n‚îÇ   ‚îî‚îÄ‚îÄ i18n/               # Translations\n‚îú‚îÄ‚îÄ e2e/                    # Playwright tests\n‚îú‚îÄ‚îÄ Dockerfile\n‚îú‚îÄ‚îÄ docker-compose.yml\n‚îî‚îÄ‚îÄ README.md\n```\n\n## Post-Scaffold Checklists\n\n### For .NET Projects\n1. Review and customize `appsettings.json`\n2. Set up `.env` from `.env.example`\n3. Configure database connection string\n4. Configure JWT secret\n5. Create first feature story with `/new-story`\n\n### For React Projects\n1. Copy `.env.example` to `.env.local`\n2. Set `NEXT_PUBLIC_API_URL` to backend URL\n3. Match `JWT_SECRET` with backend\n4. Review `src/config/site.ts`\n5. Create first feature story with `/new-story`\n\n### For React Native Projects\n1. Copy `.env.example` to `.env`\n2. Set `API_URL` to backend URL\n3. Configure `SENTRY_DSN` for observability\n4. Run `eas build:configure` for EAS setup\n5. Create first feature story with `/new-story`\n\n## Examples\n\n### Scaffold .NET Backend\n```\nUser: /scaffold OrderManagement\n\nClaude: Creating new project \"OrderManagement\" using clean-architecture template...\n\n1. Creating directory structure... done\n2. Copying template files... done\n3. Replacing placeholders... done\n4. Restoring dependencies... done\n5. Building solution... done\n6. Running tests... 15 passed\n\nProject created at: projects/OrderManagement/\n\nNext steps:\n1. cd projects/OrderManagement\n2. Review appsettings.json and configure database\n3. Create your first feature: /new-story <feature-name>\n4. Run: dotnet run --project src/OrderManagement.Api\n```\n\n### Scaffold React Frontend\n```\nUser: /scaffold OrderManagement react-frontend\n\nClaude: Creating new React frontend \"OrderManagement\" using react-frontend template...\n\n1. Creating directory structure... done\n2. Copying template files... done\n3. Replacing placeholders... done\n4. Installing dependencies... done\n5. Type checking... done\n6. Building... done\n\nProject created at: projects/OrderManagement-frontend/\n\nNext steps:\n1. cd projects/OrderManagement-frontend\n2. Copy .env.example to .env.local\n3. Set NEXT_PUBLIC_API_URL=http://localhost:5000/api\n4. Run: npm run dev\n5. Open http://localhost:3000\n\nTo connect with backend:\n- Ensure backend is running on port 5000\n- Match JWT_SECRET between frontend and backend\n- Configure CORS in backend for http://localhost:3000\n```\n\n### Scaffold Full Stack\n```\nUser: /scaffold FishSpot\n     /scaffold FishSpot react-frontend\n\nClaude: Full stack project created!\n\nBackend: projects/FishSpot/\nFrontend: projects/FishSpot-frontend/\n\nQuick start:\n# Terminal 1 - Backend\ncd projects/FishSpot\ndotnet run --project src/FishSpot.Api\n\n# Terminal 2 - Frontend\ncd projects/FishSpot-frontend\nnpm run dev\n\n# Open http://localhost:3000\n```\n\n### Scaffold Mobile App\n```\nUser: /scaffold FishSpot react-native\n\nClaude: Creating new React Native mobile app \"FishSpot\" using react-native template...\n\n1. Creating directory structure... done\n2. Copying template files... done\n3. Replacing placeholders... done\n4. Installing dependencies... done\n5. Type checking... done\n6. Running tests... done\n\nProject created at: projects/FishSpot-mobile/\n\nNext steps:\n1. cd projects/FishSpot-mobile\n2. Copy .env.example to .env\n3. Set API_URL=http://localhost:5000/api\n4. Run: npm start (or npm run dev:ios / npm run dev:android)\n\nTo connect with backend:\n- Ensure backend is running\n- Use your machine's IP address (not localhost) for physical devices\n- Configure CORS in backend for Expo development URLs\n```\n\n### Scaffold Complete Platform\n```\nUser: /scaffold FishSpot\n     /scaffold FishSpot react-frontend\n     /scaffold FishSpot react-native\n\nClaude: Complete platform created!\n\nBackend:  projects/FishSpot/\nWeb:      projects/FishSpot-frontend/\nMobile:   projects/FishSpot-mobile/\n\nAll three use shared patterns:\n- JWT authentication\n- TanStack Query for API calls\n- Unified TypeScript types\n- Consistent error handling\n```\n"
    },
    "release": {
      "prompt": "# /release - Prepare Release\n\nPrepare a release with all required artifacts and validations.\n\n## Usage\n```\n/release <version>\n```\n\nExample: `/release 1.2.0`\n\n## Instructions\n\n### Pre-Release Validation\n\n1. **Run all validation scripts**:\n   ```bash\n   ./scripts/validate-project.sh\n   ./scripts/validate-documentation.sh\n   ./scripts/validate-rnd-policy.sh\n   ```\n\n2. **Verify test coverage**:\n   ```bash\n   dotnet test --collect:\"XPlat Code Coverage\"\n   python3 scripts/coverage/check-coverage.py coverage.xml\n   ```\n\n3. **Run security scan**:\n   ```bash\n   dotnet list package --vulnerable\n   ```\n\n4. **Generate traceability report**:\n   ```bash\n   python3 scripts/traceability/traceability.py report \\\n     --story-root artifacts/stories \\\n     --test-root tests \\\n     --output artifacts/traceability/traceability-report.md\n   ```\n\n5. **Verify all stories complete**:\n   - All stories in this release have linked tests\n   - All tests pass\n   - Coverage thresholds met\n\n### Release Artifacts\n\nCreate/update the following:\n\n#### 1. Release Notes (`artifacts/traceability/release-notes-<version>.md`)\n\n```markdown\n# Release Notes - v<version>\n\n**Release Date**: <YYYY-MM-DD>\n**Type**: Major | Minor | Patch\n\n## Summary\n<Brief summary of this release>\n\n## New Features\n- **ACF-###**: <Feature description>\n- **ACF-###**: <Feature description>\n\n## Improvements\n- **ACF-###**: <Improvement description>\n\n## Bug Fixes\n- **ACF-###**: <Bug fix description>\n\n## Breaking Changes\n<List any breaking changes and migration steps>\n\n## Security Updates\n- <Security fix or dependency update>\n\n## Dependencies Updated\n| Package | From | To |\n|---------|------|-----|\n| Example.Package | 1.0.0 | 1.1.0 |\n\n## Known Issues\n- <Known issue and workaround if applicable>\n\n## Upgrade Guide\n<Steps to upgrade from previous version>\n\n## Contributors\n- Claude Code (AI-assisted development)\n- <Human reviewers/approvers>\n```\n\n#### 2. Security Review Checklist (`artifacts/traceability/security-review-<version>.md`)\n\n```markdown\n# Security Review Checklist - v<version>\n\n**Reviewer**: <name>\n**Date**: <YYYY-MM-DD>\n\n## Code Security\n- [ ] No hardcoded secrets\n- [ ] All inputs validated\n- [ ] SQL injection prevention (parameterized queries)\n- [ ] XSS prevention (output encoding)\n- [ ] CSRF protection enabled\n- [ ] Authentication on protected endpoints\n- [ ] Authorization checks implemented\n- [ ] Error messages don't leak sensitive info\n\n## Dependencies\n- [ ] No known vulnerabilities in dependencies\n- [ ] All dependencies from approved sources\n- [ ] Dependency versions pinned\n\n## Configuration\n- [ ] Secrets in environment variables\n- [ ] Debug mode disabled in production\n- [ ] HTTPS enforced\n- [ ] Security headers configured\n\n## Data Protection\n- [ ] PII properly encrypted\n- [ ] Data retention policies followed\n- [ ] Audit logging implemented\n\n## Approval\n| Role | Name | Date | Approved |\n|------|------|------|----------|\n| Security Lead | | | [ ] |\n| Tech Lead | | | [ ] |\n```\n\n#### 3. Release Readiness Checklist (`artifacts/traceability/release-readiness-<version>.md`)\n\n```markdown\n# Release Readiness Checklist - v<version>\n\n**Target Date**: <YYYY-MM-DD>\n\n## Quality Gates\n- [ ] All tests pass\n- [ ] Coverage >= 80%\n- [ ] No critical/high security vulnerabilities\n- [ ] No P1/P2 bugs open\n- [ ] Performance benchmarks met\n\n## Documentation\n- [ ] API documentation updated\n- [ ] User guide updated\n- [ ] Deployment guide updated\n- [ ] Release notes complete\n\n## Artifacts\n- [ ] Traceability report generated\n- [ ] Security review completed\n- [ ] Release notes approved\n\n## Deployment\n- [ ] Docker images built and tested\n- [ ] Kubernetes manifests updated\n- [ ] Environment variables documented\n- [ ] Rollback plan documented\n\n## Approval\n| Role | Name | Date | Approved |\n|------|------|------|----------|\n| Product Owner | | | [ ] |\n| QA Lead | | | [ ] |\n| Security Lead | | | [ ] |\n| DevOps Lead | | | [ ] |\n```\n\n### Version Tagging\n\nAfter all approvals:\n\n```bash\n# Update version in project files\n# Directory.Build.props or .csproj files\n\n# Commit version bump\ngit add .\ngit commit -m \"chore: bump version to <version>\"\n\n# Create annotated tag\ngit tag -a v<version> -m \"Release v<version>\n\n<Brief summary>\n\nCo-Authored-By: Claude <noreply@anthropic.com>\"\n\n# Push tag\ngit push origin v<version>\n```\n\n## Output Format\n\n```markdown\n## Release Preparation: v<version>\n\n### Pre-Release Checks\n\n| Check | Status | Details |\n|-------|--------|---------|\n| Project Validation | PASS | No issues |\n| Documentation | PASS | All docs present |\n| Policy Compliance | PASS | Meets R&D policy |\n| Test Coverage | PASS | 87% coverage |\n| Security Scan | PASS | 0 vulnerabilities |\n| Traceability | PASS | 12/12 stories linked |\n\n### Artifacts Generated\n- [x] Release notes: artifacts/traceability/release-notes-<version>.md\n- [x] Security review: artifacts/traceability/security-review-<version>.md\n- [x] Release readiness: artifacts/traceability/release-readiness-<version>.md\n- [x] Traceability report: artifacts/traceability/traceability-report.md\n\n### Stories in This Release\n| Story | Title | Tests | Status |\n|-------|-------|-------|--------|\n| ACF-040 | User Registration | 5 | Complete |\n| ACF-041 | Password Reset | 3 | Complete |\n| ACF-042 | User Login | 4 | Complete |\n\n### Pending Approvals\n- [ ] Product Owner\n- [ ] Security Lead\n- [ ] DevOps Lead\n\n### Next Steps\n1. Get required approvals on checklists\n2. Run `/release tag v<version>` after approval\n```\n\n## Example\n\n```\nUser: /release 1.2.0\n\nClaude: Preparing release v1.2.0...\n\n## Pre-Release Validation\n\nRunning validation scripts...\n- validate-project.sh: PASS\n- validate-documentation.sh: PASS\n- validate-rnd-policy.sh: PASS\n- test coverage: 87% (>80% required) PASS\n- security scan: 0 vulnerable packages PASS\n\n## Generating Release Artifacts\n\nCreated:\n- artifacts/traceability/release-notes-1.2.0.md\n- artifacts/traceability/security-review-1.2.0.md\n- artifacts/traceability/release-readiness-1.2.0.md\n\n## Release Summary\n\n**Version**: 1.2.0\n**Stories Included**: 5\n**Test Coverage**: 87%\n**Breaking Changes**: None\n\nReady for approval review.\n```\n"
    },
    "refactor": {
      "prompt": "# /refactor - Refactoring Assistant\n\nSafely refactor code with automatic safety checks, backups, and test validation.\n\n## Usage\n```\n/refactor <type> [target] [options]\n```\n\nTypes:\n- `rename` - Rename symbol (class, method, variable)\n- `extract` - Extract method, class, or interface\n- `inline` - Inline method or variable\n- `move` - Move to different file/namespace\n- `simplify` - Simplify complex code\n- `modernize` - Update to modern C# patterns\n\nOptions:\n- `--dry-run` - Preview changes without applying\n- `--no-backup` - Skip creating backup branch\n- `--force` - Skip confirmation prompts\n- `--scope <file|project|solution>` - Limit refactoring scope\n\n## Instructions\n\n### Safety Protocol\n\nBefore any refactoring:\n\n1. **Create Backup Branch**\n```bash\n# Create backup branch\nBACKUP_BRANCH=\"refactor-backup-$(date +%Y%m%d-%H%M%S)\"\ngit checkout -b $BACKUP_BRANCH\ngit checkout -\n\n# Store branch name for potential rollback\necho $BACKUP_BRANCH > .claude/refactor-backup\n```\n\n2. **Run Pre-Refactor Tests**\n```bash\n# Ensure tests pass before refactoring\ndotnet test --no-build --verbosity quiet\nif [ $? -ne 0 ]; then\n  echo \"‚ùå Tests failing - refactoring aborted\"\n  exit 1\nfi\n```\n\n3. **Analyze Impact**\n```bash\n# Find all usages of target symbol\ngrep -rn \"SymbolName\" src/ tests/ --include=\"*.cs\"\n```\n\n### Rename Refactoring (`/refactor rename`)\n\n```\nUser: /refactor rename OrderService to OrderManager\n\nClaude: üîÑ Rename Refactoring: OrderService ‚Üí OrderManager\n\n## Pre-flight Checks\n‚úÖ Tests passing (168/168)\n‚úÖ Backup branch created: refactor-backup-20250120-103000\n‚úÖ No uncommitted changes\n\n## Impact Analysis\n\nFiles affected: 12\nReferences found: 47\n\n### Files to Modify\n| File | Changes | Type |\n|------|---------|------|\n| src/Application/Services/OrderService.cs | 2 | Definition |\n| src/Application/Services/IOrderService.cs | 1 | Interface |\n| src/API/Controllers/OrdersController.cs | 3 | Usage |\n| src/Infrastructure/DependencyInjection.cs | 2 | Registration |\n| tests/UnitTests/OrderServiceTests.cs | 15 | Tests |\n| ... and 7 more files | 24 | Various |\n\n### Proposed Changes\n\n**1. Rename class definition**\n```csharp\n// Before: src/Application/Services/OrderService.cs\npublic class OrderService : IOrderService\n\n// After: src/Application/Services/OrderManager.cs\npublic class OrderManager : IOrderService\n```\n\n**2. Update interface (optional)**\n```csharp\n// Rename IOrderService ‚Üí IOrderManager? [y/n]\n```\n\n**3. Update file name**\n```\nOrderService.cs ‚Üí OrderManager.cs\n```\n\n**4. Update DI registration**\n```csharp\n// Before\nservices.AddScoped<IOrderService, OrderService>();\n\n// After\nservices.AddScoped<IOrderService, OrderManager>();\n```\n\n**5. Update test files**\n```csharp\n// Before: tests/UnitTests/OrderServiceTests.cs\npublic class OrderServiceTests\n\n// After: tests/UnitTests/OrderManagerTests.cs\npublic class OrderManagerTests\n```\n\n## Confirmation\n\nProceed with refactoring? [y/n/preview]\n```\n\n### Extract Method (`/refactor extract method`)\n\n```\nUser: /refactor extract method --from OrderService.ProcessOrder --lines 45-62\n\nClaude: üîÑ Extract Method Refactoring\n\n## Source Analysis\n\nFile: src/Application/Services/OrderService.cs\nMethod: ProcessOrder\nLines: 45-62\n\n### Code to Extract\n```csharp\n// Lines 45-62 in ProcessOrder\nvar discount = 0m;\nif (order.Customer.IsPremium)\n{\n    discount = order.Total * 0.1m;\n}\nelse if (order.Total > 100)\n{\n    discount = order.Total * 0.05m;\n}\nelse if (order.Customer.OrderCount > 10)\n{\n    discount = order.Total * 0.03m;\n}\norder.ApplyDiscount(discount);\n```\n\n### Proposed Extraction\n\n**New method signature:**\n```csharp\nprivate decimal CalculateDiscount(Order order)\n{\n    if (order.Customer.IsPremium)\n        return order.Total * 0.1m;\n\n    if (order.Total > 100)\n        return order.Total * 0.05m;\n\n    if (order.Customer.OrderCount > 10)\n        return order.Total * 0.03m;\n\n    return 0m;\n}\n```\n\n**Updated ProcessOrder:**\n```csharp\npublic async Task ProcessOrder(Order order)\n{\n    // ... previous code ...\n\n    var discount = CalculateDiscount(order);\n    order.ApplyDiscount(discount);\n\n    // ... remaining code ...\n}\n```\n\n### Suggestions\n1. Consider making `CalculateDiscount` a pure function\n2. This logic could be moved to Order entity (domain logic)\n3. Consider using a DiscountCalculator service for complex rules\n\nApply extraction? [y/n]\n```\n\n### Extract Interface (`/refactor extract interface`)\n\n```\nUser: /refactor extract interface OrderService\n\nClaude: üîÑ Extract Interface Refactoring\n\n## Analysis\n\nClass: OrderService\nLocation: src/Application/Services/OrderService.cs\n\n### Public Members Detected\n```csharp\npublic class OrderService\n{\n    public async Task<Order> CreateOrderAsync(CreateOrderDto dto);\n    public async Task<Order> GetOrderAsync(Guid id);\n    public async Task<IEnumerable<Order>> GetOrdersForCustomerAsync(Guid customerId);\n    public async Task UpdateOrderStatusAsync(Guid id, OrderStatus status);\n    public async Task CancelOrderAsync(Guid id);\n}\n```\n\n### Proposed Interface\n```csharp\n// New file: src/Application/Services/IOrderService.cs\nnamespace Application.Services;\n\npublic interface IOrderService\n{\n    Task<Order> CreateOrderAsync(CreateOrderDto dto);\n    Task<Order> GetOrderAsync(Guid id);\n    Task<IEnumerable<Order>> GetOrdersForCustomerAsync(Guid customerId);\n    Task UpdateOrderStatusAsync(Guid id, OrderStatus status);\n    Task CancelOrderAsync(Guid id);\n}\n```\n\n### Updated Class\n```csharp\npublic class OrderService : IOrderService\n{\n    // Implementation unchanged\n}\n```\n\n### Additional Updates\n- DI registration: `services.AddScoped<IOrderService, OrderService>()`\n- Update consumers to use `IOrderService`\n\nFiles to update: 5\n- DependencyInjection.cs\n- OrdersController.cs\n- OrderServiceTests.cs (mock IOrderService)\n\nCreate interface? [y/n]\n```\n\n### Move Refactoring (`/refactor move`)\n\n```\nUser: /refactor move OrderValidator to Domain layer\n\nClaude: üîÑ Move Refactoring\n\n## Current Location\nFile: src/Application/Validators/OrderValidator.cs\nNamespace: Application.Validators\n\n## Target Location\nFile: src/Domain/Validators/OrderValidator.cs\nNamespace: Domain.Validators\n\n## Analysis\n\n### Dependencies Check\nCurrent dependencies:\n- FluentValidation ‚úÖ (available in Domain)\n- Application.DTOs ‚ùå (not available in Domain)\n\n### Issues Detected\n‚ö†Ô∏è OrderValidator depends on CreateOrderDto (Application layer)\n\n### Suggested Resolution\n1. Create domain model OrderValidationInput\n2. Move validation logic to domain\n3. Keep DTO-specific validation in Application\n\n### Alternative Approach\nMove validation rules to Order entity:\n```csharp\n// Domain/Entities/Order.cs\npublic class Order\n{\n    public static Result<Order> Create(string customerId, List<OrderItem> items)\n    {\n        var errors = new List<string>();\n\n        if (string.IsNullOrEmpty(customerId))\n            errors.Add(\"Customer ID is required\");\n\n        if (!items.Any())\n            errors.Add(\"Order must have at least one item\");\n\n        if (errors.Any())\n            return Result.Failure<Order>(errors);\n\n        return Result.Success(new Order(customerId, items));\n    }\n}\n```\n\nChoose approach:\n1. Move with domain model adapter\n2. Move validation to entity (DDD)\n3. Keep in Application layer\n4. Cancel\n\n[1/2/3/4]\n```\n\n### Simplify (`/refactor simplify`)\n\n```\nUser: /refactor simplify OrderService.GetOrderStatus\n\nClaude: üîÑ Simplify Refactoring\n\n## Analyzing: OrderService.GetOrderStatus\n\n### Current Code (Complexity: 8)\n```csharp\npublic string GetOrderStatus(Order order)\n{\n    string status;\n    if (order == null)\n    {\n        status = \"Unknown\";\n    }\n    else if (order.IsCancelled)\n    {\n        status = \"Cancelled\";\n    }\n    else if (order.IsShipped)\n    {\n        status = \"Shipped\";\n    }\n    else if (order.IsPaid)\n    {\n        status = \"Processing\";\n    }\n    else\n    {\n        status = \"Pending\";\n    }\n    return status;\n}\n```\n\n### Simplified Code (Complexity: 3)\n```csharp\npublic string GetOrderStatus(Order? order) => order switch\n{\n    null => \"Unknown\",\n    { IsCancelled: true } => \"Cancelled\",\n    { IsShipped: true } => \"Shipped\",\n    { IsPaid: true } => \"Processing\",\n    _ => \"Pending\"\n};\n```\n\n### Improvements\n- ‚úÖ Reduced cyclomatic complexity: 8 ‚Üí 3\n- ‚úÖ Removed mutable variable\n- ‚úÖ Used pattern matching\n- ‚úÖ Expression-bodied member\n- ‚úÖ Nullable annotation added\n\n### Additional Suggestions\n1. Consider using an enum for status\n2. This logic could be a property on Order entity:\n   ```csharp\n   public OrderStatus Status => this switch { ... };\n   ```\n\nApply simplification? [y/n]\n```\n\n### Modernize (`/refactor modernize`)\n\n```\nUser: /refactor modernize OrderService\n\nClaude: üîÑ Modernize Refactoring\n\n## Analyzing: OrderService\n\nChecking for modernization opportunities...\n\n### Found 8 Modernization Opportunities\n\n**1. Primary Constructor (C# 12)**\n```csharp\n// Before\npublic class OrderService\n{\n    private readonly IOrderRepository _repository;\n    private readonly ILogger<OrderService> _logger;\n\n    public OrderService(IOrderRepository repository, ILogger<OrderService> logger)\n    {\n        _repository = repository;\n        _logger = logger;\n    }\n}\n\n// After\npublic class OrderService(IOrderRepository repository, ILogger<OrderService> logger)\n{\n    // Fields auto-generated\n}\n```\n\n**2. Collection Expressions (C# 12)**\n```csharp\n// Before\nvar items = new List<OrderItem>();\n\n// After\nList<OrderItem> items = [];\n```\n\n**3. Pattern Matching (C# 9+)**\n```csharp\n// Before\nif (order != null && order.Status == OrderStatus.Pending)\n\n// After\nif (order is { Status: OrderStatus.Pending })\n```\n\n**4. Null-Coalescing Assignment (C# 8)**\n```csharp\n// Before\nif (_cache == null)\n    _cache = new Dictionary<Guid, Order>();\n\n// After\n_cache ??= new Dictionary<Guid, Order>();\n```\n\n**5. File-Scoped Namespace (C# 10)**\n```csharp\n// Before\nnamespace Application.Services\n{\n    public class OrderService { }\n}\n\n// After\nnamespace Application.Services;\n\npublic class OrderService { }\n```\n\n**6. Target-Typed New (C# 9)**\n```csharp\n// Before\nOrder order = new Order();\n\n// After\nOrder order = new();\n```\n\n**7. Raw String Literals (C# 11)**\n```csharp\n// Before\nvar query = \"SELECT * FROM Orders WHERE Status = 'Pending'\";\n\n// After\nvar query = \"\"\"\n    SELECT * FROM Orders\n    WHERE Status = 'Pending'\n    \"\"\";\n```\n\n**8. Required Members (C# 11)**\n```csharp\n// Before (relies on constructor)\npublic class OrderDto\n{\n    public Guid Id { get; set; }\n    public string CustomerName { get; set; }\n}\n\n// After\npublic class OrderDto\n{\n    public required Guid Id { get; init; }\n    public required string CustomerName { get; init; }\n}\n```\n\n### Apply Modernizations\n\nSelect which to apply:\n- [x] Primary constructors\n- [x] Collection expressions\n- [x] Pattern matching\n- [x] Null-coalescing assignment\n- [x] File-scoped namespaces\n- [x] Target-typed new\n- [ ] Raw string literals (manual review needed)\n- [ ] Required members (breaking change)\n\nApply selected modernizations? [y/n]\n```\n\n### Post-Refactor Validation\n\nAfter any refactoring:\n\n```\n## Post-Refactor Validation\n\nRunning tests...\n‚úÖ 168/168 tests passing\n\nRunning build...\n‚úÖ Build succeeded (0 warnings)\n\nChecking for breaking changes...\n‚úÖ No public API changes detected\n\n## Refactoring Complete\n\nChanges made:\n- 12 files modified\n- 47 references updated\n- 0 errors introduced\n\nBackup branch: refactor-backup-20250120-103000\n\nTo rollback:\n  git checkout refactor-backup-20250120-103000\n\nTo clean up:\n  git branch -d refactor-backup-20250120-103000\n```\n\n### Rollback Procedure\n\n```\nUser: /refactor --rollback\n\nClaude: üîÑ Rollback Refactoring\n\nLast refactoring: OrderService ‚Üí OrderManager\nBackup branch: refactor-backup-20250120-103000\nTime: 15 minutes ago\n\nFiles to restore: 12\n\n‚ö†Ô∏è Warning: This will discard all changes since the refactoring.\n\nProceed with rollback? [y/n]\n\nUser: y\n\nClaude: Rolling back...\n\n‚úÖ Changes reverted\n‚úÖ Backup branch still available for reference\n\nRollback complete. Code restored to pre-refactoring state.\n```\n\n## Example\n\n```\nUser: /refactor rename CustomerRepository to CustomerDataStore --dry-run\n\nClaude: üîÑ Rename Refactoring (DRY RUN)\n\nCustomerRepository ‚Üí CustomerDataStore\n\n## Impact Preview\n\nFiles: 8\nReferences: 23\n\nChanges that WOULD be made:\n1. src/Infrastructure/Repositories/CustomerRepository.cs\n   - Rename file to CustomerDataStore.cs\n   - Rename class\n\n2. src/Domain/Repositories/ICustomerRepository.cs\n   - Rename to ICustomerDataStore.cs\n   - Rename interface\n\n3. src/Infrastructure/DependencyInjection.cs\n   - Update registration\n\n4. src/Application/Handlers/GetCustomerHandler.cs\n   - Update constructor parameter\n\n[... 4 more files ...]\n\nThis is a dry run. No changes were made.\n\nTo apply: /refactor rename CustomerRepository to CustomerDataStore\n```\n"
    },
    "refactor-clean": {
      "prompt": "# Refactor Clean\n\nSafely identify and remove dead code with test verification:\n\n1. Run dead code analysis tools:\n   - knip: Find unused exports and files\n   - depcheck: Find unused dependencies\n   - ts-prune: Find unused TypeScript exports\n\n2. Generate comprehensive report in .reports/dead-code-analysis.md\n\n3. Categorize findings by severity:\n   - SAFE: Test files, unused utilities\n   - CAUTION: API routes, components\n   - DANGER: Config files, main entry points\n\n4. Propose safe deletions only\n\n5. Before each deletion:\n   - Run full test suite\n   - Verify tests pass\n   - Apply change\n   - Re-run tests\n   - Rollback if tests fail\n\n6. Show summary of cleaned items\n\nNever delete code without running tests first!\n"
    },
    "quality-check": {
      "prompt": "---\ndescription: Run comprehensive code quality checks combining multiple analysis tools\n---\n\nRun a comprehensive code quality check combining multiple skills and validation tools.\n\n## Quality Check Workflow\n\nPerform the following checks in order based on project type:\n\n### 1. Code Quality Analysis\n\n- **Code Review** - Use code-reviewer agent for code quality analysis\n- **Pattern Detection** - Use pattern-detector skill to identify anti-patterns\n- **Complexity Analysis** - Use complexity-analyzer skill to measure cyclomatic complexity\n- **Dead Code Detection** - Use dead-code-detector or refactor-cleaner agent\n\n### 2. Security Analysis\n\n- **Secret Scanner** - Check for exposed secrets in codebase\n- **Dependency Audit** - Check for vulnerable dependencies\n- **Security Headers** - Validate security headers (web apps)\n\n### 3. .NET Specific (if applicable)\n\n- Run `dotnet build --warningsAsErrors`\n- Run `dotnet test --collect:\"XPlat Code Coverage\"`\n- Check coverage meets 80% threshold\n- Run architecture tests with NetArchTest\n\n### 4. Frontend Specific (if applicable)\n\n- Run `npm run lint` or `pnpm lint`\n- Run `npm run build` to check for TypeScript errors\n- Run `npm test -- --coverage`\n\n## Instructions\n\nFor each applicable check:\n1. Run the analysis\n2. Report findings\n3. Provide actionable recommendations\n4. Note severity (Critical/High/Medium/Low)\n\n## Final Summary Report\n\nGenerate a final summary with:\n- **Overall Quality Score** (0-100)\n- **Critical Issues** (must fix immediately)\n- **High Issues** (fix before merge)\n- **Medium Issues** (fix when possible)\n- **Top 5 Recommendations**\n- **Quick Wins** (easy fixes with high impact)\n\n## Integration with CI\n\nThis check aligns with the PR validation pipeline:\n```bash\n./scripts/validate-project.sh\n./scripts/validate-documentation.sh\n```\n",
      "description": "Run comprehensive code quality checks combining multiple analysis tools"
    },
    "pre-deploy": {
      "prompt": "---\ndescription: Run pre-deployment validation checks before releasing to production\n---\n\nRun comprehensive pre-deployment validation before releasing to production.\n\n## Pre-Deployment Checklist\n\nExecute the following checks:\n\n### 1. Code Quality Gates\n\n- [ ] **Build Success** - Ensure clean build with no warnings\n- [ ] **Test Coverage** - Verify 80%+ coverage on Domain/Application layers\n- [ ] **Code Review** - Final code review check completed\n- [ ] **Architecture Tests** - Clean Architecture dependency rules pass\n\n### 2. Security Validation\n\n- [ ] **Secret Scanner** - No exposed secrets in codebase\n- [ ] **Dependency Audit** - No high/critical vulnerabilities\n- [ ] **Security Review** - Use security-reviewer agent for final check\n- [ ] **OWASP Top 10** - Common vulnerabilities addressed\n\n### 3. Configuration Validation\n\n- [ ] **Environment Variables** - All required env vars documented\n- [ ] **Connection Strings** - No hardcoded connection strings\n- [ ] **API Keys** - Use secrets management (Azure Key Vault, etc.)\n- [ ] **Feature Flags** - Production flags properly configured\n\n### 4. Infrastructure Readiness\n\n- [ ] **Docker Build** - Container builds and runs successfully\n- [ ] **Health Checks** - `/health` and `/ready` endpoints work\n- [ ] **Database Migrations** - All migrations applied and tested\n- [ ] **Resource Limits** - CPU/memory limits configured\n\n### 5. Traceability Validation\n\n- [ ] **Story Linkage** - All changes linked to story IDs (ACF-###)\n- [ ] **Test Coverage** - Tests tagged with story traits\n- [ ] **Release Notes** - Changes documented in release notes\n\n## Output Format\n\nFor each check:\n- ‚úÖ **PASS** - Requirement met\n- ‚ùå **FAIL** - Blocking issue found\n- ‚ö†Ô∏è **WARN** - Non-blocking concern\n\n## Final Decision\n\nProvide a **GO/NO-GO** decision for deployment:\n\n### GO Criteria\n- All FAIL items resolved\n- No critical security vulnerabilities\n- Test coverage >= 80%\n- All migrations tested\n\n### Report Structure\n\n```\n## Deployment Readiness Report\nDate: [Date]\nVersion: [Version]\nDecision: GO/NO-GO\n\n### Blocking Issues (Must Fix)\n- [List of FAIL items]\n\n### Warnings (Should Fix Soon)\n- [List of WARN items]\n\n### Verification Commands Run\n- `dotnet build --warningsAsErrors`\n- `dotnet test --collect:\"XPlat Code Coverage\"`\n- `./scripts/validate-project.sh`\n- `python3 scripts/traceability/traceability.py validate`\n\n### Sign-off\n- [ ] Dev Lead Approval\n- [ ] QA Sign-off\n- [ ] Security Review Complete\n```\n\n**If any blocking issues exist, recommend NO-GO and list what must be fixed.**\n",
      "description": "Run pre-deployment validation checks before releasing to production"
    },
    "plan": {
      "prompt": "---\ndescription: Restate requirements, assess risks, and create step-by-step implementation plan. WAIT for user CONFIRM before touching any code.\n---\n\n# Plan Command\n\nThis command invokes the **planner** agent to create a comprehensive implementation plan before writing any code.\n\n## What This Command Does\n\n1. **Restate Requirements** - Clarify what needs to be built\n2. **Identify Risks** - Surface potential issues and blockers\n3. **Create Step Plan** - Break down implementation into phases\n4. **Wait for Confirmation** - MUST receive user approval before proceeding\n\n## When to Use\n\nUse `/plan` when:\n- Starting a new feature\n- Making significant architectural changes\n- Working on complex refactoring\n- Multiple files/components will be affected\n- Requirements are unclear or ambiguous\n\n## How It Works\n\nThe planner agent will:\n\n1. **Analyze the request** and restate requirements in clear terms\n2. **Break down into phases** with specific, actionable steps\n3. **Identify dependencies** between components\n4. **Assess risks** and potential blockers\n5. **Estimate complexity** (High/Medium/Low)\n6. **Present the plan** and WAIT for your explicit confirmation\n\n## Example Usage\n\n```\nUser: /plan I need to add real-time notifications when markets resolve\n\nAgent (planner):\n# Implementation Plan: Real-Time Market Resolution Notifications\n\n## Requirements Restatement\n- Send notifications to users when markets they're watching resolve\n- Support multiple notification channels (in-app, email, webhook)\n- Ensure notifications are delivered reliably\n- Include market outcome and user's position result\n\n## Implementation Phases\n\n### Phase 1: Database Schema\n- Add notifications table with columns: id, user_id, market_id, type, status, created_at\n- Add user_notification_preferences table for channel preferences\n- Create indexes on user_id and market_id for performance\n\n### Phase 2: Notification Service\n- Create notification service in lib/notifications.ts\n- Implement notification queue using BullMQ/Redis\n- Add retry logic for failed deliveries\n- Create notification templates\n\n### Phase 3: Integration Points\n- Hook into market resolution logic (when status changes to \"resolved\")\n- Query all users with positions in market\n- Enqueue notifications for each user\n\n### Phase 4: Frontend Components\n- Create NotificationBell component in header\n- Add NotificationList modal\n- Implement real-time updates via Supabase subscriptions\n- Add notification preferences page\n\n## Dependencies\n- Redis (for queue)\n- Email service (SendGrid/Resend)\n- Supabase real-time subscriptions\n\n## Risks\n- HIGH: Email deliverability (SPF/DKIM required)\n- MEDIUM: Performance with 1000+ users per market\n- MEDIUM: Notification spam if markets resolve frequently\n- LOW: Real-time subscription overhead\n\n## Estimated Complexity: MEDIUM\n- Backend: 4-6 hours\n- Frontend: 3-4 hours\n- Testing: 2-3 hours\n- Total: 9-13 hours\n\n**WAITING FOR CONFIRMATION**: Proceed with this plan? (yes/no/modify)\n```\n\n## Important Notes\n\n**CRITICAL**: The planner agent will **NOT** write any code until you explicitly confirm the plan with \"yes\" or \"proceed\" or similar affirmative response.\n\nIf you want changes, respond with:\n- \"modify: [your changes]\"\n- \"different approach: [alternative]\"\n- \"skip phase 2 and do phase 3 first\"\n\n## Integration with Other Commands\n\nAfter planning:\n- Use `/tdd` to implement with test-driven development\n- Use `/build-and-fix` if build errors occur\n- Use `/code-review` to review completed implementation\n\n## Related Agents\n\nThis command invokes the `planner` agent located at:\n`~/.claude/agents/planner.md`\n",
      "description": "Restate requirements, assess risks, and create step-by-step implementation plan. WAIT for user CONFIRM before touching any code."
    },
    "orchestrate": {
      "prompt": "# Orchestrate Command\n\nSequential agent workflow for complex tasks.\n\n## Usage\n\n`/orchestrate [workflow-type] [task-description]`\n\n## Workflow Types\n\n### feature\nFull feature implementation workflow:\n```\nplanner -> tdd-guide -> code-reviewer -> security-reviewer\n```\n\n### bugfix\nBug investigation and fix workflow:\n```\nexplorer -> tdd-guide -> code-reviewer\n```\n\n### refactor\nSafe refactoring workflow:\n```\narchitect -> code-reviewer -> tdd-guide\n```\n\n### security\nSecurity-focused review:\n```\nsecurity-reviewer -> code-reviewer -> architect\n```\n\n## Execution Pattern\n\nFor each agent in the workflow:\n\n1. **Invoke agent** with context from previous agent\n2. **Collect output** as structured handoff document\n3. **Pass to next agent** in chain\n4. **Aggregate results** into final report\n\n## Handoff Document Format\n\nBetween agents, create handoff document:\n\n```markdown\n## HANDOFF: [previous-agent] -> [next-agent]\n\n### Context\n[Summary of what was done]\n\n### Findings\n[Key discoveries or decisions]\n\n### Files Modified\n[List of files touched]\n\n### Open Questions\n[Unresolved items for next agent]\n\n### Recommendations\n[Suggested next steps]\n```\n\n## Example: Feature Workflow\n\n```\n/orchestrate feature \"Add user authentication\"\n```\n\nExecutes:\n\n1. **Planner Agent**\n   - Analyzes requirements\n   - Creates implementation plan\n   - Identifies dependencies\n   - Output: `HANDOFF: planner -> tdd-guide`\n\n2. **TDD Guide Agent**\n   - Reads planner handoff\n   - Writes tests first\n   - Implements to pass tests\n   - Output: `HANDOFF: tdd-guide -> code-reviewer`\n\n3. **Code Reviewer Agent**\n   - Reviews implementation\n   - Checks for issues\n   - Suggests improvements\n   - Output: `HANDOFF: code-reviewer -> security-reviewer`\n\n4. **Security Reviewer Agent**\n   - Security audit\n   - Vulnerability check\n   - Final approval\n   - Output: Final Report\n\n## Final Report Format\n\n```\nORCHESTRATION REPORT\n====================\nWorkflow: feature\nTask: Add user authentication\nAgents: planner -> tdd-guide -> code-reviewer -> security-reviewer\n\nSUMMARY\n-------\n[One paragraph summary]\n\nAGENT OUTPUTS\n-------------\nPlanner: [summary]\nTDD Guide: [summary]\nCode Reviewer: [summary]\nSecurity Reviewer: [summary]\n\nFILES CHANGED\n-------------\n[List all files modified]\n\nTEST RESULTS\n------------\n[Test pass/fail summary]\n\nSECURITY STATUS\n---------------\n[Security findings]\n\nRECOMMENDATION\n--------------\n[SHIP / NEEDS WORK / BLOCKED]\n```\n\n## Parallel Execution\n\nFor independent checks, run agents in parallel:\n\n```markdown\n### Parallel Phase\nRun simultaneously:\n- code-reviewer (quality)\n- security-reviewer (security)\n- architect (design)\n\n### Merge Results\nCombine outputs into single report\n```\n\n## Arguments\n\n$ARGUMENTS:\n- `feature <description>` - Full feature workflow\n- `bugfix <description>` - Bug fix workflow\n- `refactor <description>` - Refactoring workflow\n- `security <description>` - Security review workflow\n- `custom <agents> <description>` - Custom agent sequence\n\n## Custom Workflow Example\n\n```\n/orchestrate custom \"architect,tdd-guide,code-reviewer\" \"Redesign caching layer\"\n```\n\n## Tips\n\n1. **Start with planner** for complex features\n2. **Always include code-reviewer** before merge\n3. **Use security-reviewer** for auth/payment/PII\n4. **Keep handoffs concise** - focus on what next agent needs\n5. **Run verification** between agents if needed\n"
    },
    "new-story": {
      "prompt": "# /new-story - Create a New User Story\n\nCreate a new INVEST-compliant user story with interactive wizard and intelligent suggestions.\n\n## Usage\n```\n/new-story [title] [options]\n```\n\nOptions:\n- `--quick` - Skip interactive prompts, use defaults\n- `--epic <epic-id>` - Link to parent epic\n- `--type <feature|bug|tech-debt|spike>` - Story type (default: feature)\n- `--points <n>` - Set story points\n- `--sprint <name>` - Assign to sprint\n\n## Instructions\n\nWhen invoked, use the Interactive Story Wizard:\n\n### Phase 1: Story Identification\n\n#### 1. Determine Next Story ID\n```bash\n# Find highest ACF number\nLATEST=$(ls artifacts/stories/ACF-*.md 2>/dev/null | \\\n  sed 's/.*ACF-0*\\([0-9]*\\).*/\\1/' | \\\n  sort -n | tail -1)\nNEXT_ID=$(printf \"ACF-%03d\" $((LATEST + 1)))\n```\n\n#### 2. Analyze Existing Stories for Context\n```bash\n# Extract common personas\ngrep -h \"As a\" artifacts/stories/*.md | sort | uniq -c | sort -rn | head -5\n\n# Extract common domains\ngrep -h \"## Technical Notes\" -A 5 artifacts/stories/*.md | \\\n  grep -oE \"(Order|User|Product|Payment|Inventory)\" | sort | uniq -c\n```\n\n### Phase 2: Interactive Wizard\n\n#### Step 1: Story Type Selection\n\n**Ask user to select story type:**\n\n| Type | Description | Template Focus |\n|------|-------------|----------------|\n| üÜï Feature | New functionality | User value, acceptance criteria |\n| üêõ Bug | Fix defect | Steps to reproduce, expected vs actual |\n| üîß Tech Debt | Code improvement | Technical justification, impact |\n| üî¨ Spike | Research/investigation | Questions to answer, timebox |\n\n#### Step 2: Persona Selection (with suggestions)\n\n**Present common personas from existing stories:**\n\n```\nSelect or enter the user persona:\n\n  Suggested (from existing stories):\n  1. registered user (used in 12 stories)\n  2. admin (used in 8 stories)\n  3. guest (used in 5 stories)\n  4. system administrator (used in 3 stories)\n\n  Or enter a new persona: ___________\n```\n\n**Persona templates:**\n- `registered user` ‚Üí Full access to user features\n- `admin` ‚Üí Administrative capabilities\n- `guest` ‚Üí Limited, unauthenticated access\n- `API consumer` ‚Üí External system integration\n- `support agent` ‚Üí Customer service functions\n\n#### Step 3: Action Definition (with verb suggestions)\n\n**Suggest action verbs based on domain:**\n\n```\nWhat action does the user want to perform?\n\n  Suggested verbs:\n  ‚Ä¢ create, view, update, delete (CRUD)\n  ‚Ä¢ search, filter, sort (Discovery)\n  ‚Ä¢ submit, approve, reject (Workflow)\n  ‚Ä¢ login, logout, reset password (Auth)\n  ‚Ä¢ export, import, sync (Data)\n\n  Complete the sentence: \"I want to ___________\"\n```\n\n#### Step 4: Business Value (with templates)\n\n**Offer value proposition templates:**\n\n```\nWhat is the business value?\n\n  Templates:\n  1. \"...so that I can complete my task faster\"\n  2. \"...so that I have visibility into [X]\"\n  3. \"...so that I can make informed decisions\"\n  4. \"...so that the system remains secure\"\n  5. \"...so that I can comply with [requirement]\"\n\n  Complete: \"So that ___________\"\n```\n\n#### Step 5: Acceptance Criteria Generator\n\n**Auto-generate acceptance criteria based on action type:**\n\nFor CRUD operations, suggest:\n```markdown\n## Acceptance Criteria\n\n### Create\n- [ ] Given I am on the creation form, when I submit valid data, then the item is created\n- [ ] Given I submit invalid data, when I click submit, then I see validation errors\n- [ ] Given I create an item, when I view the list, then the new item appears\n\n### Read\n- [ ] Given I have permission, when I request the item, then I see all fields\n- [ ] Given item doesn't exist, when I request it, then I see 404 error\n\n### Update\n- [ ] Given I own the item, when I update it, then changes are persisted\n- [ ] Given I lack permission, when I try to update, then I see 403 error\n\n### Delete\n- [ ] Given I have permission, when I delete, then the item is removed\n- [ ] Given item has dependencies, when I delete, then I see a warning\n```\n\nFor Authentication operations:\n```markdown\n## Acceptance Criteria\n\n### Login\n- [ ] Given valid credentials, when I login, then I receive a JWT token\n- [ ] Given invalid credentials, when I login, then I see an error message\n- [ ] Given I'm already logged in, when I visit login, then I'm redirected\n\n### Security\n- [ ] Given 5 failed attempts, when I try again, then the account is locked\n- [ ] Given locked account, when I request reset, then I receive an email\n```\n\n#### Step 6: Story Points Estimation (with similar story reference)\n\n**Find similar stories and their points:**\n\n```bash\n# Find stories with similar keywords\ngrep -l \"order\\|create\\|update\" artifacts/stories/*.md | \\\n  xargs grep \"points:\" | head -5\n```\n\n```\nEstimate story points:\n\n  Similar completed stories:\n  ‚Ä¢ ACF-032 \"Create Product\" - 3 points (2 days actual)\n  ‚Ä¢ ACF-028 \"Update User Profile\" - 2 points (1 day actual)\n  ‚Ä¢ ACF-019 \"Order Management\" - 5 points (4 days actual)\n\n  Suggested: 3 points (based on similar stories)\n\n  Enter points [1-13]: ___\n```\n\n#### Step 7: Related Items\n\n**Auto-detect related stories:**\n\n```bash\n# Find stories with similar terms\ngrep -l \"order\\|customer\" artifacts/stories/*.md | head -5\n```\n\n```\nPotentially related items:\n\n  Stories:\n  ‚Ä¢ ACF-028: Customer Profile (same domain)\n  ‚Ä¢ ACF-031: Order History (related feature)\n\n  ADRs:\n  ‚Ä¢ ADR-003: Database Selection (if persistence involved)\n\n  Link any of these? [y/n]\n```\n\n### Phase 3: Story Generation\n\n#### Create Story File\n\n```markdown\n---\nid: {{STORY_ID}}\ntitle: {{TITLE}}\ntype: {{TYPE}}\nstatus: draft\ncreated: {{DATE}}\nauthor: Claude Code\nsprint: backlog\npoints: {{POINTS}}\nepic: {{EPIC_ID}}\npriority: medium\n---\n\n# {{STORY_ID}} - {{TITLE}}\n\n## User Story\n\nAs a **{{PERSONA}}**,\nI want to **{{ACTION}}**,\nSo that **{{BENEFIT}}**.\n\n## Story Type\n\n{{TYPE_BADGE}} {{TYPE_DESCRIPTION}}\n\n## Acceptance Criteria\n\n{{#each ACCEPTANCE_CRITERIA}}\n- [ ] Given {{given}}, when {{when}}, then {{then}}\n{{/each}}\n\n## Technical Notes\n\n### Domain Impact\n- **Entities**: {{AFFECTED_ENTITIES}}\n- **Commands/Queries**: {{CQRS_IMPACT}}\n- **API Endpoints**: {{API_ENDPOINTS}}\n\n### Dependencies\n{{#each DEPENDENCIES}}\n- {{dependency}}\n{{/each}}\n\n### Out of Scope\n- {{OUT_OF_SCOPE_ITEMS}}\n\n## Definition of Ready\n\n- [x] Story follows INVEST criteria\n- [x] Acceptance criteria are testable\n- [ ] Dependencies identified and unblocked\n- [ ] No blocking questions\n- [ ] Estimated ({{POINTS}} points)\n\n## Definition of Done\n\n- [ ] All acceptance criteria met\n- [ ] Unit tests with >80% coverage for Domain/Application\n- [ ] Integration tests for API endpoints\n- [ ] Code reviewed and approved\n- [ ] Documentation updated\n- [ ] Security review completed (if applicable)\n- [ ] Traceability verified:\n  - [ ] Tests tagged with `[Trait(\"Story\", \"{{STORY_ID}}\")]`\n  - [ ] Commits prefixed with `{{STORY_ID}}`\n\n## Test Plan\n\n| ID | Type | Description | Expected Result |\n|----|------|-------------|-----------------|\n{{#each TEST_CASES}}\n| TC-{{@index}} | {{type}} | {{description}} | {{expected}} |\n{{/each}}\n\n## Mockups / Wireframes\n\n{{#if HAS_UI}}\n*Attach or describe UI mockups here*\n{{else}}\n*N/A - API only*\n{{/if}}\n\n## Related Items\n\n### Stories\n{{#each RELATED_STORIES}}\n- [{{id}}]({{path}}): {{title}}\n{{/each}}\n\n### ADRs\n{{#each RELATED_ADRS}}\n- [{{id}}]({{path}}): {{title}}\n{{/each}}\n\n### External References\n- {{EXTERNAL_REFS}}\n\n## Notes\n\n*Additional context or implementation notes*\n\n---\n*Created by Story Wizard - {{DATE}}*\n```\n\n### Phase 4: Post-Creation Actions\n\n#### 1. Validate Story Quality\n\n```\nINVEST Validation:\n\n‚úÖ Independent: No blocking dependencies\n‚úÖ Negotiable: AC can be refined\n‚úÖ Valuable: Clear user benefit stated\n‚úÖ Estimable: {{POINTS}} points assigned\n‚úÖ Small: Fits in single sprint\n‚úÖ Testable: {{AC_COUNT}} testable criteria\n\nStory Quality Score: 6/6 ‚úÖ\n```\n\n#### 2. Generate Test Stubs (optional)\n\n```\nWould you like me to generate test stubs for this story?\n\n  Files to create:\n  ‚Ä¢ tests/UnitTests/{{Feature}}Tests.cs\n  ‚Ä¢ tests/IntegrationTests/{{Feature}}IntegrationTests.cs\n\n  [y/n]\n```\n\n#### 3. Output Summary\n\n```markdown\n## Story Created Successfully\n\n**Story ID**: {{STORY_ID}}\n**File**: artifacts/stories/{{STORY_ID}}.md\n**Type**: {{TYPE}}\n**Points**: {{POINTS}}\n**Status**: Draft\n\n### Quick Reference\n\nUse in tests:\n```csharp\n[Trait(\"Story\", \"{{STORY_ID}}\")]\n```\n\nUse in commits:\n```\n{{STORY_ID}} <description>\n```\n\n### Next Steps\n\n1. Review and refine acceptance criteria\n2. Add to sprint: `/sprint plan`\n3. Start implementation: `/implement {{STORY_ID}}`\n```\n\n## Example Session\n\n```\nUser: /new-story\n\nClaude: üßô Story Wizard - Let's create a new user story!\n\nNext available ID: ACF-043\n\nStep 1/6: What type of story is this?\n  1. üÜï Feature - New functionality\n  2. üêõ Bug - Fix a defect\n  3. üîß Tech Debt - Code improvement\n  4. üî¨ Spike - Research/investigation\n\nUser: 1\n\nClaude: Step 2/6: Who is the user persona?\n\n  Suggested personas (from your stories):\n  1. registered user (12 stories)\n  2. admin (8 stories)\n  3. guest (5 stories)\n\n  Or type a custom persona.\n\nUser: registered user\n\nClaude: Step 3/6: What action do they want to perform?\n\n  Suggested verbs: create, view, update, delete, search, filter\n\n  \"I want to _____\"\n\nUser: view my order history\n\nClaude: Step 4/6: What is the business value?\n\n  Templates:\n  1. \"...so that I can track my purchases\"\n  2. \"...so that I have visibility into my orders\"\n  3. Custom\n\nUser: 2\n\nClaude: Step 5/6: Acceptance Criteria\n\n  Auto-generated for \"view\" operation:\n\n  - [ ] Given I am logged in, when I visit /orders, then I see my order list\n  - [ ] Given I have no orders, when I visit /orders, then I see \"No orders yet\"\n  - [ ] Given I click an order, when details load, then I see all line items\n\n  Add more? [y/n]\n\nUser: n\n\nClaude: Step 6/6: Story Points\n\n  Similar stories:\n  ‚Ä¢ ACF-028 \"View Profile\" - 2 points\n  ‚Ä¢ ACF-035 \"View Products\" - 3 points\n\n  Suggested: 2 points\n\n  Enter points [1-13] or press Enter for suggested:\n\nUser: [Enter]\n\nClaude: ‚úÖ Story Created!\n\n  ID:     ACF-043\n  Title:  View Order History\n  Type:   Feature\n  Points: 2\n  File:   artifacts/stories/ACF-043.md\n\n  INVEST Score: 6/6 ‚úÖ\n\n  Use in code:\n    [Trait(\"Story\", \"ACF-043\")]\n\n  Use in commits:\n    ACF-043 Implement order history view\n\n  Would you like to:\n  1. Generate test stubs\n  2. Start implementation (/implement ACF-043)\n  3. Done\n```\n\n```\nUser: /new-story Add payment method --quick --type feature --points 5\n\nClaude: Creating story with quick mode...\n\n‚úÖ Created: ACF-044 - Add Payment Method\n\n  Type:   Feature\n  Points: 5\n  File:   artifacts/stories/ACF-044.md\n\n  Default acceptance criteria generated.\n  Review and customize: artifacts/stories/ACF-044.md\n```\n"
    },
    "mobile-e2e": {
      "prompt": "# /mobile-e2e - Generate E2E Tests\n\nGenerate end-to-end tests for React Native using Maestro or Detox.\n\n## Usage\n```\n/mobile-e2e <flow-name> [options]\n```\n\nExamples:\n- `/mobile-e2e login`\n- `/mobile-e2e checkout --detox`\n- `/mobile-e2e onboarding --maestro`\n- `/mobile-e2e user-registration --story ACF-042`\n\nOptions:\n- `--maestro` (default) - Generate Maestro YAML flow\n- `--detox` - Generate Detox TypeScript test\n- `--story <ACF-###>` - Link to story ID\n- `--critical` - Mark as critical flow (runs on every PR)\n\n## Instructions\n\nWhen invoked:\n\n### 1. Identify Flow Steps\n\nAnalyze the feature and identify:\n- Entry point (which screen)\n- User actions (taps, inputs, gestures)\n- Assertions (what should be visible)\n- Exit conditions (success state)\n\n### 2. Generate Maestro Flow\n\n```yaml\n# e2e/flows/<flow-name>.yaml\nappId: ${APP_ID}\n---\n# Flow: <Flow Name>\n# Story: <ACF-###>\n# Critical: true/false\n\n- launchApp:\n    clearState: true\n\n# Step 1: Navigate to entry point\n- assertVisible: \"Welcome\"\n\n# Step 2: Perform user actions\n- tapOn: \"Log In\"\n\n- tapOn:\n    id: \"email-input\"\n- inputText: \"test@example.com\"\n\n- tapOn:\n    id: \"password-input\"\n- inputText: \"password123\"\n\n# Step 3: Submit action\n- tapOn:\n    id: \"login-button\"\n\n# Step 4: Assert success state\n- assertVisible:\n    text: \"Home\"\n    timeout: 10000\n\n- assertVisible: \"Welcome back\"\n```\n\n### 3. Generate Detox Test (if --detox)\n\n```typescript\n// e2e/<flow-name>.test.ts\ndescribe('<Flow Name>', () => {\n  beforeAll(async () => {\n    await device.launchApp();\n  });\n\n  beforeEach(async () => {\n    await device.reloadReactNative();\n  });\n\n  it('completes <flow-name> successfully', async () => {\n    // Step 1: Entry point\n    await expect(element(by.text('Welcome'))).toBeVisible();\n\n    // Step 2: User actions\n    await element(by.id('email-input')).typeText('test@example.com');\n    await element(by.id('password-input')).typeText('password123');\n\n    // Step 3: Submit\n    await element(by.id('login-button')).tap();\n\n    // Step 4: Assert success\n    await waitFor(element(by.text('Home')))\n      .toBeVisible()\n      .withTimeout(10000);\n\n    await expect(element(by.text('Welcome back'))).toBeVisible();\n  });\n\n  it('shows error with invalid credentials', async () => {\n    await element(by.id('email-input')).typeText('wrong@example.com');\n    await element(by.id('password-input')).typeText('wrongpass');\n    await element(by.id('login-button')).tap();\n\n    await expect(element(by.text('Invalid credentials'))).toBeVisible();\n  });\n});\n```\n\n## Common Flow Templates\n\n### Login Flow\n\n```yaml\n# e2e/flows/login.yaml\nappId: ${APP_ID}\n---\n- launchApp:\n    clearState: true\n\n- assertVisible: \"Welcome\"\n- tapOn: \"Log In\"\n\n- tapOn:\n    id: \"email-input\"\n- inputText: \"user@test.com\"\n\n- tapOn:\n    id: \"password-input\"\n- inputText: \"TestPassword123\"\n\n- tapOn:\n    id: \"login-button\"\n\n- assertVisible:\n    text: \"Home\"\n    timeout: 10000\n```\n\n### Registration Flow\n\n```yaml\n# e2e/flows/registration.yaml\nappId: ${APP_ID}\n---\n- launchApp:\n    clearState: true\n\n- tapOn: \"Sign Up\"\n\n- tapOn:\n    id: \"name-input\"\n- inputText: \"Test User\"\n\n- tapOn:\n    id: \"email-input\"\n- inputText: \"newuser@test.com\"\n\n- tapOn:\n    id: \"password-input\"\n- inputText: \"SecurePass123!\"\n\n- tapOn:\n    id: \"confirm-password-input\"\n- inputText: \"SecurePass123!\"\n\n- tapOn:\n    id: \"register-button\"\n\n- assertVisible:\n    text: \"Welcome, Test User\"\n    timeout: 15000\n```\n\n### Search Flow\n\n```yaml\n# e2e/flows/search.yaml\nappId: ${APP_ID}\n---\n- launchApp\n\n- tapOn:\n    id: \"search-tab\"\n\n- tapOn:\n    id: \"search-input\"\n- inputText: \"running shoes\"\n\n- tapOn: \"Search\"\n\n- assertVisible:\n    text: \"results\"\n    timeout: 5000\n\n- tapOn:\n    index: 0\n\n- assertVisible:\n    id: \"product-detail\"\n```\n\n### Checkout Flow\n\n```yaml\n# e2e/flows/checkout.yaml\nappId: ${APP_ID}\n---\n- launchApp\n\n# Login first\n- runFlow: login.yaml\n\n# Add item to cart\n- tapOn:\n    id: \"search-tab\"\n- tapOn:\n    id: \"search-input\"\n- inputText: \"test product\"\n- tapOn: \"Search\"\n- tapOn:\n    index: 0\n- tapOn:\n    id: \"add-to-cart\"\n\n# Go to cart\n- tapOn:\n    id: \"cart-tab\"\n- assertVisible: \"Your Cart\"\n\n# Checkout\n- tapOn:\n    id: \"checkout-button\"\n\n# Payment\n- tapOn:\n    id: \"card-number\"\n- inputText: \"4242424242424242\"\n\n- tapOn:\n    id: \"expiry\"\n- inputText: \"12/25\"\n\n- tapOn:\n    id: \"cvv\"\n- inputText: \"123\"\n\n- tapOn:\n    id: \"pay-button\"\n\n- assertVisible:\n    text: \"Order Confirmed\"\n    timeout: 20000\n```\n\n## Running Tests\n\n### Maestro\n\n```bash\n# Run single flow\nmaestro test e2e/flows/login.yaml\n\n# Run all flows\nmaestro test e2e/flows/\n\n# Run with recording\nmaestro test e2e/flows/login.yaml --record\n\n# Run in CI\nmaestro cloud --app-file ./app.apk e2e/flows/\n```\n\n### Detox\n\n```bash\n# Build for testing\ndetox build --configuration ios.sim.debug\n\n# Run tests\ndetox test --configuration ios.sim.debug\n\n# Run specific test\ndetox test --configuration ios.sim.debug e2e/login.test.ts\n```\n\n## CI Configuration\n\n### GitHub Actions with Maestro\n\n```yaml\n# .github/workflows/e2e.yml\nname: E2E Tests\n\non:\n  pull_request:\n    branches: [main]\n\njobs:\n  e2e:\n    runs-on: macos-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - uses: actions/setup-node@v4\n        with:\n          node-version: '20'\n\n      - run: npm ci\n\n      - name: Build app\n        run: eas build --platform ios --profile preview --local\n\n      - name: Install Maestro\n        run: |\n          curl -Ls \"https://get.maestro.mobile.dev\" | bash\n          export PATH=\"$PATH:$HOME/.maestro/bin\"\n\n      - name: Run E2E tests\n        run: maestro test e2e/flows/\n```\n\n## Output\n\n```markdown\n## E2E Test Created: <flow-name>\n\n### File Created\n- `e2e/flows/<flow-name>.yaml` (Maestro)\n- OR `e2e/<flow-name>.test.ts` (Detox)\n\n### Flow Steps\n1. Launch app with clean state\n2. Navigate to <entry-point>\n3. <Action 1>\n4. <Action 2>\n5. Assert <success-state>\n\n### Test IDs Required\nEnsure these testIDs exist in your components:\n- `email-input`\n- `password-input`\n- `login-button`\n\n### Run Commands\n```bash\n# Maestro\nmaestro test e2e/flows/<flow-name>.yaml\n\n# Detox\ndetox test e2e/<flow-name>.test.ts\n```\n\n### CI Integration\nAdd to `.github/workflows/e2e.yml` for automated testing.\n```\n"
    },
    "mobile-deploy": {
      "prompt": "# /mobile-deploy - Deploy Mobile App\n\nBuild and deploy React Native/Expo app using EAS Build.\n\n## Usage\n```\n/mobile-deploy [profile] [options]\n```\n\nExamples:\n- `/mobile-deploy` - Build for preview (default)\n- `/mobile-deploy production`\n- `/mobile-deploy preview --platform ios`\n- `/mobile-deploy production --submit`\n\nProfiles:\n- `development` - Development client build\n- `preview` - Internal testing (TestFlight/Internal)\n- `production` - App Store/Play Store release\n\nOptions:\n- `--platform <ios|android|all>` - Target platform (default: all)\n- `--submit` - Auto-submit to stores after build\n- `--local` - Build locally instead of EAS cloud\n- `--message <msg>` - Build message/changelog\n\n## Instructions\n\nWhen invoked:\n\n### 1. Validate Configuration\n\nCheck for required files:\n- `app.json` or `app.config.ts`\n- `eas.json`\n- Environment secrets configured\n\n### 2. Run Pre-Deploy Checks\n\n```bash\n# Type check\nnpm run type-check\n\n# Lint\nnpm run lint\n\n# Run tests\nnpm test\n\n# Check for security issues\nnpm audit\n```\n\n### 3. Build Configuration\n\n**eas.json** structure:\n```json\n{\n  \"cli\": {\n    \"version\": \">= 5.0.0\"\n  },\n  \"build\": {\n    \"development\": {\n      \"developmentClient\": true,\n      \"distribution\": \"internal\",\n      \"ios\": {\n        \"simulator\": true\n      },\n      \"env\": {\n        \"APP_ENV\": \"development\"\n      }\n    },\n    \"preview\": {\n      \"distribution\": \"internal\",\n      \"channel\": \"preview\",\n      \"ios\": {\n        \"resourceClass\": \"m-medium\"\n      },\n      \"env\": {\n        \"APP_ENV\": \"preview\"\n      }\n    },\n    \"production\": {\n      \"channel\": \"production\",\n      \"ios\": {\n        \"resourceClass\": \"m-medium\"\n      },\n      \"android\": {\n        \"buildType\": \"app-bundle\"\n      },\n      \"env\": {\n        \"APP_ENV\": \"production\"\n      }\n    }\n  },\n  \"submit\": {\n    \"production\": {\n      \"ios\": {\n        \"appleId\": \"your@email.com\",\n        \"ascAppId\": \"1234567890\",\n        \"appleTeamId\": \"XXXXXXXXXX\"\n      },\n      \"android\": {\n        \"serviceAccountKeyPath\": \"./google-service-account.json\",\n        \"track\": \"production\"\n      }\n    }\n  }\n}\n```\n\n### 4. Execute Build\n\n**Development Build**:\n```bash\n# iOS Simulator\neas build --profile development --platform ios\n\n# Android Emulator\neas build --profile development --platform android\n```\n\n**Preview Build**:\n```bash\n# Both platforms\neas build --profile preview --platform all\n\n# iOS only (for TestFlight)\neas build --profile preview --platform ios\n```\n\n**Production Build**:\n```bash\n# Both platforms\neas build --profile production --platform all\n\n# With auto-submit\neas build --profile production --platform all --auto-submit\n```\n\n### 5. Submit to Stores (Optional)\n\n**iOS (App Store Connect)**:\n```bash\neas submit --platform ios --profile production\n```\n\n**Android (Play Store)**:\n```bash\neas submit --platform android --profile production\n```\n\n### 6. OTA Updates (Production Hot Fixes)\n\n```bash\n# Update preview channel\neas update --branch preview --message \"Bug fix for login\"\n\n# Update production channel\neas update --branch production --message \"v1.0.1 hotfix\"\n```\n\n## Environment Configuration\n\n### Required Secrets\n\nSet via `eas secret:create`:\n```bash\n# Sentry\neas secret:create --name SENTRY_DSN --value \"https://xxx@sentry.io/xxx\"\neas secret:create --name SENTRY_AUTH_TOKEN --value \"sntrys_xxx\"\n\n# API URLs\neas secret:create --name API_URL --value \"https://api.production.com\"\n\n# Other secrets\neas secret:create --name SOME_API_KEY --value \"key_xxx\"\n```\n\n### app.config.ts Dynamic Config\n\n```typescript\n// app.config.ts\nexport default ({ config }) => ({\n  ...config,\n  name: process.env.APP_ENV === 'production' ? 'MyApp' : 'MyApp (Dev)',\n  ios: {\n    ...config.ios,\n    bundleIdentifier:\n      process.env.APP_ENV === 'production'\n        ? 'com.mycompany.myapp'\n        : 'com.mycompany.myapp.dev',\n  },\n  android: {\n    ...config.android,\n    package:\n      process.env.APP_ENV === 'production'\n        ? 'com.mycompany.myapp'\n        : 'com.mycompany.myapp.dev',\n  },\n  extra: {\n    sentryDsn: process.env.SENTRY_DSN,\n    apiUrl: process.env.API_URL,\n    eas: {\n      projectId: 'your-project-id',\n    },\n  },\n});\n```\n\n## CI/CD Integration\n\n### GitHub Actions Workflow\n\n```yaml\n# .github/workflows/eas-build.yml\nname: EAS Build\n\non:\n  push:\n    branches: [main]\n  pull_request:\n    branches: [main]\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - uses: actions/setup-node@v4\n        with:\n          node-version: '20'\n          cache: 'npm'\n\n      - name: Install dependencies\n        run: npm ci\n\n      - name: Lint\n        run: npm run lint\n\n      - name: Type check\n        run: npm run type-check\n\n      - name: Test\n        run: npm test\n\n      - uses: expo/expo-github-action@v8\n        with:\n          eas-version: latest\n          token: ${{ secrets.EXPO_TOKEN }}\n\n      - name: Build Preview\n        if: github.event_name == 'pull_request'\n        run: eas build --profile preview --platform all --non-interactive\n\n      - name: Build Production\n        if: github.ref == 'refs/heads/main'\n        run: eas build --profile production --platform all --non-interactive --auto-submit\n```\n\n## Version Management\n\n### Automatic Version Bumping\n\n```bash\n# Patch version (1.0.0 -> 1.0.1)\nnpm version patch\n\n# Minor version (1.0.0 -> 1.1.0)\nnpm version minor\n\n# Major version (1.0.0 -> 2.0.0)\nnpm version major\n```\n\n### Build Number Management\n\n```typescript\n// app.config.ts\nconst buildNumber = process.env.EAS_BUILD_NUMBER || '1';\n\nexport default {\n  ios: {\n    buildNumber,\n  },\n  android: {\n    versionCode: parseInt(buildNumber, 10),\n  },\n};\n```\n\n## Output\n\n```markdown\n## Deployment: <profile>\n\n### Build Status\n- Profile: <profile>\n- Platform: <platform>\n- Build ID: <eas-build-id>\n\n### Pre-Deploy Checks\n- [x] Type check passed\n- [x] Lint passed\n- [x] Tests passed (42/42)\n- [x] No security vulnerabilities\n\n### Build Links\n- iOS: https://expo.dev/builds/xxx\n- Android: https://expo.dev/builds/yyy\n\n### Next Steps\n\n**For Preview builds:**\n1. iOS: Install via TestFlight invite\n2. Android: Download APK from build link\n\n**For Production builds:**\n1. iOS: Review in App Store Connect\n2. Android: Review in Google Play Console\n\n### OTA Update (if needed)\n```bash\neas update --branch <channel> --message \"Description\"\n```\n```\n\n## Rollback Procedures\n\n### Revert to Previous Build\n\n```bash\n# List recent builds\neas build:list\n\n# Resubmit previous build\neas submit --platform ios --id <previous-build-id>\n```\n\n### Revert OTA Update\n\n```bash\n# List updates\neas update:list\n\n# Rollback to previous update\neas update:rollback --branch production\n```\n\n## Troubleshooting\n\n### Common Issues\n\n**Build fails with missing credentials:**\n```bash\neas credentials\n# Follow prompts to configure\n```\n\n**Submit fails with signing issues:**\n```bash\n# iOS\neas credentials --platform ios\n# Select \"Build Credentials\" > \"Set up for new build\"\n\n# Android\neas credentials --platform android\n# Upload new keystore if needed\n```\n\n**OTA update not applying:**\n1. Check channel matches build profile\n2. Verify app is connected to EAS Update\n3. Check for native code changes (requires new build)\n"
    },
    "learn": {
      "prompt": "# /learn - Extract Reusable Patterns\n\nAnalyze the current session and extract any patterns worth saving as skills.\n\n## Trigger\n\nRun `/learn` at any point during a session when you've solved a non-trivial problem.\n\n## What to Extract\n\nLook for:\n\n1. **Error Resolution Patterns**\n   - What error occurred?\n   - What was the root cause?\n   - What fixed it?\n   - Is this reusable for similar errors?\n\n2. **Debugging Techniques**\n   - Non-obvious debugging steps\n   - Tool combinations that worked\n   - Diagnostic patterns\n\n3. **Workarounds**\n   - Library quirks\n   - API limitations\n   - Version-specific fixes\n\n4. **Project-Specific Patterns**\n   - Codebase conventions discovered\n   - Architecture decisions made\n   - Integration patterns\n\n## Output Format\n\nCreate a skill file at `~/.claude/skills/learned/[pattern-name].md`:\n\n```markdown\n# [Descriptive Pattern Name]\n\n**Extracted:** [Date]\n**Context:** [Brief description of when this applies]\n\n## Problem\n[What problem this solves - be specific]\n\n## Solution\n[The pattern/technique/workaround]\n\n## Example\n[Code example if applicable]\n\n## When to Use\n[Trigger conditions - what should activate this skill]\n```\n\n## Process\n\n1. Review the session for extractable patterns\n2. Identify the most valuable/reusable insight\n3. Draft the skill file\n4. Ask user to confirm before saving\n5. Save to `~/.claude/skills/learned/`\n\n## Notes\n\n- Don't extract trivial fixes (typos, simple syntax errors)\n- Don't extract one-time issues (specific API outages, etc.)\n- Focus on patterns that will save time in future sessions\n- Keep skills focused - one pattern per skill\n"
    },
    "implement": {
      "prompt": "# /implement - Implement a User Story\n\nFull implementation workflow for a user story including code, tests, and documentation.\n\n## Usage\n```\n/implement <story-id>\n```\n\nExample: `/implement ACF-042`\n\n## Instructions\n\nWhen invoked, follow this structured implementation workflow:\n\n### Phase 1: Story Analysis\n\n1. **Read the story file**:\n   ```bash\n   cat artifacts/stories/<story-id>.md\n   ```\n\n2. **Verify Definition of Ready**:\n   - Story follows INVEST criteria\n   - Acceptance criteria are testable\n   - Dependencies identified\n   - No blocking questions\n\n3. **If not ready**: Stop and report what's missing\n\n### Phase 2: Technical Design\n\n1. **Identify affected layers**:\n   - Domain: New entities, value objects, domain events?\n   - Application: Commands, queries, handlers, validators?\n   - Infrastructure: Repositories, external services?\n   - API: Endpoints, DTOs, middleware?\n\n2. **Create/update ADR if needed**:\n   - New dependencies ‚Üí ADR required\n   - Architecture changes ‚Üí ADR required\n   - Breaking changes ‚Üí ADR required\n\n3. **List files to create/modify**:\n   - Provide a clear list before writing code\n\n### Phase 3: Implementation\n\n1. **Domain Layer** (if applicable):\n   ```csharp\n   // Entities\n   src/<Project>.Domain/Entities/<Entity>.cs\n\n   // Value Objects\n   src/<Project>.Domain/ValueObjects/<ValueObject>.cs\n\n   // Domain Events\n   src/<Project>.Domain/Events/<Event>.cs\n\n   // Repository Interfaces\n   src/<Project>.Domain/Repositories/I<Entity>Repository.cs\n   ```\n\n2. **Application Layer**:\n   ```csharp\n   // Commands\n   src/<Project>.Application/Commands/<Feature>/\n   ‚îú‚îÄ‚îÄ <Command>Command.cs\n   ‚îú‚îÄ‚îÄ <Command>Handler.cs\n   ‚îî‚îÄ‚îÄ <Command>Validator.cs\n\n   // Queries\n   src/<Project>.Application/Queries/<Feature>/\n   ‚îú‚îÄ‚îÄ <Query>Query.cs\n   ‚îî‚îÄ‚îÄ <Query>Handler.cs\n\n   // DTOs\n   src/<Project>.Application/DTOs/<Entity>Dto.cs\n   ```\n\n3. **Infrastructure Layer**:\n   ```csharp\n   // Repository Implementation\n   src/<Project>.Infrastructure/Repositories/<Entity>Repository.cs\n\n   // EF Configuration\n   src/<Project>.Infrastructure/Persistence/Configurations/<Entity>Configuration.cs\n   ```\n\n4. **API Layer**:\n   ```csharp\n   // Controller\n   src/<Project>.Api/Controllers/<Entity>Controller.cs\n   ```\n\n### Phase 4: Testing\n\n1. **Unit Tests** (for Domain/Application):\n   ```csharp\n   [Fact]\n   [Trait(\"Story\", \"<story-id>\")]\n   public async Task <MethodName>_<Scenario>_<ExpectedResult>()\n   {\n       // Arrange\n       // Act\n       // Assert\n   }\n   ```\n\n2. **Integration Tests** (for API endpoints):\n   ```csharp\n   [Fact]\n   [Trait(\"Story\", \"<story-id>\")]\n   public async Task <Endpoint>_<Scenario>_Returns<Status>()\n   ```\n\n3. **Run tests and check coverage**:\n   ```bash\n   dotnet test --collect:\"XPlat Code Coverage\"\n   python3 scripts/coverage/check-coverage.py coverage.xml\n   ```\n\n### Phase 5: Documentation\n\n1. **Update API documentation**:\n   - OpenAPI comments on endpoints\n   - Example requests/responses\n\n2. **Update module documentation** if structure changed\n\n3. **Update architecture documentation** if significant changes\n\n### Phase 6: Validation\n\n1. **Run all validations**:\n   ```bash\n   ./scripts/validate-project.sh\n   ./scripts/validate-documentation.sh\n   python3 scripts/traceability/traceability.py validate\n   ```\n\n2. **Verify Definition of Done**:\n   - [ ] All acceptance criteria met\n   - [ ] Unit tests with >80% coverage\n   - [ ] Integration tests for endpoints\n   - [ ] Code reviewed\n   - [ ] Documentation updated\n   - [ ] Security review (if applicable)\n   - [ ] Traceability verified\n\n### Phase 7: Commit\n\n```bash\ngit add .\ngit commit -m \"<story-id> Implement <brief description>\n\n- Added <feature 1>\n- Updated <component>\n- Tests: X unit, Y integration\n\nCo-Authored-By: Claude <noreply@anthropic.com>\"\n```\n\n## Output Format\n\n```markdown\n## Implementation Summary: <story-id>\n\n### Story: <title>\n\n### Changes Made\n\n| Layer | Files | Description |\n|-------|-------|-------------|\n| Domain | 2 | Added Order entity, OrderStatus value object |\n| Application | 4 | CreateOrderCommand, handler, validator, DTO |\n| Infrastructure | 2 | OrderRepository, EF configuration |\n| API | 1 | OrdersController with POST /orders |\n| Tests | 6 | 5 unit tests, 1 integration test |\n\n### Test Results\n- Unit tests: 12 passed\n- Integration tests: 3 passed\n- Coverage: 87%\n\n### Traceability\n- Story: <story-id>\n- Tests: 6 linked with [Trait(\"Story\", \"<story-id>\")]\n- Commits: 1 with story ID\n\n### Definition of Done\n- [x] Acceptance criteria met\n- [x] Tests with 87% coverage\n- [x] Documentation updated\n- [x] Traceability verified\n\n### Ready for Review: Yes\n```\n\n## Example\n\n```\nUser: /implement ACF-042\n\nClaude: Implementing story ACF-042...\n\n## Story Analysis\nReading artifacts/stories/ACF-042.md...\n\n**ACF-042: User Login**\nAs a registered user, I want to log in with email and password...\n\n### Definition of Ready: PASSED\n- [x] INVEST criteria met\n- [x] Acceptance criteria testable\n- [x] Dependencies: AuthService exists\n- [x] No blocking questions\n\n## Technical Design\n\n**Affected Layers:**\n- Application: LoginCommand, LoginHandler, LoginValidator\n- Infrastructure: Update UserRepository with login method\n- API: Add POST /auth/login endpoint\n\n**Files to create/modify:**\n1. src/Application/Commands/Auth/LoginCommand.cs (new)\n2. src/Application/Commands/Auth/LoginHandler.cs (new)\n3. src/Application/Commands/Auth/LoginValidator.cs (new)\n4. src/Api/Controllers/AuthController.cs (modify)\n5. tests/UnitTests/Auth/LoginHandlerTests.cs (new)\n6. tests/IntegrationTests/Auth/LoginEndpointTests.cs (new)\n\nProceeding with implementation...\n```\n"
    },
    "health": {
      "prompt": "# /health - Project Health Dashboard\n\nDisplay comprehensive project health status including tests, coverage, security, dependencies, and documentation.\n\n## Usage\n```\n/health [options]\n```\n\nOptions:\n- `--full` - Run all checks (slower but complete)\n- `--quick` - Run fast checks only (default)\n- `--json` - Output in JSON format\n- `--ci` - Exit with non-zero if unhealthy (for CI/CD)\n\n## Instructions\n\nWhen invoked:\n\n### 1. Gather Project Information\n\n```bash\n# Find solution\nSOLUTION=$(find . -name \"*.sln\" -type f | head -1)\n\n# Count projects\nPROJECT_COUNT=$(dotnet sln \"$SOLUTION\" list 2>/dev/null | tail -n +3 | wc -l)\n\n# Get .NET version\nDOTNET_VERSION=$(dotnet --version)\n\n# Get last commit\nLAST_COMMIT=$(git log -1 --format=\"%h %s\" 2>/dev/null)\n```\n\n### 2. Run Health Checks\n\n#### Tests Check\n```bash\n# Run tests and capture results\ndotnet test --no-build --verbosity quiet --logger \"console;verbosity=minimal\" 2>&1\n\n# Parse results\nTESTS_PASSED=$(grep -oE \"[0-9]+ Passed\" | head -1)\nTESTS_FAILED=$(grep -oE \"[0-9]+ Failed\" | head -1)\n```\n\n#### Coverage Check\n```bash\n# Check if coverage report exists\nif [ -f \"TestResults/coverage.cobertura.xml\" ]; then\n  COVERAGE=$(grep -oP 'line-rate=\"\\K[^\"]+' TestResults/coverage.cobertura.xml | head -1)\n  COVERAGE_PERCENT=$(echo \"$COVERAGE * 100\" | bc)\nfi\n```\n\n#### Security Check\n```bash\n# Check for vulnerable packages\ndotnet list package --vulnerable --include-transitive 2>&1 | tee /tmp/vuln-check.txt\n\n# Count vulnerabilities\nVULN_COUNT=$(grep -c \"has the following vulnerable packages\" /tmp/vuln-check.txt || echo 0)\n```\n\n#### Dependencies Check\n```bash\n# Check for outdated packages\ndotnet list package --outdated 2>&1 | tee /tmp/outdated-check.txt\n\n# Count outdated\nOUTDATED_COUNT=$(grep -c \">\" /tmp/outdated-check.txt || echo 0)\n```\n\n#### Documentation Check\n```bash\n# Check required docs exist\nDOCS_STATUS=\"‚úÖ\"\nfor doc in README.md CLAUDE.md CORPORATE_RND_POLICY.md; do\n  if [ ! -f \"$doc\" ]; then\n    DOCS_STATUS=\"‚ùå\"\n    MISSING_DOCS=\"$MISSING_DOCS $doc\"\n  fi\ndone\n```\n\n#### Build Check\n```bash\n# Check if build succeeds\nif dotnet build --no-restore --verbosity quiet 2>&1; then\n  BUILD_STATUS=\"‚úÖ\"\nelse\n  BUILD_STATUS=\"‚ùå\"\nfi\n```\n\n#### Traceability Check\n```bash\n# Check story-test linkage\nSTORIES=$(find artifacts/stories -name \"ACF-*.md\" 2>/dev/null | wc -l)\nTESTS_WITH_STORY=$(grep -r '\\[Trait(\"Story\"' tests/ --include=\"*.cs\" 2>/dev/null | wc -l)\n```\n\n### 3. Generate Health Report\n\n```markdown\n================================================================================\n                         PROJECT HEALTH DASHBOARD\n================================================================================\n\nProject:     {{PROJECT_NAME}}\nSolution:    {{SOLUTION_FILE}}\nFramework:   .NET {{DOTNET_VERSION}}\nLast Commit: {{LAST_COMMIT}}\nGenerated:   {{TIMESTAMP}}\n\n================================================================================\n                              HEALTH SUMMARY\n================================================================================\n\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ                                                                             ‚îÇ\n‚îÇ   Overall Health:  ‚úÖ HEALTHY  |  ‚ö†Ô∏è DEGRADED  |  ‚ùå UNHEALTHY              ‚îÇ\n‚îÇ                                                                             ‚îÇ\n‚îÇ   Score: {{SCORE}}/100                                                      ‚îÇ\n‚îÇ                                                                             ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n\n================================================================================\n                              DETAILED CHECKS\n================================================================================\n\nBUILD STATUS\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nStatus:      {{BUILD_STATUS}} {{BUILD_MESSAGE}}\nProjects:    {{PROJECT_COUNT}} projects in solution\nWarnings:    {{WARNING_COUNT}} compiler warnings\nErrors:      {{ERROR_COUNT}} compiler errors\n\nTEST STATUS\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nStatus:      {{TEST_STATUS}}\nTotal:       {{TOTAL_TESTS}} tests\nPassed:      {{PASSED_TESTS}} ‚úÖ\nFailed:      {{FAILED_TESTS}} {{FAILED_ICON}}\nSkipped:     {{SKIPPED_TESTS}}\nDuration:    {{TEST_DURATION}}\n\nCOVERAGE STATUS\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nStatus:      {{COVERAGE_STATUS}}\nOverall:     {{COVERAGE_PERCENT}}% (target: 80%)\n\nBy Layer:\n  Domain:        {{DOMAIN_COVERAGE}}%  {{DOMAIN_ICON}}\n  Application:   {{APP_COVERAGE}}%  {{APP_ICON}}\n  Infrastructure: {{INFRA_COVERAGE}}%  {{INFRA_ICON}}\n  API:           {{API_COVERAGE}}%  {{API_ICON}}\n\nCoverage Bar:\n[‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë] {{COVERAGE_PERCENT}}%\n\nSECURITY STATUS\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nStatus:      {{SECURITY_STATUS}}\nVulnerabilities:\n  Critical:  {{CRITICAL_VULNS}}\n  High:      {{HIGH_VULNS}}\n  Medium:    {{MEDIUM_VULNS}}\n  Low:       {{LOW_VULNS}}\n\n{{#if VULNS_FOUND}}\nVulnerable Packages:\n{{#each VULNERABLE_PACKAGES}}\n  ‚ö†Ô∏è {{package}} ({{severity}}): {{advisory}}\n{{/each}}\n{{/if}}\n\nDEPENDENCY STATUS\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nStatus:      {{DEPENDENCY_STATUS}}\nTotal:       {{TOTAL_PACKAGES}} packages\nOutdated:    {{OUTDATED_COUNT}} packages need updates\nDeprecated:  {{DEPRECATED_COUNT}} packages deprecated\n\n{{#if OUTDATED_PACKAGES}}\nOutdated Packages:\n{{#each OUTDATED_PACKAGES}}\n  üì¶ {{package}}: {{current}} ‚Üí {{latest}}\n{{/each}}\n{{/if}}\n\nDOCUMENTATION STATUS\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nStatus:      {{DOCS_STATUS}}\n\nRequired Files:\n  README.md              {{README_ICON}}\n  CLAUDE.md              {{CLAUDE_ICON}}\n  CORPORATE_RND_POLICY.md {{POLICY_ICON}}\n  ARCHITECTURE.md        {{ARCH_ICON}}\n\nOptional Files:\n  CONTRIBUTING.md        {{CONTRIB_ICON}}\n  CHANGELOG.md           {{CHANGELOG_ICON}}\n  LICENSE                {{LICENSE_ICON}}\n\nTRACEABILITY STATUS\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nStatus:      {{TRACEABILITY_STATUS}}\nStories:     {{STORY_COUNT}} defined\nTests:       {{TESTS_WITH_STORY}} linked to stories\nCoverage:    {{STORY_TEST_COVERAGE}}%\n\nUnlinked Stories:\n{{#each UNLINKED_STORIES}}\n  ‚ö†Ô∏è {{story_id}}: No tests found\n{{/each}}\n\nARCHITECTURE STATUS\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nStatus:      {{ARCHITECTURE_STATUS}}\nClean Architecture: {{CLEAN_ARCH_STATUS}}\n\nLayer Dependencies:\n  Domain ‚Üí (none)           {{DOMAIN_DEP_ICON}}\n  Application ‚Üí Domain      {{APP_DEP_ICON}}\n  Infrastructure ‚Üí App,Dom  {{INFRA_DEP_ICON}}\n  API ‚Üí All                 {{API_DEP_ICON}}\n\n{{#if ARCH_VIOLATIONS}}\nViolations:\n{{#each ARCH_VIOLATIONS}}\n  ‚ùå {{violation}}\n{{/each}}\n{{/if}}\n\n================================================================================\n                              RECOMMENDATIONS\n================================================================================\n\n{{#each RECOMMENDATIONS}}\n{{priority}}. {{recommendation}}\n   Action: {{action}}\n{{/each}}\n\n================================================================================\n                              TREND (Last 5 Builds)\n================================================================================\n\nCoverage:  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë 82% ‚Üí ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë 84% ‚Üí ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë 86% ‚Üí ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë 87%\nTests:     142 ‚Üí 148 ‚Üí 155 ‚Üí 162 ‚Üí 168 (+26)\nVulns:     2 ‚Üí 1 ‚Üí 0 ‚Üí 0 ‚Üí 0 (fixed)\n\n================================================================================\n                                  ACTIONS\n================================================================================\n\nQuick Fixes:\n{{#each QUICK_FIXES}}\n  ‚Ä¢ {{fix}}\n{{/each}}\n\nCommands to Run:\n  /coverage          - Detailed coverage report\n  /security-review   - Full security audit\n  /dependencies      - Dependency analysis\n  /traceability      - Story-test linkage report\n```\n\n### 4. Calculate Health Score\n\n```\nScore Calculation (100 points total):\n\nBuild:          15 points\n  - Compiles:   10 points\n  - No warnings: 5 points\n\nTests:          25 points\n  - All pass:   20 points\n  - >100 tests:  5 points\n\nCoverage:       20 points\n  - ‚â•80%:       20 points\n  - ‚â•70%:       15 points\n  - ‚â•60%:       10 points\n  - <60%:        0 points\n\nSecurity:       20 points\n  - No critical: 10 points\n  - No high:     5 points\n  - No medium:   5 points\n\nDependencies:   10 points\n  - All current: 10 points\n  - <5 outdated:  5 points\n\nTraceability:   10 points\n  - 100% linked: 10 points\n  - ‚â•80% linked:  5 points\n\nTotal: {{SCORE}}/100\n```\n\n### 5. Health Status Thresholds\n\n| Score | Status | Action |\n|-------|--------|--------|\n| 90-100 | ‚úÖ HEALTHY | Maintain current practices |\n| 70-89 | ‚ö†Ô∏è DEGRADED | Address warnings soon |\n| <70 | ‚ùå UNHEALTHY | Immediate attention needed |\n\n### 6. JSON Output (--json)\n\n```json\n{\n  \"project\": \"{{PROJECT_NAME}}\",\n  \"timestamp\": \"{{TIMESTAMP}}\",\n  \"score\": {{SCORE}},\n  \"status\": \"healthy|degraded|unhealthy\",\n  \"checks\": {\n    \"build\": {\n      \"status\": \"pass|fail\",\n      \"projects\": {{PROJECT_COUNT}},\n      \"warnings\": {{WARNING_COUNT}},\n      \"errors\": {{ERROR_COUNT}}\n    },\n    \"tests\": {\n      \"status\": \"pass|fail\",\n      \"total\": {{TOTAL_TESTS}},\n      \"passed\": {{PASSED_TESTS}},\n      \"failed\": {{FAILED_TESTS}},\n      \"skipped\": {{SKIPPED_TESTS}}\n    },\n    \"coverage\": {\n      \"status\": \"pass|warn|fail\",\n      \"overall\": {{COVERAGE_PERCENT}},\n      \"byLayer\": {\n        \"domain\": {{DOMAIN_COVERAGE}},\n        \"application\": {{APP_COVERAGE}},\n        \"infrastructure\": {{INFRA_COVERAGE}},\n        \"api\": {{API_COVERAGE}}\n      }\n    },\n    \"security\": {\n      \"status\": \"pass|warn|fail\",\n      \"vulnerabilities\": {\n        \"critical\": {{CRITICAL_VULNS}},\n        \"high\": {{HIGH_VULNS}},\n        \"medium\": {{MEDIUM_VULNS}},\n        \"low\": {{LOW_VULNS}}\n      }\n    },\n    \"dependencies\": {\n      \"status\": \"pass|warn\",\n      \"total\": {{TOTAL_PACKAGES}},\n      \"outdated\": {{OUTDATED_COUNT}}\n    },\n    \"traceability\": {\n      \"status\": \"pass|warn|fail\",\n      \"stories\": {{STORY_COUNT}},\n      \"linkedTests\": {{TESTS_WITH_STORY}},\n      \"coverage\": {{STORY_TEST_COVERAGE}}\n    }\n  },\n  \"recommendations\": [\n    {\"priority\": 1, \"message\": \"{{RECOMMENDATION}}\"}\n  ]\n}\n```\n\n## Example\n\n```\nUser: /health\n\nClaude: Running project health checks...\n\n================================================================================\n                         PROJECT HEALTH DASHBOARD\n================================================================================\n\nProject:     OrderService\nFramework:   .NET 8.0.1\nLast Commit: abc123f Add order validation\n\n================================================================================\n                              HEALTH SUMMARY\n================================================================================\n\n   Overall Health:  ‚úÖ HEALTHY\n   Score: 92/100\n\n================================================================================\n                              DETAILED CHECKS\n================================================================================\n\nBUILD STATUS\n  Status:      ‚úÖ Build succeeded\n  Projects:    7 projects\n  Warnings:    3 compiler warnings\n\nTEST STATUS\n  Status:      ‚úÖ All tests passing\n  Total:       168 tests\n  Passed:      168 ‚úÖ\n  Failed:      0\n\nCOVERAGE STATUS\n  Status:      ‚úÖ Above threshold\n  Overall:     87% (target: 80%)\n  Domain:      92% ‚úÖ\n  Application: 89% ‚úÖ\n\nSECURITY STATUS\n  Status:      ‚úÖ No vulnerabilities\n  Critical:    0\n  High:        0\n\nDEPENDENCY STATUS\n  Status:      ‚ö†Ô∏è 2 packages outdated\n  üì¶ MediatR: 12.2.0 ‚Üí 12.3.0\n  üì¶ Serilog: 3.1.0 ‚Üí 3.1.1\n\nTRACEABILITY STATUS\n  Status:      ‚úÖ 100% coverage\n  Stories:     12 defined\n  Tests:       45 linked\n\n================================================================================\n                              RECOMMENDATIONS\n================================================================================\n\n1. Update 2 outdated packages\n   Run: dotnet outdated --upgrade\n\n2. Fix 3 compiler warnings\n   Run: dotnet build and review warnings\n\nHealth check complete. Project is healthy.\n```\n\n```\nUser: /health --ci\n\nClaude: Running health checks for CI...\n\nScore: 92/100\nStatus: HEALTHY\n\nExit code: 0 (healthy)\n```\n\n```\nUser: /health --quick\n\nClaude: Quick health check...\n\n‚úÖ Build:      Passing\n‚úÖ Tests:      168 passing\n‚úÖ Coverage:   87%\n‚úÖ Security:   No vulnerabilities\n‚ö†Ô∏è Deps:       2 outdated\n\nScore: 92/100 - HEALTHY\n```\n"
    },
    "generate-docs": {
      "prompt": "# /generate-docs - API Documentation Generator\n\nGenerate comprehensive API documentation including OpenAPI specs, module documentation, and developer guides.\n\n## Usage\n```\n/generate-docs <type> [options]\n```\n\nTypes:\n- `api` - Generate OpenAPI/Swagger documentation\n- `modules` - Generate module/namespace documentation\n- `readme` - Generate or update project README\n- `changelog` - Generate changelog from git history\n- `all` - Generate all documentation types\n\nOptions:\n- `--output <path>` - Output directory (default: `docs/`)\n- `--format <md|html|json>` - Output format (default: md)\n- `--include-private` - Include internal/private members\n- `--story <ACF-###>` - Link to story ID\n\n## Instructions\n\nWhen invoked:\n\n### API Documentation (`/generate-docs api`)\n\n#### 1. Extract OpenAPI Specification\n\n```bash\n# Generate OpenAPI JSON from running application\ndotnet swagger tofile --output docs/api/openapi.json ./src/ProjectName.API/bin/Debug/net8.0/ProjectName.API.dll v1\n\n# Or use Swashbuckle CLI\ndotnet tool install -g Swashbuckle.AspNetCore.Cli\nswagger tofile --output openapi.json ProjectName.API.dll v1\n```\n\n#### 2. Generate API Reference\n\n```markdown\n# API Reference\n\n## Overview\n\n**Base URL**: `https://api.example.com/v1`\n**Version**: 1.0.0\n**Authentication**: Bearer JWT Token\n\n## Authentication\n\nAll API requests require authentication via JWT Bearer token:\n\n```http\nAuthorization: Bearer <your-token>\n```\n\n### Obtaining a Token\n\n```http\nPOST /api/auth/login\nContent-Type: application/json\n\n{\n  \"email\": \"user@example.com\",\n  \"password\": \"your-password\"\n}\n```\n\nResponse:\n```json\n{\n  \"accessToken\": \"eyJhbG...\",\n  \"refreshToken\": \"dGhpcyBpcyBh...\",\n  \"expiresIn\": 900\n}\n```\n\n---\n\n## Endpoints\n\n{{#each controllers}}\n### {{name}}\n\n{{description}}\n\n{{#each endpoints}}\n#### {{method}} {{path}}\n\n{{summary}}\n\n**Authorization**: {{auth}}\n\n**Parameters**:\n| Name | In | Type | Required | Description |\n|------|----|----- |----------|-------------|\n{{#each parameters}}\n| {{name}} | {{in}} | {{type}} | {{required}} | {{description}} |\n{{/each}}\n\n**Request Body**:\n```json\n{{requestBodyExample}}\n```\n\n**Responses**:\n| Code | Description |\n|------|-------------|\n{{#each responses}}\n| {{code}} | {{description}} |\n{{/each}}\n\n**Example**:\n```bash\ncurl -X {{method}} '{{baseUrl}}{{path}}' \\\n  -H 'Authorization: Bearer <token>' \\\n  -H 'Content-Type: application/json' \\\n  -d '{{requestBodyExample}}'\n```\n\n{{/each}}\n{{/each}}\n\n---\n\n## Models\n\n{{#each models}}\n### {{name}}\n\n{{description}}\n\n| Property | Type | Required | Description |\n|----------|------|----------|-------------|\n{{#each properties}}\n| {{name}} | {{type}} | {{required}} | {{description}} |\n{{/each}}\n\n**Example**:\n```json\n{{example}}\n```\n\n{{/each}}\n\n---\n\n## Error Codes\n\n| Code | Name | Description |\n|------|------|-------------|\n| 400 | Bad Request | Invalid request parameters |\n| 401 | Unauthorized | Missing or invalid authentication |\n| 403 | Forbidden | Insufficient permissions |\n| 404 | Not Found | Resource not found |\n| 409 | Conflict | Resource conflict (duplicate) |\n| 422 | Unprocessable Entity | Validation failed |\n| 500 | Internal Server Error | Server error |\n\n### Error Response Format\n\n```json\n{\n  \"type\": \"https://tools.ietf.org/html/rfc7231#section-6.5.1\",\n  \"title\": \"Bad Request\",\n  \"status\": 400,\n  \"traceId\": \"00-abc123-def456-00\",\n  \"errors\": {\n    \"Email\": [\"The Email field is required.\"]\n  }\n}\n```\n\n---\n\n## Rate Limiting\n\nAPI requests are rate limited:\n- **Anonymous**: 100 requests/hour\n- **Authenticated**: 1000 requests/hour\n\nRate limit headers:\n```http\nX-RateLimit-Limit: 1000\nX-RateLimit-Remaining: 999\nX-RateLimit-Reset: 1640995200\n```\n\n---\n\n## Pagination\n\nList endpoints support pagination:\n\n```http\nGET /api/orders?page=1&pageSize=20\n```\n\nResponse includes pagination metadata:\n```json\n{\n  \"items\": [...],\n  \"page\": 1,\n  \"pageSize\": 20,\n  \"totalCount\": 150,\n  \"totalPages\": 8,\n  \"hasNextPage\": true,\n  \"hasPreviousPage\": false\n}\n```\n```\n\n### Module Documentation (`/generate-docs modules`)\n\n#### 1. Scan Project Structure\n\n```bash\n# Find all namespaces\ngrep -rh \"^namespace\" src/ --include=\"*.cs\" | sort -u\n\n# Find all public classes\ngrep -rh \"public class\\|public interface\\|public record\\|public enum\" src/ --include=\"*.cs\"\n```\n\n#### 2. Generate Module Documentation\n\n```markdown\n# Module Documentation\n\n## Solution Structure\n\n```\n{{SolutionName}}/\n‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îú‚îÄ‚îÄ {{ProjectName}}.Domain/\n‚îÇ   ‚îú‚îÄ‚îÄ {{ProjectName}}.Application/\n‚îÇ   ‚îú‚îÄ‚îÄ {{ProjectName}}.Infrastructure/\n‚îÇ   ‚îî‚îÄ‚îÄ {{ProjectName}}.API/\n‚îî‚îÄ‚îÄ tests/\n    ‚îú‚îÄ‚îÄ {{ProjectName}}.UnitTests/\n    ‚îú‚îÄ‚îÄ {{ProjectName}}.IntegrationTests/\n    ‚îî‚îÄ‚îÄ {{ProjectName}}.ArchitectureTests/\n```\n\n---\n\n## Domain Layer\n\n**Project**: `{{ProjectName}}.Domain`\n**Purpose**: Core business logic, entities, and domain events\n\n### Entities\n\n{{#each entities}}\n#### {{name}}\n\n{{description}}\n\n**File**: `Entities/{{name}}.cs`\n\n```csharp\n{{codeSnippet}}\n```\n\n**Properties**:\n| Name | Type | Description |\n|------|------|-------------|\n{{#each properties}}\n| {{name}} | {{type}} | {{description}} |\n{{/each}}\n\n**Methods**:\n{{#each methods}}\n- `{{signature}}`: {{description}}\n{{/each}}\n\n{{/each}}\n\n### Value Objects\n\n{{#each valueObjects}}\n#### {{name}}\n\n{{description}}\n\n**File**: `ValueObjects/{{name}}.cs`\n\n{{/each}}\n\n### Domain Events\n\n{{#each domainEvents}}\n#### {{name}}\n\nRaised when: {{trigger}}\n\n**Properties**: {{properties}}\n\n{{/each}}\n\n### Repository Interfaces\n\n{{#each repositories}}\n#### {{name}}\n\n**File**: `Repositories/{{name}}.cs`\n\n**Methods**:\n{{#each methods}}\n- `{{signature}}`\n{{/each}}\n\n{{/each}}\n\n---\n\n## Application Layer\n\n**Project**: `{{ProjectName}}.Application`\n**Purpose**: Use cases, CQRS handlers, DTOs, validators\n\n### Commands\n\n{{#each commands}}\n#### {{name}}\n\n**Handler**: `{{handler}}`\n**Purpose**: {{purpose}}\n\n**Input**:\n```csharp\n{{inputType}}\n```\n\n**Output**: `{{outputType}}`\n\n{{/each}}\n\n### Queries\n\n{{#each queries}}\n#### {{name}}\n\n**Handler**: `{{handler}}`\n**Purpose**: {{purpose}}\n\n**Input**: `{{inputType}}`\n**Output**: `{{outputType}}`\n\n{{/each}}\n\n### Validators\n\n{{#each validators}}\n#### {{name}}\n\nValidates: `{{targetType}}`\n\n**Rules**:\n{{#each rules}}\n- {{rule}}\n{{/each}}\n\n{{/each}}\n\n---\n\n## Infrastructure Layer\n\n**Project**: `{{ProjectName}}.Infrastructure`\n**Purpose**: Data access, external services, implementations\n\n### DbContext\n\n**File**: `Persistence/ApplicationDbContext.cs`\n\n**Entities Configured**:\n{{#each dbSets}}\n- `DbSet<{{entity}}>` - {{table}}\n{{/each}}\n\n### Repository Implementations\n\n{{#each repositoryImpls}}\n#### {{name}}\n\nImplements: `{{interface}}`\n\n{{/each}}\n\n### External Services\n\n{{#each externalServices}}\n#### {{name}}\n\n**Purpose**: {{purpose}}\n**Configuration**: `{{configSection}}`\n\n{{/each}}\n\n---\n\n## API Layer\n\n**Project**: `{{ProjectName}}.API`\n**Purpose**: HTTP endpoints, middleware, DI configuration\n\n### Controllers\n\n{{#each controllers}}\n#### {{name}}\n\n**Route**: `{{route}}`\n**Authorization**: {{authorization}}\n\n**Endpoints**:\n{{#each endpoints}}\n- `{{method}} {{path}}` - {{description}}\n{{/each}}\n\n{{/each}}\n\n### Middleware\n\n{{#each middleware}}\n#### {{name}}\n\n**Purpose**: {{purpose}}\n**Order**: {{order}}\n\n{{/each}}\n\n---\n\n## Dependency Graph\n\n```mermaid\ngraph TD\n    API[API Layer]\n    APP[Application Layer]\n    INFRA[Infrastructure Layer]\n    DOM[Domain Layer]\n\n    API --> APP\n    API --> INFRA\n    INFRA --> APP\n    INFRA --> DOM\n    APP --> DOM\n```\n```\n\n### README Generation (`/generate-docs readme`)\n\n```markdown\n# {{ProjectName}}\n\n{{description}}\n\n## Features\n\n{{#each features}}\n- {{feature}}\n{{/each}}\n\n## Tech Stack\n\n- .NET {{dotnetVersion}}\n- {{database}}\n- {{otherTech}}\n\n## Getting Started\n\n### Prerequisites\n\n- .NET SDK {{dotnetVersion}}\n- Docker (optional)\n- {{otherPrereqs}}\n\n### Installation\n\n```bash\n# Clone the repository\ngit clone {{repoUrl}}\ncd {{projectName}}\n\n# Restore dependencies\ndotnet restore\n\n# Run database migrations\ndotnet ef database update -p src/{{ProjectName}}.Infrastructure -s src/{{ProjectName}}.API\n\n# Run the application\ndotnet run --project src/{{ProjectName}}.API\n```\n\n### Configuration\n\nCreate `appsettings.Development.json`:\n\n```json\n{\n  \"ConnectionStrings\": {\n    \"DefaultConnection\": \"Host=localhost;Database={{dbName}};Username=postgres;Password=postgres\"\n  },\n  \"Jwt\": {\n    \"Secret\": \"your-256-bit-secret-key-here\",\n    \"Issuer\": \"https://localhost:5001\",\n    \"Audience\": \"https://localhost:5001\"\n  }\n}\n```\n\n## Project Structure\n\n```\n{{projectStructure}}\n```\n\n## API Documentation\n\nAPI documentation is available at `/swagger` when running in Development mode.\n\nSee [API Reference](docs/api/README.md) for detailed endpoint documentation.\n\n## Testing\n\n```bash\n# Run all tests\ndotnet test\n\n# Run with coverage\ndotnet test --collect:\"XPlat Code Coverage\"\n\n# Run specific test project\ndotnet test tests/{{ProjectName}}.UnitTests\n```\n\n## Contributing\n\nSee [CONTRIBUTING.md](CONTRIBUTING.md) for contribution guidelines.\n\n## License\n\n{{license}}\n```\n\n### Changelog Generation (`/generate-docs changelog`)\n\n```bash\n# Extract commits since last tag\ngit log $(git describe --tags --abbrev=0)..HEAD --oneline\n\n# Group by type\ngit log --format=\"%s\" | grep -E \"^(feat|fix|docs|refactor|test|chore):\"\n```\n\n```markdown\n# Changelog\n\nAll notable changes to this project will be documented in this file.\n\nThe format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),\nand this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).\n\n## [Unreleased]\n\n### Added\n{{#each unreleasedFeatures}}\n- {{description}} ({{storyId}})\n{{/each}}\n\n### Changed\n{{#each unreleasedChanges}}\n- {{description}}\n{{/each}}\n\n### Fixed\n{{#each unreleasedFixes}}\n- {{description}} ({{storyId}})\n{{/each}}\n\n## [{{version}}] - {{date}}\n\n### Added\n{{#each features}}\n- {{description}} ([{{storyId}}](artifacts/stories/{{storyId}}.md))\n{{/each}}\n\n### Changed\n{{#each changes}}\n- {{description}}\n{{/each}}\n\n### Fixed\n{{#each fixes}}\n- {{description}}\n{{/each}}\n\n### Security\n{{#each security}}\n- {{description}}\n{{/each}}\n\n[Unreleased]: {{repoUrl}}/compare/v{{version}}...HEAD\n[{{version}}]: {{repoUrl}}/compare/v{{previousVersion}}...v{{version}}\n```\n\n## Output Summary\n\nAfter generation, display:\n\n```markdown\n## Documentation Generated\n\n| Type | Files | Location |\n|------|-------|----------|\n| API Reference | 1 | docs/api/README.md |\n| OpenAPI Spec | 1 | docs/api/openapi.json |\n| Module Docs | 4 | docs/modules/ |\n| README | 1 | README.md |\n| Changelog | 1 | CHANGELOG.md |\n\n### Generated Files\n- docs/api/README.md (API reference with examples)\n- docs/api/openapi.json (OpenAPI 3.0 specification)\n- docs/modules/domain.md (Domain layer documentation)\n- docs/modules/application.md (Application layer documentation)\n- docs/modules/infrastructure.md (Infrastructure layer documentation)\n- docs/modules/api.md (API layer documentation)\n\n### Next Steps\n1. Review generated documentation for accuracy\n2. Add missing descriptions to XML comments\n3. Commit documentation: git add docs/ && git commit -m \"docs: update API documentation\"\n```\n\n## Example\n\n```\nUser: /generate-docs api\n\nClaude: Generating API documentation...\n\nScanning controllers:\n- OrdersController (6 endpoints)\n- CustomersController (5 endpoints)\n- AuthController (3 endpoints)\n\nExtracting models:\n- OrderDto, CreateOrderRequest, OrderResponse\n- CustomerDto, CreateCustomerRequest\n- LoginRequest, AuthResponse\n\nGenerated:\n- docs/api/README.md (API reference)\n- docs/api/openapi.json (OpenAPI spec)\n\nAPI documentation generated successfully.\n14 endpoints documented across 3 controllers.\n```\n\n```\nUser: /generate-docs all --format md\n\nClaude: Generating all documentation...\n\n[1/4] API Documentation... ‚úì\n[2/4] Module Documentation... ‚úì\n[3/4] README... ‚úì\n[4/4] Changelog... ‚úì\n\nAll documentation generated in docs/\n\nSummary:\n- API: 14 endpoints, 12 models\n- Modules: 4 layers documented\n- README: Updated with current structure\n- Changelog: 23 commits processed\n\nTotal: 8 files generated\n```\n"
    },
    "eval": {
      "prompt": "# Eval Command\n\nManage eval-driven development workflow.\n\n## Usage\n\n`/eval [define|check|report|list] [feature-name]`\n\n## Define Evals\n\n`/eval define feature-name`\n\nCreate a new eval definition:\n\n1. Create `.claude/evals/feature-name.md` with template:\n\n```markdown\n## EVAL: feature-name\nCreated: $(date)\n\n### Capability Evals\n- [ ] [Description of capability 1]\n- [ ] [Description of capability 2]\n\n### Regression Evals\n- [ ] [Existing behavior 1 still works]\n- [ ] [Existing behavior 2 still works]\n\n### Success Criteria\n- pass@3 > 90% for capability evals\n- pass^3 = 100% for regression evals\n```\n\n2. Prompt user to fill in specific criteria\n\n## Check Evals\n\n`/eval check feature-name`\n\nRun evals for a feature:\n\n1. Read eval definition from `.claude/evals/feature-name.md`\n2. For each capability eval:\n   - Attempt to verify criterion\n   - Record PASS/FAIL\n   - Log attempt in `.claude/evals/feature-name.log`\n3. For each regression eval:\n   - Run relevant tests\n   - Compare against baseline\n   - Record PASS/FAIL\n4. Report current status:\n\n```\nEVAL CHECK: feature-name\n========================\nCapability: X/Y passing\nRegression: X/Y passing\nStatus: IN PROGRESS / READY\n```\n\n## Report Evals\n\n`/eval report feature-name`\n\nGenerate comprehensive eval report:\n\n```\nEVAL REPORT: feature-name\n=========================\nGenerated: $(date)\n\nCAPABILITY EVALS\n----------------\n[eval-1]: PASS (pass@1)\n[eval-2]: PASS (pass@2) - required retry\n[eval-3]: FAIL - see notes\n\nREGRESSION EVALS\n----------------\n[test-1]: PASS\n[test-2]: PASS\n[test-3]: PASS\n\nMETRICS\n-------\nCapability pass@1: 67%\nCapability pass@3: 100%\nRegression pass^3: 100%\n\nNOTES\n-----\n[Any issues, edge cases, or observations]\n\nRECOMMENDATION\n--------------\n[SHIP / NEEDS WORK / BLOCKED]\n```\n\n## List Evals\n\n`/eval list`\n\nShow all eval definitions:\n\n```\nEVAL DEFINITIONS\n================\nfeature-auth      [3/5 passing] IN PROGRESS\nfeature-search    [5/5 passing] READY\nfeature-export    [0/4 passing] NOT STARTED\n```\n\n## Arguments\n\n$ARGUMENTS:\n- `define <name>` - Create new eval definition\n- `check <name>` - Run and check evals\n- `report <name>` - Generate full report\n- `list` - Show all evals\n- `clean` - Remove old eval logs (keeps last 10 runs)\n"
    },
    "e2e": {
      "prompt": "---\ndescription: Generate and run end-to-end tests with Playwright. Creates test journeys, runs tests, captures screenshots/videos/traces, and uploads artifacts.\n---\n\n# E2E Command\n\nThis command invokes the **e2e-runner** agent to generate, maintain, and execute end-to-end tests using Playwright.\n\n## What This Command Does\n\n1. **Generate Test Journeys** - Create Playwright tests for user flows\n2. **Run E2E Tests** - Execute tests across browsers\n3. **Capture Artifacts** - Screenshots, videos, traces on failures\n4. **Upload Results** - HTML reports and JUnit XML\n5. **Identify Flaky Tests** - Quarantine unstable tests\n\n## When to Use\n\nUse `/e2e` when:\n- Testing critical user journeys (login, trading, payments)\n- Verifying multi-step flows work end-to-end\n- Testing UI interactions and navigation\n- Validating integration between frontend and backend\n- Preparing for production deployment\n\n## How It Works\n\nThe e2e-runner agent will:\n\n1. **Analyze user flow** and identify test scenarios\n2. **Generate Playwright test** using Page Object Model pattern\n3. **Run tests** across multiple browsers (Chrome, Firefox, Safari)\n4. **Capture failures** with screenshots, videos, and traces\n5. **Generate report** with results and artifacts\n6. **Identify flaky tests** and recommend fixes\n\n## Example Usage\n\n```\nUser: /e2e Test the market search and view flow\n\nAgent (e2e-runner):\n# E2E Test Generation: Market Search and View Flow\n\n## Test Scenario Identified\n\n**User Journey:** Market Search ‚Üí View Results ‚Üí Click Market ‚Üí View Details\n\n**Test Coverage:**\n1. Navigate to markets page\n2. Perform semantic search\n3. Verify search results\n4. Click on first result\n5. Verify market details page loads\n6. Verify chart renders\n\n## Generated Test Code\n\n```typescript\n// tests/e2e/markets/search-and-view.spec.ts\nimport { test, expect } from '@playwright/test'\nimport { MarketsPage } from '../../pages/MarketsPage'\nimport { MarketDetailsPage } from '../../pages/MarketDetailsPage'\n\ntest.describe('Market Search and View Flow', () => {\n  test('user can search markets and view details', async ({ page }) => {\n    // 1. Navigate to markets page\n    const marketsPage = new MarketsPage(page)\n    await marketsPage.goto()\n\n    // Verify page loaded\n    await expect(page).toHaveTitle(/Markets/)\n    await expect(page.locator('h1')).toContainText('Markets')\n\n    // 2. Perform semantic search\n    await marketsPage.searchMarkets('election')\n\n    // Wait for API response\n    await page.waitForResponse(resp =>\n      resp.url().includes('/api/markets/search') && resp.status() === 200\n    )\n\n    // 3. Verify search results\n    const marketCards = marketsPage.marketCards\n    await expect(marketCards.first()).toBeVisible()\n    const resultCount = await marketCards.count()\n    expect(resultCount).toBeGreaterThan(0)\n\n    // Take screenshot of search results\n    await page.screenshot({ path: 'artifacts/search-results.png' })\n\n    // 4. Click on first result\n    const firstMarketTitle = await marketCards.first().textContent()\n    await marketCards.first().click()\n\n    // 5. Verify market details page loads\n    await expect(page).toHaveURL(/\\/markets\\/[a-z0-9-]+/)\n\n    const detailsPage = new MarketDetailsPage(page)\n    await expect(detailsPage.marketName).toBeVisible()\n    await expect(detailsPage.marketDescription).toBeVisible()\n\n    // 6. Verify chart renders\n    await expect(detailsPage.priceChart).toBeVisible()\n\n    // Verify market name matches\n    const detailsTitle = await detailsPage.marketName.textContent()\n    expect(detailsTitle?.toLowerCase()).toContain(\n      firstMarketTitle?.toLowerCase().substring(0, 20) || ''\n    )\n\n    // Take screenshot of market details\n    await page.screenshot({ path: 'artifacts/market-details.png' })\n  })\n\n  test('search with no results shows empty state', async ({ page }) => {\n    const marketsPage = new MarketsPage(page)\n    await marketsPage.goto()\n\n    // Search for non-existent market\n    await marketsPage.searchMarkets('xyznonexistentmarket123456')\n\n    // Verify empty state\n    await expect(page.locator('[data-testid=\"no-results\"]')).toBeVisible()\n    await expect(page.locator('[data-testid=\"no-results\"]')).toContainText(\n      /no.*results|no.*markets/i\n    )\n\n    const marketCount = await marketsPage.marketCards.count()\n    expect(marketCount).toBe(0)\n  })\n\n  test('can clear search and see all markets again', async ({ page }) => {\n    const marketsPage = new MarketsPage(page)\n    await marketsPage.goto()\n\n    // Initial market count\n    const initialCount = await marketsPage.marketCards.count()\n\n    // Perform search\n    await marketsPage.searchMarkets('trump')\n    await page.waitForLoadState('networkidle')\n\n    // Verify filtered results\n    const filteredCount = await marketsPage.marketCards.count()\n    expect(filteredCount).toBeLessThan(initialCount)\n\n    // Clear search\n    await marketsPage.searchInput.clear()\n    await page.waitForLoadState('networkidle')\n\n    // Verify all markets shown again\n    const finalCount = await marketsPage.marketCards.count()\n    expect(finalCount).toBe(initialCount)\n  })\n})\n```\n\n## Running Tests\n\n```bash\n# Run the generated test\nnpx playwright test tests/e2e/markets/search-and-view.spec.ts\n\nRunning 3 tests using 3 workers\n\n  ‚úì  [chromium] ‚Ä∫ search-and-view.spec.ts:5:3 ‚Ä∫ user can search markets and view details (4.2s)\n  ‚úì  [chromium] ‚Ä∫ search-and-view.spec.ts:52:3 ‚Ä∫ search with no results shows empty state (1.8s)\n  ‚úì  [chromium] ‚Ä∫ search-and-view.spec.ts:67:3 ‚Ä∫ can clear search and see all markets again (2.9s)\n\n  3 passed (9.1s)\n\nArtifacts generated:\n- artifacts/search-results.png\n- artifacts/market-details.png\n- playwright-report/index.html\n```\n\n## Test Report\n\n```\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n‚ïë                    E2E Test Results                          ‚ïë\n‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£\n‚ïë Status:     ‚úÖ ALL TESTS PASSED                              ‚ïë\n‚ïë Total:      3 tests                                          ‚ïë\n‚ïë Passed:     3 (100%)                                         ‚ïë\n‚ïë Failed:     0                                                ‚ïë\n‚ïë Flaky:      0                                                ‚ïë\n‚ïë Duration:   9.1s                                             ‚ïë\n‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\nArtifacts:\nüì∏ Screenshots: 2 files\nüìπ Videos: 0 files (only on failure)\nüîç Traces: 0 files (only on failure)\nüìä HTML Report: playwright-report/index.html\n\nView report: npx playwright show-report\n```\n\n‚úÖ E2E test suite ready for CI/CD integration!\n```\n\n## Test Artifacts\n\nWhen tests run, the following artifacts are captured:\n\n**On All Tests:**\n- HTML Report with timeline and results\n- JUnit XML for CI integration\n\n**On Failure Only:**\n- Screenshot of the failing state\n- Video recording of the test\n- Trace file for debugging (step-by-step replay)\n- Network logs\n- Console logs\n\n## Viewing Artifacts\n\n```bash\n# View HTML report in browser\nnpx playwright show-report\n\n# View specific trace file\nnpx playwright show-trace artifacts/trace-abc123.zip\n\n# Screenshots are saved in artifacts/ directory\nopen artifacts/search-results.png\n```\n\n## Flaky Test Detection\n\nIf a test fails intermittently:\n\n```\n‚ö†Ô∏è  FLAKY TEST DETECTED: tests/e2e/markets/trade.spec.ts\n\nTest passed 7/10 runs (70% pass rate)\n\nCommon failure:\n\"Timeout waiting for element '[data-testid=\"confirm-btn\"]'\"\n\nRecommended fixes:\n1. Add explicit wait: await page.waitForSelector('[data-testid=\"confirm-btn\"]')\n2. Increase timeout: { timeout: 10000 }\n3. Check for race conditions in component\n4. Verify element is not hidden by animation\n\nQuarantine recommendation: Mark as test.fixme() until fixed\n```\n\n## Browser Configuration\n\nTests run on multiple browsers by default:\n- ‚úÖ Chromium (Desktop Chrome)\n- ‚úÖ Firefox (Desktop)\n- ‚úÖ WebKit (Desktop Safari)\n- ‚úÖ Mobile Chrome (optional)\n\nConfigure in `playwright.config.ts` to adjust browsers.\n\n## CI/CD Integration\n\nAdd to your CI pipeline:\n\n```yaml\n# .github/workflows/e2e.yml\n- name: Install Playwright\n  run: npx playwright install --with-deps\n\n- name: Run E2E tests\n  run: npx playwright test\n\n- name: Upload artifacts\n  if: always()\n  uses: actions/upload-artifact@v3\n  with:\n    name: playwright-report\n    path: playwright-report/\n```\n\n## PMX-Specific Critical Flows\n\nFor PMX, prioritize these E2E tests:\n\n**üî¥ CRITICAL (Must Always Pass):**\n1. User can connect wallet\n2. User can browse markets\n3. User can search markets (semantic search)\n4. User can view market details\n5. User can place trade (with test funds)\n6. Market resolves correctly\n7. User can withdraw funds\n\n**üü° IMPORTANT:**\n1. Market creation flow\n2. User profile updates\n3. Real-time price updates\n4. Chart rendering\n5. Filter and sort markets\n6. Mobile responsive layout\n\n## Best Practices\n\n**DO:**\n- ‚úÖ Use Page Object Model for maintainability\n- ‚úÖ Use data-testid attributes for selectors\n- ‚úÖ Wait for API responses, not arbitrary timeouts\n- ‚úÖ Test critical user journeys end-to-end\n- ‚úÖ Run tests before merging to main\n- ‚úÖ Review artifacts when tests fail\n\n**DON'T:**\n- ‚ùå Use brittle selectors (CSS classes can change)\n- ‚ùå Test implementation details\n- ‚ùå Run tests against production\n- ‚ùå Ignore flaky tests\n- ‚ùå Skip artifact review on failures\n- ‚ùå Test every edge case with E2E (use unit tests)\n\n## Important Notes\n\n**CRITICAL for PMX:**\n- E2E tests involving real money MUST run on testnet/staging only\n- Never run trading tests against production\n- Set `test.skip(process.env.NODE_ENV === 'production')` for financial tests\n- Use test wallets with small test funds only\n\n## Integration with Other Commands\n\n- Use `/plan` to identify critical journeys to test\n- Use `/tdd` for unit tests (faster, more granular)\n- Use `/e2e` for integration and user journey tests\n- Use `/code-review` to verify test quality\n\n## Related Agents\n\nThis command invokes the `e2e-runner` agent located at:\n`~/.claude/agents/e2e-runner.md`\n\n## Quick Commands\n\n```bash\n# Run all E2E tests\nnpx playwright test\n\n# Run specific test file\nnpx playwright test tests/e2e/markets/search.spec.ts\n\n# Run in headed mode (see browser)\nnpx playwright test --headed\n\n# Debug test\nnpx playwright test --debug\n\n# Generate test code\nnpx playwright codegen http://localhost:3000\n\n# View report\nnpx playwright show-report\n```\n",
      "description": "Generate and run end-to-end tests with Playwright. Creates test journeys, runs tests, captures screenshots/videos/traces, and uploads artifacts."
    },
    "dependencies": {
      "prompt": "# /dependencies - Dependency Graph Visualization\n\nAnalyze and display project dependencies including Clean Architecture layer relationships.\n\n## Usage\n```\n/dependencies [options]\n```\n\nOptions:\n- `--project <name>` - Analyze specific project (default: current solution)\n- `--format <ascii|mermaid|json>` - Output format (default: ascii)\n- `--packages` - Include NuGet package dependencies\n- `--depth <n>` - Transitive dependency depth (default: 1)\n- `--violations` - Only show architecture violations\n\n## Instructions\n\nWhen invoked:\n\n### 1. Find Solution and Projects\n\n```bash\n# Find solution file\nfind . -name \"*.sln\" -type f | head -1\n\n# List all projects\ndotnet sln list\n```\n\n### 2. Analyze Project References\n\nFor each `.csproj` file, extract:\n- Project references (`<ProjectReference>`)\n- Package references (`<PackageReference>`)\n- Target framework\n\n```bash\n# Extract project references\ngrep -h \"<ProjectReference\" **/*.csproj | sed 's/.*Include=\"\\([^\"]*\\)\".*/\\1/'\n\n# Extract package references\ngrep -h \"<PackageReference\" **/*.csproj\n```\n\n### 3. Validate Clean Architecture Rules\n\n**Layer Dependency Rules**:\n```\nALLOWED:\n- Domain ‚Üí (nothing)\n- Application ‚Üí Domain\n- Infrastructure ‚Üí Domain, Application\n- API ‚Üí Domain, Application, Infrastructure\n\nVIOLATIONS:\n- Domain ‚Üí Application (Domain must be independent)\n- Domain ‚Üí Infrastructure (Domain must be independent)\n- Application ‚Üí Infrastructure (Application must not know Infrastructure)\n- Application ‚Üí API (Application must not know API)\n```\n\n### 4. Generate ASCII Output (Default)\n\n```\n================================================================================\n                        DEPENDENCY GRAPH: OrderService\n================================================================================\n\nCLEAN ARCHITECTURE LAYERS\n-------------------------\n\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ                                    API                                       ‚îÇ\n‚îÇ                         OrderService.API.csproj                              ‚îÇ\n‚îÇ                                                                              ‚îÇ\n‚îÇ  Dependencies:                                                               ‚îÇ\n‚îÇ    ‚Üí OrderService.Application                                                ‚îÇ\n‚îÇ    ‚Üí OrderService.Infrastructure                                             ‚îÇ\n‚îÇ    ‚Üí OrderService.Domain (transitive)                                        ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                                      ‚îÇ\n                                      ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ                              INFRASTRUCTURE                                  ‚îÇ\n‚îÇ                     OrderService.Infrastructure.csproj                       ‚îÇ\n‚îÇ                                                                              ‚îÇ\n‚îÇ  Dependencies:                                                               ‚îÇ\n‚îÇ    ‚Üí OrderService.Application                                                ‚îÇ\n‚îÇ    ‚Üí OrderService.Domain                                                     ‚îÇ\n‚îÇ                                                                              ‚îÇ\n‚îÇ  Packages:                                                                   ‚îÇ\n‚îÇ    ‚Üí Npgsql.EntityFrameworkCore.PostgreSQL (8.0.0)                          ‚îÇ\n‚îÇ    ‚Üí Microsoft.EntityFrameworkCore (8.0.0)                                   ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                                      ‚îÇ\n                                      ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ                               APPLICATION                                    ‚îÇ\n‚îÇ                      OrderService.Application.csproj                         ‚îÇ\n‚îÇ                                                                              ‚îÇ\n‚îÇ  Dependencies:                                                               ‚îÇ\n‚îÇ    ‚Üí OrderService.Domain                                                     ‚îÇ\n‚îÇ                                                                              ‚îÇ\n‚îÇ  Packages:                                                                   ‚îÇ\n‚îÇ    ‚Üí MediatR (12.2.0)                                                        ‚îÇ\n‚îÇ    ‚Üí FluentValidation (11.9.0)                                               ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                                      ‚îÇ\n                                      ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ                                  DOMAIN                                      ‚îÇ\n‚îÇ                        OrderService.Domain.csproj                            ‚îÇ\n‚îÇ                                                                              ‚îÇ\n‚îÇ  Dependencies: (none - as expected)                                          ‚îÇ\n‚îÇ                                                                              ‚îÇ\n‚îÇ  Packages: (none - as expected)                                              ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n\n\nTEST PROJECTS\n-------------\n\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ        OrderService.UnitTests        ‚îÇ\n‚îÇ  ‚Üí OrderService.Domain               ‚îÇ\n‚îÇ  ‚Üí OrderService.Application          ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ    OrderService.IntegrationTests     ‚îÇ\n‚îÇ  ‚Üí OrderService.API                  ‚îÇ\n‚îÇ  ‚Üí OrderService.Infrastructure       ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ   OrderService.ArchitectureTests     ‚îÇ\n‚îÇ  ‚Üí All projects                      ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n\n\nARCHITECTURE VALIDATION\n-----------------------\n‚úÖ Domain has no project dependencies\n‚úÖ Application only depends on Domain\n‚úÖ Infrastructure depends on Domain + Application\n‚úÖ API is composition root\n\nSTATUS: All Clean Architecture rules satisfied\n```\n\n### 5. Generate Mermaid Output (--format mermaid)\n\n```mermaid\ngraph TD\n    subgraph \"Presentation Layer\"\n        API[OrderService.API]\n    end\n\n    subgraph \"Infrastructure Layer\"\n        INFRA[OrderService.Infrastructure]\n    end\n\n    subgraph \"Application Layer\"\n        APP[OrderService.Application]\n    end\n\n    subgraph \"Domain Layer\"\n        DOMAIN[OrderService.Domain]\n    end\n\n    API --> APP\n    API --> INFRA\n    INFRA --> APP\n    INFRA --> DOMAIN\n    APP --> DOMAIN\n\n    subgraph \"Test Projects\"\n        UNIT[UnitTests]\n        INT[IntegrationTests]\n        ARCH[ArchitectureTests]\n    end\n\n    UNIT --> DOMAIN\n    UNIT --> APP\n    INT --> API\n    ARCH --> DOMAIN\n    ARCH --> APP\n    ARCH --> INFRA\n    ARCH --> API\n\n    classDef domain fill:#e1f5fe\n    classDef app fill:#fff3e0\n    classDef infra fill:#f3e5f5\n    classDef api fill:#e8f5e9\n    classDef test fill:#fafafa\n\n    class DOMAIN domain\n    class APP app\n    class INFRA infra\n    class API api\n    class UNIT,INT,ARCH test\n```\n\n### 6. Generate JSON Output (--format json)\n\n```json\n{\n  \"solution\": \"OrderService.sln\",\n  \"analyzedAt\": \"2025-01-20T10:30:00Z\",\n  \"projects\": [\n    {\n      \"name\": \"OrderService.Domain\",\n      \"path\": \"src/OrderService.Domain/OrderService.Domain.csproj\",\n      \"layer\": \"Domain\",\n      \"targetFramework\": \"net8.0\",\n      \"projectReferences\": [],\n      \"packageReferences\": []\n    },\n    {\n      \"name\": \"OrderService.Application\",\n      \"path\": \"src/OrderService.Application/OrderService.Application.csproj\",\n      \"layer\": \"Application\",\n      \"targetFramework\": \"net8.0\",\n      \"projectReferences\": [\"OrderService.Domain\"],\n      \"packageReferences\": [\n        { \"name\": \"MediatR\", \"version\": \"12.2.0\" },\n        { \"name\": \"FluentValidation\", \"version\": \"11.9.0\" }\n      ]\n    }\n  ],\n  \"violations\": [],\n  \"summary\": {\n    \"totalProjects\": 7,\n    \"productionProjects\": 4,\n    \"testProjects\": 3,\n    \"totalPackages\": 15,\n    \"architectureValid\": true\n  }\n}\n```\n\n### 7. Show Violations Only (--violations)\n\nWhen architecture violations are detected:\n\n```\n================================================================================\n                     ARCHITECTURE VIOLATIONS DETECTED\n================================================================================\n\n‚ùå VIOLATION 1: Domain depends on Application\n   File: src/OrderService.Domain/OrderService.Domain.csproj\n   Reference: <ProjectReference Include=\"..\\OrderService.Application\\...\" />\n\n   RULE: Domain layer must have no project dependencies\n   FIX: Remove the reference. Move shared code to Domain or create shared kernel.\n\n‚ùå VIOLATION 2: Application depends on Infrastructure\n   File: src/OrderService.Application/OrderService.Application.csproj\n   Reference: <ProjectReference Include=\"..\\OrderService.Infrastructure\\...\" />\n\n   RULE: Application must only depend on Domain\n   FIX: Use interfaces in Application, implement in Infrastructure (DI)\n\n================================================================================\n                              SUMMARY\n================================================================================\nTotal violations: 2\nProjects affected: 2\n\nRun: /dependencies --format mermaid > deps.md\n     to generate visual diagram for documentation\n```\n\n### 8. Package Dependency Analysis (--packages)\n\n```\n================================================================================\n                         PACKAGE DEPENDENCIES\n================================================================================\n\nSHARED PACKAGES (used by multiple projects)\n-------------------------------------------\nMicrosoft.Extensions.DependencyInjection.Abstractions (8.0.0)\n  ‚îî‚îÄ Used by: Application, Infrastructure, API\n\nFluentValidation (11.9.0)\n  ‚îî‚îÄ Used by: Application, API\n\nLAYER-SPECIFIC PACKAGES\n-----------------------\nDomain:\n  (no packages - clean domain)\n\nApplication:\n  ‚îú‚îÄ MediatR (12.2.0)\n  ‚îú‚îÄ FluentValidation (11.9.0)\n  ‚îî‚îÄ FluentValidation.DependencyInjectionExtensions (11.9.0)\n\nInfrastructure:\n  ‚îú‚îÄ Microsoft.EntityFrameworkCore (8.0.0)\n  ‚îú‚îÄ Npgsql.EntityFrameworkCore.PostgreSQL (8.0.0)\n  ‚îú‚îÄ Microsoft.EntityFrameworkCore.Design (8.0.0)\n  ‚îî‚îÄ Serilog.AspNetCore (8.0.0)\n\nAPI:\n  ‚îú‚îÄ Swashbuckle.AspNetCore (6.5.0)\n  ‚îú‚îÄ Asp.Versioning.Mvc (8.0.0)\n  ‚îî‚îÄ Microsoft.AspNetCore.Authentication.JwtBearer (8.0.0)\n\nOUTDATED PACKAGES\n-----------------\n‚ö†Ô∏è  MediatR: 12.2.0 ‚Üí 12.3.0 available\n‚ö†Ô∏è  Serilog.AspNetCore: 8.0.0 ‚Üí 8.0.1 available\n\nVULNERABLE PACKAGES\n-------------------\n‚úÖ No known vulnerabilities detected\n```\n\n## Output Summary\n\nAt the end of analysis, always provide:\n\n```\n================================================================================\n                              ANALYSIS COMPLETE\n================================================================================\n\nSolution:        OrderService.sln\nProjects:        7 (4 production + 3 test)\nPackages:        15 unique packages\nFramework:       .NET 8.0\nArchitecture:    ‚úÖ Valid (Clean Architecture)\n\nQuick Commands:\n  /dependencies --violations     Check for architecture violations\n  /dependencies --packages       Show package dependencies\n  /dependencies --format mermaid Generate diagram for docs\n```\n\n## Example\n\n```\nUser: /dependencies\n\nClaude: Analyzing solution dependencies...\n\nFound solution: OrderService.sln\nAnalyzing 7 projects...\n\n[Generates ASCII dependency graph]\n\nArchitecture Status: ‚úÖ All Clean Architecture rules satisfied\n\n- Domain: 0 dependencies (correct)\n- Application: 1 dependency ‚Üí Domain (correct)\n- Infrastructure: 2 dependencies ‚Üí Domain, Application (correct)\n- API: 3 dependencies ‚Üí All layers (correct as composition root)\n\nNo violations detected.\n```\n\n```\nUser: /dependencies --violations\n\nClaude: Scanning for architecture violations...\n\n‚ùå Found 1 violation:\n\nVIOLATION: Application references Infrastructure\n  File: src/OrderService.Application/OrderService.Application.csproj\n  Line: 12\n\n  This violates the Dependency Rule. Application should not know about\n  Infrastructure details. Use dependency injection instead.\n\n  Suggested fix:\n  1. Define interface in Application: IEmailService\n  2. Implement in Infrastructure: SmtpEmailService\n  3. Register in API: services.AddScoped<IEmailService, SmtpEmailService>()\n```\n"
    },
    "create-project": {
      "prompt": "---\ndescription: \"Create a new fullstack project from an idea. Orchestrates the complete workflow: constitution ‚Üí specification ‚Üí planning ‚Üí scaffolding ‚Üí implementation.\"\n---\n\n# /create-project - Fullstack Project Creation\n\n## Overview\n\nThis command orchestrates the complete project creation workflow from idea to running code. It combines multiple skills into a single cohesive flow.\n\n**Usage**: `/create-project {project idea}`\n\n**Example**: `/create-project A fishing website where users share their favorite spots`\n\n---\n\n## The Workflow\n\n```\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ  1. CONSTITUTION (Optional)                                      ‚îÇ\n‚îÇ     Define project principles if not already established         ‚îÇ\n‚îÇ     Output: docs/constitution.md                                 ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                         ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ  2. SPECIFICATION                                                ‚îÇ\n‚îÇ     Gather requirements via max 3 questions                      ‚îÇ\n‚îÇ     Auto-triggers, no permission needed                          ‚îÇ\n‚îÇ     Output: specs/{project}/spec.md                              ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                         ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ  3. PLANNING                                                     ‚îÇ\n‚îÇ     Technical architecture and approach                          ‚îÇ\n‚îÇ     Output: specs/{project}/plan.md                              ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                         ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ  4. SCAFFOLDING                                                  ‚îÇ\n‚îÇ     Create backend + frontend + infrastructure                   ‚îÇ\n‚îÇ     Uses templates automatically                                 ‚îÇ\n‚îÇ     Output: projects/{ProjectName}-api/                          ‚îÇ\n‚îÇ             projects/{ProjectName}-frontend/                     ‚îÇ\n‚îÇ             projects/{ProjectName}/infrastructure/               ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                         ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ  5. TASK BREAKDOWN                                               ‚îÇ\n‚îÇ     Convert plan to executable tasks by user story               ‚îÇ\n‚îÇ     Output: specs/{project}/tasks.md                             ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                         ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ  6. IMPLEMENTATION                                               ‚îÇ\n‚îÇ     Execute tasks story by story with TDD                        ‚îÇ\n‚îÇ     P1 stories first (MVP)                                       ‚îÇ\n‚îÇ     Checkpoint after each story                                  ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n---\n\n## Execution Instructions\n\n### Step 1: Constitution Check\n\nCheck if `docs/constitution.md` exists:\n\n**If exists**: Skip to Step 2\n**If not exists**: Ask user ONE question:\n\n```markdown\n## Project Governance\n\n| Option | Type | Description |\n|--------|------|-------------|\n| A (Recommended) | Enterprise | Strict architecture, TDD, 80% coverage |\n| B | Startup | Pragmatic, speed-focused, critical paths tested |\n| C | Minimal | Basic structure only, test as needed |\n\nWhich approach fits this project?\n```\n\nBased on answer, create `docs/constitution.md` using `constitution` skill.\n\n### Step 2: Specification (Auto-triggered)\n\nUse `spec-driven-development` skill:\n\n1. Acknowledge the idea (1 sentence)\n2. Present max 3 questions with recommendations\n3. Generate specification after answers\n4. Get approval before proceeding\n\n**Output**: `specs/{ProjectSlug}/spec.md`\n\n### Step 3: Planning\n\nUse `planning` skill:\n\n1. Read the approved specification\n2. Make technical decisions (stack already decided from templates)\n3. Define data model\n4. Plan API endpoints\n5. Identify phases and dependencies\n\n**Output**: `specs/{ProjectSlug}/plan.md`\n\n### Step 4: Scaffolding\n\nExecute scaffolding commands:\n\n```bash\n# Create project directory\nmkdir -p projects/{ProjectName}\n\n# Scaffold backend\n/scaffold {ProjectName} clean-architecture\n\n# Scaffold frontend\n/scaffold {ProjectName} react-frontend\n\n# Copy infrastructure\ncp -r templates/infrastructure projects/{ProjectName}/infrastructure\n\n# Setup infrastructure environment\ncd projects/{ProjectName}/infrastructure\ncp .env.example .env\n```\n\nRename placeholders in scaffolded code:\n- `ProjectName` ‚Üí actual project name\n- `projectname` ‚Üí lowercase version\n\n### Step 5: Task Breakdown\n\nGenerate `specs/{ProjectSlug}/tasks.md`:\n\n1. Read spec.md for user stories\n2. Read plan.md for technical approach\n3. Create tasks organized by user story\n4. Mark parallel opportunities [P]\n5. Include checkpoints\n\nUse `templates/artifacts/tasks-template.md` as reference.\n\n### Step 6: Implementation\n\nBegin implementation:\n\n1. Start infrastructure: `docker compose up -d`\n2. Work through tasks in order\n3. TDD: Write test ‚Üí See it fail ‚Üí Implement ‚Üí Pass\n4. Commit after each logical unit\n5. Checkpoint after each user story (US1, US2, etc.)\n\n**Stop points**:\n- After US1 (MVP) - Demo/validate\n- After each subsequent story - Validate independently\n\n---\n\n## Question Limits\n\n| Phase | Max Questions | Format |\n|-------|---------------|--------|\n| Constitution | 1 | Single table with 3 options |\n| Specification | 3 per phase | Tables with recommendations |\n| Planning | 0-2 | Only if unusual requirements |\n| Implementation | As needed | For clarifications only |\n\n---\n\n## Templates Used\n\n| Template | Purpose |\n|----------|---------|\n| `templates/clean-architecture-solution/` | .NET 8 backend |\n| `templates/react-frontend-template/` | Next.js 14 frontend |\n| `templates/infrastructure/` | Docker, PostgreSQL, Redis |\n| `templates/artifacts/spec-template.md` | Specification format |\n| `templates/artifacts/plan-template.md` | Plan format |\n| `templates/artifacts/tasks-template.md` | Task breakdown format |\n\n---\n\n## Skills Invoked\n\n| Skill | When |\n|-------|------|\n| `constitution` | Step 1 (if needed) |\n| `spec-driven-development` | Step 2 |\n| `planning` | Step 3 |\n| `dotnet-clean-architecture` | Step 6 (backend) |\n| `react-scaffold` | Step 6 (frontend) |\n| `fullstack-development` | Step 6 (cross-stack) |\n| `docker-infrastructure` | Step 6 (running app) |\n| `tdd` | Step 6 (testing) |\n\n---\n\n## Example Flow\n\n**User**: `/create-project A fishing website where users share spots`\n\n**Claude**:\n> I'll help you create a fishing spots sharing platform. Let me gather requirements.\n>\n> ## Question 1: Target Audience\n> | Option | Description | Implications |\n> |--------|-------------|--------------|\n> | A (Recommended) | Public - anyone views, registered users post | Wide reach |\n> | B | Members only | Tighter community |\n> | C | Invite-only | Exclusive |\n>\n> ## Question 2: MVP Features\n> | Option | Description |\n> |--------|-------------|\n> | A | Basic: name, location, description |\n> | B (Recommended) | Standard: + photos + ratings |\n> | C | Full: + comments + reviews |\n>\n> ## Question 3: Map Display\n> | Option | Description |\n> |--------|-------------|\n> | A (Recommended) | List view only (MVP) |\n> | B | Static map per spot |\n> | C | Interactive map |\n>\n> **Reply with choices (e.g., \"1: A, 2: B, 3: A\")**\n\n**User**: \"1: A, 2: B, 3: A\"\n\n**Claude**:\n> Perfect! Here's the specification...\n> [Generates spec.md]\n>\n> Specification ready. Shall I proceed with planning and scaffolding?\n\n**User**: \"yes\"\n\n**Claude**:\n> [Generates plan.md]\n> [Scaffolds projects]\n> [Generates tasks.md]\n>\n> Project scaffolded! Structure:\n> ```\n> projects/FishingSpots/\n> ‚îú‚îÄ‚îÄ FishingSpots-api/          # .NET backend\n> ‚îú‚îÄ‚îÄ FishingSpots-frontend/     # React frontend\n> ‚îî‚îÄ‚îÄ infrastructure/            # Docker setup\n> ```\n>\n> To start development:\n> ```bash\n> cd projects/FishingSpots/infrastructure\n> docker compose up -d\n> ```\n>\n> Ready to begin implementation with US-001 (User Registration)?\n\n---\n\n## Output Structure\n\nAfter `/create-project`, you'll have:\n\n```\nprojects/{ProjectName}/\n‚îú‚îÄ‚îÄ {ProjectName}-api/           # .NET Clean Architecture backend\n‚îÇ   ‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ {ProjectName}.Domain/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ {ProjectName}.Application/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ {ProjectName}.Infrastructure/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ {ProjectName}.Api/\n‚îÇ   ‚îî‚îÄ‚îÄ tests/\n‚îú‚îÄ‚îÄ {ProjectName}-frontend/      # Next.js React frontend\n‚îÇ   ‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lib/\n‚îÇ   ‚îî‚îÄ‚îÄ e2e/\n‚îî‚îÄ‚îÄ infrastructure/              # Shared Docker setup\n    ‚îú‚îÄ‚îÄ docker-compose.yml\n    ‚îî‚îÄ‚îÄ .env\n\nspecs/{project-slug}/\n‚îú‚îÄ‚îÄ spec.md                      # Feature specification\n‚îú‚îÄ‚îÄ plan.md                      # Implementation plan\n‚îî‚îÄ‚îÄ tasks.md                     # Task breakdown\n```\n",
      "description": "Create a new fullstack project from an idea. Orchestrates the complete workflow: constitution ‚Üí specification ‚Üí planning ‚Üí scaffolding ‚Üí implementation."
    },
    "coverage": {
      "prompt": "# /coverage - Check Code Coverage\n\nRun tests with coverage and analyze results.\n\n## Usage\n```\n/coverage [scope]\n```\n\nWhere scope is:\n- (none) - Run tests and show coverage summary\n- `report` - Generate detailed coverage report\n- `check` - Validate coverage meets thresholds (>=80%)\n- `uncovered <file>` - Show uncovered lines in a file\n\n## Instructions\n\n### Run Coverage (`/coverage` or `/coverage report`)\n\n```bash\n# Run tests with coverage collection\ndotnet test --collect:\"XPlat Code Coverage\" --results-directory ./coverage\n\n# Find the coverage file\nCOVERAGE_FILE=$(find ./coverage -name \"coverage.cobertura.xml\" | head -1)\n\n# If coverage script exists, use it\nif [ -f \"scripts/coverage/check-coverage.py\" ]; then\n    python3 scripts/coverage/check-coverage.py \"$COVERAGE_FILE\"\nfi\n```\n\n### Parse Coverage Report\n\nWhen analyzing coverage.cobertura.xml or coverage.xml:\n\n1. Extract overall coverage percentage\n2. Break down by namespace/layer\n3. Identify files below threshold\n\n### Output Format\n\n```markdown\n# Code Coverage Report\nGenerated: <timestamp>\n\n## Summary\n\n| Metric | Value | Status |\n|--------|-------|--------|\n| Line Coverage | X% | PASS/FAIL |\n| Branch Coverage | X% | PASS/FAIL |\n| Threshold | 80% | - |\n\n## Coverage by Layer\n\n| Layer | Line % | Branch % | Status |\n|-------|--------|----------|--------|\n| Domain | X% | X% | PASS |\n| Application | X% | X% | PASS |\n| Infrastructure | X% | X% | WARN |\n| API | X% | X% | N/A |\n\n## Files Below Threshold\n\n| File | Line % | Uncovered Lines |\n|------|--------|-----------------|\n| OrderService.cs | 65% | 45-52, 78-85 |\n| PaymentHandler.cs | 72% | 34-40 |\n\n## Recommendations\n\n1. Add tests for uncovered business logic\n2. Focus on Domain and Application layers\n3. Consider edge cases and error paths\n```\n\n### Check Thresholds (`/coverage check`)\n\nValidate coverage meets requirements:\n\n```bash\n# Minimum thresholds\nDOMAIN_THRESHOLD=80\nAPPLICATION_THRESHOLD=80\nOVERALL_THRESHOLD=80\n\n# Parse coverage and compare\n# Exit 1 if below threshold\n```\n\n### Show Uncovered Lines (`/coverage uncovered <file>`)\n\nDisplay specific uncovered lines in a file:\n\n```markdown\n## Uncovered Lines: <filename>\n\nLine 45-52:\n```csharp\npublic void ProcessOrder(Order order)\n{\n    if (order.Status == OrderStatus.Cancelled)  // Line 45\n    {\n        throw new OrderCancelledException();    // Line 46-47 uncovered\n    }\n    // ...\n}\n```\n\n**Reason**: Error path not tested\n**Suggestion**: Add test for cancelled order scenario\n```\n\n## Coverage Requirements\n\nPer Corporate R&D Policy:\n- **Domain Layer**: >=80% line and branch coverage\n- **Application Layer**: >=80% line and branch coverage\n- **Infrastructure**: Best effort (external dependencies)\n- **API**: Integration tests cover endpoints\n\n## Tips for Improving Coverage\n\n1. **Test edge cases**: null inputs, empty collections, boundary values\n2. **Test error paths**: exceptions, validation failures\n3. **Test business rules**: domain logic variations\n4. **Use test data builders**: consistent test data setup\n5. **Parameterized tests**: `[Theory]` with `[InlineData]`\n\n## Example\n\n```\nUser: /coverage\n\nClaude: Running tests with coverage...\n\ndotnet test --collect:\"XPlat Code Coverage\" --results-directory ./coverage\n\n## Coverage Summary\n\n| Metric | Value | Status |\n|--------|-------|--------|\n| Overall | 87% | PASS |\n| Domain | 92% | PASS |\n| Application | 85% | PASS |\n| Infrastructure | 78% | WARN |\n\n### Files Needing Attention\n\n1. `PaymentService.cs` (72%) - Missing error handling tests\n2. `OrderValidator.cs` (68%) - Missing validation edge cases\n\nRun `/coverage uncovered PaymentService.cs` for details.\n```\n"
    },
    "code-review": {
      "prompt": "# Code Review\n\nComprehensive security and quality review of uncommitted changes:\n\n1. Get changed files: git diff --name-only HEAD\n\n2. For each changed file, check for:\n\n**Security Issues (CRITICAL):**\n- Hardcoded credentials, API keys, tokens\n- SQL injection vulnerabilities\n- XSS vulnerabilities  \n- Missing input validation\n- Insecure dependencies\n- Path traversal risks\n\n**Code Quality (HIGH):**\n- Functions > 50 lines\n- Files > 800 lines\n- Nesting depth > 4 levels\n- Missing error handling\n- console.log statements\n- TODO/FIXME comments\n- Missing JSDoc for public APIs\n\n**Best Practices (MEDIUM):**\n- Mutation patterns (use immutable instead)\n- Emoji usage in code/comments\n- Missing tests for new code\n- Accessibility issues (a11y)\n\n3. Generate report with:\n   - Severity: CRITICAL, HIGH, MEDIUM, LOW\n   - File location and line numbers\n   - Issue description\n   - Suggested fix\n\n4. Block commit if CRITICAL or HIGH issues found\n\nNever approve code with security vulnerabilities!\n"
    },
    "checkpoint": {
      "prompt": "# Checkpoint Command\n\nCreate or verify a checkpoint in your workflow.\n\n## Usage\n\n`/checkpoint [create|verify|list] [name]`\n\n## Create Checkpoint\n\nWhen creating a checkpoint:\n\n1. Run `/verify quick` to ensure current state is clean\n2. Create a git stash or commit with checkpoint name\n3. Log checkpoint to `.claude/checkpoints.log`:\n\n```bash\necho \"$(date +%Y-%m-%d-%H:%M) | $CHECKPOINT_NAME | $(git rev-parse --short HEAD)\" >> .claude/checkpoints.log\n```\n\n4. Report checkpoint created\n\n## Verify Checkpoint\n\nWhen verifying against a checkpoint:\n\n1. Read checkpoint from log\n2. Compare current state to checkpoint:\n   - Files added since checkpoint\n   - Files modified since checkpoint\n   - Test pass rate now vs then\n   - Coverage now vs then\n\n3. Report:\n```\nCHECKPOINT COMPARISON: $NAME\n============================\nFiles changed: X\nTests: +Y passed / -Z failed\nCoverage: +X% / -Y%\nBuild: [PASS/FAIL]\n```\n\n## List Checkpoints\n\nShow all checkpoints with:\n- Name\n- Timestamp\n- Git SHA\n- Status (current, behind, ahead)\n\n## Workflow\n\nTypical checkpoint flow:\n\n```\n[Start] --> /checkpoint create \"feature-start\"\n   |\n[Implement] --> /checkpoint create \"core-done\"\n   |\n[Test] --> /checkpoint verify \"core-done\"\n   |\n[Refactor] --> /checkpoint create \"refactor-done\"\n   |\n[PR] --> /checkpoint verify \"feature-start\"\n```\n\n## Arguments\n\n$ARGUMENTS:\n- `create <name>` - Create named checkpoint\n- `verify <name>` - Verify against named checkpoint\n- `list` - Show all checkpoints\n- `clear` - Remove old checkpoints (keeps last 5)\n"
    },
    "build-fix": {
      "prompt": "# Build and Fix\n\nIncrementally fix TypeScript and build errors:\n\n1. Run build: npm run build or pnpm build\n\n2. Parse error output:\n   - Group by file\n   - Sort by severity\n\n3. For each error:\n   - Show error context (5 lines before/after)\n   - Explain the issue\n   - Propose fix\n   - Apply fix\n   - Re-run build\n   - Verify error resolved\n\n4. Stop if:\n   - Fix introduces new errors\n   - Same error persists after 3 attempts\n   - User requests pause\n\n5. Show summary:\n   - Errors fixed\n   - Errors remaining\n   - New errors introduced\n\nFix one error at a time for safety!\n"
    },
    "adr": {
      "prompt": "# /adr - Create Architecture Decision Record\n\nCreate a new ADR (Architecture Decision Record) for documenting significant architectural decisions.\n\n## Usage\n```\n/adr <title>\n```\n\n## When to Create an ADR\n\nPer Corporate R&D Policy, ADRs are **mandatory** when:\n- Introducing new services, databases, or external dependencies\n- Modifying Clean Architecture boundaries or core domain models\n- Changing security model, authentication, or authorization\n- Creating breaking changes or incompatible schema migrations\n- Adding new infrastructure components (message queues, caches, etc.)\n- Changing deployment architecture\n\n## Instructions\n\nWhen invoked:\n\n1. **Determine ADR number**:\n   - List existing ADRs in `docs/architecture/adr/`\n   - Find highest numbered ADR and increment\n   - Format: `ADR-####` (4 digits, zero-padded)\n\n2. **Create ADR file** at `docs/architecture/adr/ADR-####-<slug>.md`:\n\n```markdown\n# ADR-#### - <Title>\n\n## Status\nProposed | Accepted | Deprecated | Superseded by ADR-####\n\n## Date\n<YYYY-MM-DD>\n\n## Context\n<What is the issue that we're seeing that is motivating this decision or change?>\n\n## Decision\n<What is the change that we're proposing and/or doing?>\n\n## Consequences\n\n### Positive\n- <benefit 1>\n- <benefit 2>\n\n### Negative\n- <trade-off 1>\n- <trade-off 2>\n\n### Neutral\n- <neutral observation>\n\n## Alternatives Considered\n\n### Alternative 1: <Name>\n**Description**: <brief description>\n**Pros**: <advantages>\n**Cons**: <disadvantages>\n**Why not chosen**: <reasoning>\n\n### Alternative 2: <Name>\n...\n\n## Implementation\n\n### Required Changes\n- [ ] <change 1>\n- [ ] <change 2>\n\n### Affected Components\n- <component 1>\n- <component 2>\n\n### Migration Plan\n<If applicable, how do we transition from current to new state?>\n\n## Security Considerations\n<Security implications of this decision>\n\n## Related\n- Stories: ACF-###, ACF-###\n- Previous ADRs: ADR-####\n- External docs: <links>\n\n## Approval\n\n| Role | Name | Date | Decision |\n|------|------|------|----------|\n| Product Owner | | | Pending |\n| Security | | | Pending |\n| Architecture | | | Pending |\n```\n\n3. **Prompt for required information**:\n   - What problem are we solving?\n   - What alternatives were considered?\n   - What are the trade-offs?\n   - What story IDs are related?\n\n4. **Remind about approval workflow**:\n   - ADRs require approval from: Product Owner + Security + Architecture owner\n   - Status should be \"Proposed\" until approved\n   - Link to related stories\n\n## ADR Status Lifecycle\n\n```\nProposed ‚Üí Accepted ‚Üí [Superseded | Deprecated]\n```\n\n- **Proposed**: Initial draft, under review\n- **Accepted**: Approved by required stakeholders\n- **Superseded**: Replaced by a newer ADR (reference it)\n- **Deprecated**: No longer applicable\n\n## Example\n\n```\nUser: /adr Add Redis Caching Layer\n\nClaude: Creating ADR for Redis caching...\n\nI need some information:\n\n1. **Context**: What performance or scalability issue are we addressing?\n2. **Alternatives**: What other caching solutions were considered? (e.g., in-memory, distributed cache, CDN)\n3. **Related stories**: Which ACF-### stories does this support?\n\n[After gathering info]\n\nCreated: docs/architecture/adr/ADR-0012-redis-caching-layer.md\n\nADR-0012: Add Redis Caching Layer\nStatus: Proposed\n\nNext steps:\n1. Review the ADR for completeness\n2. Get approval from Product Owner, Security, Architecture\n3. Update status to \"Accepted\" once approved\n4. Link to implementation stories\n```\n\n## ADR Directory Structure\n\n```\ndocs/architecture/adr/\n‚îú‚îÄ‚îÄ README.md                           # Index of all ADRs\n‚îú‚îÄ‚îÄ ADR-0001-clean-architecture.md      # Initial architecture\n‚îú‚îÄ‚îÄ ADR-0002-jwt-authentication.md      # Auth decision\n‚îú‚îÄ‚îÄ ADR-0003-postgresql-database.md     # Database choice\n‚îî‚îÄ‚îÄ ADR-####-<title-slug>.md            # New ADRs\n```\n\n## Index File\n\nKeep `docs/architecture/adr/README.md` updated:\n\n```markdown\n# Architecture Decision Records\n\n| ADR | Title | Status | Date |\n|-----|-------|--------|------|\n| [ADR-0001](ADR-0001-clean-architecture.md) | Clean Architecture | Accepted | 2024-01-15 |\n| [ADR-0002](ADR-0002-jwt-authentication.md) | JWT Authentication | Accepted | 2024-01-20 |\n```\n"
    },
    "add-test": {
      "prompt": "# /add-test - Generate Test Cases\n\nGenerate unit or integration tests for existing code.\n\n## Usage\n```\n/add-test <type> <target> [options]\n```\n\nTypes:\n- `unit` - Unit tests for classes/methods\n- `integration` - Integration tests for endpoints\n- `architecture` - Architecture tests for layer validation\n\nTarget:\n- Class name, method name, or file path\n\nOptions:\n- `--story <ACF-###>` - Link to story ID (required for traceability)\n- `--coverage` - Generate tests to improve coverage\n\n## Instructions\n\n### Unit Tests (`/add-test unit <ClassName>`)\n\n1. **Analyze the class**:\n   - Identify public methods\n   - Identify dependencies (for mocking)\n   - Identify edge cases and error paths\n\n2. **Generate test class**:\n```csharp\npublic class <ClassName>Tests\n{\n    private readonly Mock<IDependency> _dependencyMock;\n    private readonly <ClassName> _sut;\n\n    public <ClassName>Tests()\n    {\n        _dependencyMock = new Mock<IDependency>();\n        _sut = new <ClassName>(_dependencyMock.Object);\n    }\n}\n```\n\n3. **Generate test methods** for each scenario:\n   - Happy path (valid input ‚Üí expected output)\n   - Null input ‚Üí ArgumentNullException\n   - Invalid input ‚Üí ValidationException\n   - Error from dependency ‚Üí proper error handling\n\n### Integration Tests (`/add-test integration <Endpoint>`)\n\n1. **Analyze the endpoint**:\n   - HTTP method\n   - Request/response types\n   - Authentication requirements\n\n2. **Generate test class**:\n```csharp\npublic class <Controller>Tests : IClassFixture<WebApplicationFactory<Program>>\n{\n    private readonly HttpClient _client;\n    private readonly WebApplicationFactory<Program> _factory;\n\n    // Setup...\n}\n```\n\n3. **Generate tests** for each scenario:\n   - Valid request ‚Üí expected status code\n   - Invalid request ‚Üí 400 Bad Request\n   - Not found ‚Üí 404 Not Found\n   - Unauthorized ‚Üí 401 Unauthorized\n\n### Architecture Tests (`/add-test architecture`)\n\nGenerate NetArchTest tests to validate Clean Architecture rules:\n\n```csharp\npublic class ArchitectureTests\n{\n    [Fact]\n    public void Domain_Should_Not_Reference_Infrastructure()\n    {\n        var result = Types.InAssembly(typeof(DomainAssembly).Assembly)\n            .Should()\n            .NotHaveDependencyOn(\"Infrastructure\")\n            .GetResult();\n\n        result.IsSuccessful.Should().BeTrue();\n    }\n}\n```\n\n## Test Templates\n\nUses templates from `.claude/templates/`:\n- `unit-test.cs.template`\n- `integration-test.cs.template`\n\n## Naming Convention\n\n```\nMethodName_Scenario_ExpectedBehavior\n\nExamples:\n- CreateOrder_ValidInput_ReturnsOrderId\n- CreateOrder_NullCustomerId_ThrowsArgumentNullException\n- CreateOrder_DuplicateOrder_ThrowsInvalidOperationException\n```\n\n## Required Traits\n\nAll tests MUST include story trait:\n```csharp\n[Fact]\n[Trait(\"Story\", \"ACF-###\")]\n[Trait(\"Category\", \"Unit\")]  // or \"Integration\"\n```\n\n## Output\n\n```markdown\n## Tests Generated for <Target>\n\n### Files Created\n- tests/Project.UnitTests/<ClassName>Tests.cs\n\n### Test Cases (5)\n| Test | Scenario | Linked Story |\n|------|----------|--------------|\n| CreateOrder_ValidInput_ReturnsOrderId | Happy path | ACF-042 |\n| CreateOrder_NullCustomerId_ThrowsArgumentNullException | Null guard | ACF-042 |\n| CreateOrder_EmptyItems_ThrowsValidationException | Validation | ACF-042 |\n| CreateOrder_CustomerNotFound_ReturnsFailure | Error handling | ACF-042 |\n| CreateOrder_ConcurrentAccess_HandlesCorrectly | Concurrency | ACF-042 |\n\n### Next Steps\n1. Review generated tests\n2. Run: dotnet test\n3. Check coverage: /coverage\n```\n\n## Example\n\n```\nUser: /add-test unit OrderService --story ACF-042\n\nClaude: Analyzing OrderService for test generation...\n\nFound methods to test:\n1. CreateOrderAsync(CreateOrderCommand)\n2. GetOrderByIdAsync(Guid)\n3. UpdateOrderStatusAsync(Guid, OrderStatus)\n\nGenerating tests with story trait ACF-042...\n\nCreated: tests/Project.UnitTests/Services/OrderServiceTests.cs\n\nTest cases generated:\n- CreateOrderAsync_ValidCommand_ReturnsOrderId\n- CreateOrderAsync_NullCommand_ThrowsArgumentNullException\n- CreateOrderAsync_InvalidCustomer_ReturnsFailure\n- GetOrderByIdAsync_ExistingOrder_ReturnsOrder\n- GetOrderByIdAsync_NonExistentOrder_ReturnsNull\n- UpdateOrderStatusAsync_ValidTransition_UpdatesStatus\n- UpdateOrderStatusAsync_InvalidTransition_ThrowsInvalidOperationException\n\nRun tests: dotnet test --filter \"FullyQualifiedName~OrderServiceTests\"\n```\n"
    },
    "add-observability": {
      "prompt": "# /add-observability - Add Observability Stack\n\nAdd comprehensive observability with structured logging, distributed tracing, and metrics.\n\n## Usage\n```\n/add-observability [options]\n```\n\nOptions:\n- `--logging <serilog|nlog>` - Logging framework (default: serilog)\n- `--tracing <jaeger|zipkin|otlp>` - Tracing exporter (default: otlp)\n- `--metrics` - Include Prometheus metrics\n- `--health-checks` - Include Kubernetes health checks\n- `--story <ACF-###>` - Link to story ID\n\n## Instructions\n\nWhen invoked:\n\n### 1. Add Required NuGet Packages\n\n**Serilog packages:**\n```xml\n<PackageReference Include=\"Serilog.AspNetCore\" Version=\"8.0.0\" />\n<PackageReference Include=\"Serilog.Sinks.Console\" Version=\"5.0.1\" />\n<PackageReference Include=\"Serilog.Sinks.Seq\" Version=\"6.0.0\" />\n<PackageReference Include=\"Serilog.Enrichers.Environment\" Version=\"2.3.0\" />\n<PackageReference Include=\"Serilog.Enrichers.Thread\" Version=\"3.1.0\" />\n<PackageReference Include=\"Serilog.Enrichers.Span\" Version=\"3.1.0\" />\n```\n\n**OpenTelemetry packages:**\n```xml\n<PackageReference Include=\"OpenTelemetry\" Version=\"1.7.0\" />\n<PackageReference Include=\"OpenTelemetry.Extensions.Hosting\" Version=\"1.7.0\" />\n<PackageReference Include=\"OpenTelemetry.Instrumentation.AspNetCore\" Version=\"1.7.0\" />\n<PackageReference Include=\"OpenTelemetry.Instrumentation.Http\" Version=\"1.7.0\" />\n<PackageReference Include=\"OpenTelemetry.Instrumentation.EntityFrameworkCore\" Version=\"1.0.0-beta.11\" />\n<PackageReference Include=\"OpenTelemetry.Exporter.OpenTelemetryProtocol\" Version=\"1.7.0\" />\n<PackageReference Include=\"OpenTelemetry.Exporter.Prometheus.AspNetCore\" Version=\"1.7.0-rc.1\" />\n```\n\n**Health check packages:**\n```xml\n<PackageReference Include=\"AspNetCore.HealthChecks.NpgSql\" Version=\"8.0.0\" />\n<PackageReference Include=\"AspNetCore.HealthChecks.Redis\" Version=\"8.0.0\" />\n<PackageReference Include=\"AspNetCore.HealthChecks.UI.Client\" Version=\"8.0.0\" />\n```\n\n### 2. Create Observability Structure\n\n```\nsrc/{{ProjectName}}.Infrastructure/Observability/\n‚îú‚îÄ‚îÄ Logging/\n‚îÇ   ‚îú‚îÄ‚îÄ LoggingExtensions.cs\n‚îÇ   ‚îî‚îÄ‚îÄ CorrelationIdMiddleware.cs\n‚îú‚îÄ‚îÄ Tracing/\n‚îÇ   ‚îî‚îÄ‚îÄ TracingExtensions.cs\n‚îú‚îÄ‚îÄ Metrics/\n‚îÇ   ‚îú‚îÄ‚îÄ MetricsExtensions.cs\n‚îÇ   ‚îî‚îÄ‚îÄ ApplicationMetrics.cs\n‚îî‚îÄ‚îÄ HealthChecks/\n    ‚îî‚îÄ‚îÄ HealthCheckExtensions.cs\n```\n\n### 3. Generate Logging Configuration\n\n**LoggingExtensions.cs**:\n```csharp\nusing Serilog;\nusing Serilog.Events;\nusing Serilog.Formatting.Compact;\n\nnamespace {{Namespace}}.Infrastructure.Observability.Logging;\n\npublic static class LoggingExtensions\n{\n    public static IHostBuilder UseStructuredLogging(this IHostBuilder hostBuilder)\n    {\n        return hostBuilder.UseSerilog((context, services, loggerConfiguration) =>\n        {\n            var environment = context.HostingEnvironment.EnvironmentName;\n            var applicationName = context.HostingEnvironment.ApplicationName;\n\n            loggerConfiguration\n                .ReadFrom.Configuration(context.Configuration)\n                .ReadFrom.Services(services)\n                .Enrich.FromLogContext()\n                .Enrich.WithMachineName()\n                .Enrich.WithEnvironmentName()\n                .Enrich.WithThreadId()\n                .Enrich.WithSpan()\n                .Enrich.WithProperty(\"Application\", applicationName)\n                .Enrich.WithProperty(\"Environment\", environment);\n\n            // Development: Human-readable console output\n            if (context.HostingEnvironment.IsDevelopment())\n            {\n                loggerConfiguration.WriteTo.Console(\n                    outputTemplate: \"[{Timestamp:HH:mm:ss} {Level:u3}] {CorrelationId} {Message:lj}{NewLine}{Exception}\");\n            }\n            else\n            {\n                // Production: JSON format for log aggregation\n                loggerConfiguration.WriteTo.Console(new CompactJsonFormatter());\n            }\n\n            // Optional: Seq for local development\n            var seqUrl = context.Configuration[\"Seq:ServerUrl\"];\n            if (!string.IsNullOrEmpty(seqUrl))\n            {\n                loggerConfiguration.WriteTo.Seq(seqUrl);\n            }\n        });\n    }\n}\n```\n\n**CorrelationIdMiddleware.cs**:\n```csharp\nusing System.Diagnostics;\nusing Serilog.Context;\n\nnamespace {{Namespace}}.Infrastructure.Observability.Logging;\n\npublic class CorrelationIdMiddleware\n{\n    private const string CorrelationIdHeader = \"X-Correlation-Id\";\n    private readonly RequestDelegate _next;\n\n    public CorrelationIdMiddleware(RequestDelegate next)\n    {\n        _next = next;\n    }\n\n    public async Task InvokeAsync(HttpContext context)\n    {\n        var correlationId = GetOrCreateCorrelationId(context);\n\n        // Add to response headers\n        context.Response.OnStarting(() =>\n        {\n            context.Response.Headers[CorrelationIdHeader] = correlationId;\n            return Task.CompletedTask;\n        });\n\n        // Add to log context\n        using (LogContext.PushProperty(\"CorrelationId\", correlationId))\n        {\n            // Add to Activity for distributed tracing\n            Activity.Current?.SetTag(\"correlation.id\", correlationId);\n\n            await _next(context);\n        }\n    }\n\n    private static string GetOrCreateCorrelationId(HttpContext context)\n    {\n        if (context.Request.Headers.TryGetValue(CorrelationIdHeader, out var correlationId)\n            && !string.IsNullOrEmpty(correlationId))\n        {\n            return correlationId.ToString();\n        }\n\n        return Activity.Current?.TraceId.ToString() ?? Guid.NewGuid().ToString();\n    }\n}\n\npublic static class CorrelationIdMiddlewareExtensions\n{\n    public static IApplicationBuilder UseCorrelationId(this IApplicationBuilder builder)\n    {\n        return builder.UseMiddleware<CorrelationIdMiddleware>();\n    }\n}\n```\n\n### 4. Generate Tracing Configuration\n\n**TracingExtensions.cs**:\n```csharp\nusing OpenTelemetry.Resources;\nusing OpenTelemetry.Trace;\n\nnamespace {{Namespace}}.Infrastructure.Observability.Tracing;\n\npublic static class TracingExtensions\n{\n    public static IServiceCollection AddDistributedTracing(\n        this IServiceCollection services,\n        IConfiguration configuration)\n    {\n        var serviceName = configuration[\"OpenTelemetry:ServiceName\"] ?? \"{{ProjectName}}\";\n        var serviceVersion = configuration[\"OpenTelemetry:ServiceVersion\"] ?? \"1.0.0\";\n        var otlpEndpoint = configuration[\"OpenTelemetry:OtlpEndpoint\"];\n\n        services.AddOpenTelemetry()\n            .ConfigureResource(resource => resource\n                .AddService(\n                    serviceName: serviceName,\n                    serviceVersion: serviceVersion)\n                .AddAttributes(new Dictionary<string, object>\n                {\n                    [\"deployment.environment\"] = configuration[\"ASPNETCORE_ENVIRONMENT\"] ?? \"Development\"\n                }))\n            .WithTracing(tracing =>\n            {\n                tracing\n                    .AddSource(serviceName)\n                    .AddAspNetCoreInstrumentation(options =>\n                    {\n                        options.RecordException = true;\n                        options.Filter = context =>\n                            !context.Request.Path.StartsWithSegments(\"/health\") &&\n                            !context.Request.Path.StartsWithSegments(\"/metrics\");\n                    })\n                    .AddHttpClientInstrumentation(options =>\n                    {\n                        options.RecordException = true;\n                    })\n                    .AddEntityFrameworkCoreInstrumentation(options =>\n                    {\n                        options.SetDbStatementForText = true;\n                        options.SetDbStatementForStoredProcedure = true;\n                    });\n\n                // Configure exporter\n                if (!string.IsNullOrEmpty(otlpEndpoint))\n                {\n                    tracing.AddOtlpExporter(options =>\n                    {\n                        options.Endpoint = new Uri(otlpEndpoint);\n                    });\n                }\n                else\n                {\n                    tracing.AddConsoleExporter();\n                }\n            });\n\n        return services;\n    }\n}\n```\n\n### 5. Generate Metrics Configuration\n\n**MetricsExtensions.cs**:\n```csharp\nusing OpenTelemetry.Metrics;\n\nnamespace {{Namespace}}.Infrastructure.Observability.Metrics;\n\npublic static class MetricsExtensions\n{\n    public static IServiceCollection AddApplicationMetrics(\n        this IServiceCollection services,\n        IConfiguration configuration)\n    {\n        var serviceName = configuration[\"OpenTelemetry:ServiceName\"] ?? \"{{ProjectName}}\";\n\n        services.AddSingleton<ApplicationMetrics>();\n\n        services.AddOpenTelemetry()\n            .WithMetrics(metrics =>\n            {\n                metrics\n                    .AddMeter(serviceName)\n                    .AddAspNetCoreInstrumentation()\n                    .AddHttpClientInstrumentation()\n                    .AddRuntimeInstrumentation()\n                    .AddProcessInstrumentation()\n                    .AddPrometheusExporter();\n            });\n\n        return services;\n    }\n}\n```\n\n**ApplicationMetrics.cs**:\n```csharp\nusing System.Diagnostics.Metrics;\n\nnamespace {{Namespace}}.Infrastructure.Observability.Metrics;\n\npublic class ApplicationMetrics\n{\n    private readonly Counter<long> _requestsTotal;\n    private readonly Counter<long> _errorsTotal;\n    private readonly Histogram<double> _requestDuration;\n    private readonly Histogram<double> _dbQueryDuration;\n    private readonly ObservableGauge<int> _activeConnections;\n\n    private int _currentActiveConnections;\n\n    public ApplicationMetrics(IMeterFactory meterFactory)\n    {\n        var meter = meterFactory.Create(\"{{ProjectName}}.Metrics\");\n\n        _requestsTotal = meter.CreateCounter<long>(\n            \"app_requests_total\",\n            description: \"Total number of requests processed\");\n\n        _errorsTotal = meter.CreateCounter<long>(\n            \"app_errors_total\",\n            description: \"Total number of errors\");\n\n        _requestDuration = meter.CreateHistogram<double>(\n            \"app_request_duration_seconds\",\n            unit: \"s\",\n            description: \"Request duration in seconds\");\n\n        _dbQueryDuration = meter.CreateHistogram<double>(\n            \"app_db_query_duration_seconds\",\n            unit: \"s\",\n            description: \"Database query duration in seconds\");\n\n        _activeConnections = meter.CreateObservableGauge(\n            \"app_active_connections\",\n            () => _currentActiveConnections,\n            description: \"Number of active connections\");\n    }\n\n    public void RecordRequest(string endpoint, string method, int statusCode, double durationSeconds)\n    {\n        var tags = new TagList\n        {\n            { \"endpoint\", endpoint },\n            { \"method\", method },\n            { \"status_code\", statusCode.ToString() }\n        };\n\n        _requestsTotal.Add(1, tags);\n        _requestDuration.Record(durationSeconds, tags);\n\n        if (statusCode >= 500)\n        {\n            _errorsTotal.Add(1, new TagList { { \"type\", \"server_error\" } });\n        }\n        else if (statusCode >= 400)\n        {\n            _errorsTotal.Add(1, new TagList { { \"type\", \"client_error\" } });\n        }\n    }\n\n    public void RecordDatabaseQuery(string operation, double durationSeconds)\n    {\n        _dbQueryDuration.Record(durationSeconds, new TagList { { \"operation\", operation } });\n    }\n\n    public void IncrementActiveConnections() => Interlocked.Increment(ref _currentActiveConnections);\n    public void DecrementActiveConnections() => Interlocked.Decrement(ref _currentActiveConnections);\n}\n```\n\n### 6. Generate Health Check Configuration\n\n**HealthCheckExtensions.cs**:\n```csharp\nusing HealthChecks.UI.Client;\nusing Microsoft.AspNetCore.Diagnostics.HealthChecks;\nusing Microsoft.Extensions.Diagnostics.HealthChecks;\n\nnamespace {{Namespace}}.Infrastructure.Observability.HealthChecks;\n\npublic static class HealthCheckExtensions\n{\n    public static IServiceCollection AddApplicationHealthChecks(\n        this IServiceCollection services,\n        IConfiguration configuration)\n    {\n        var healthChecksBuilder = services.AddHealthChecks();\n\n        // Self check (always healthy)\n        healthChecksBuilder.AddCheck(\"self\", () => HealthCheckResult.Healthy(), tags: new[] { \"live\" });\n\n        // Database check\n        var connectionString = configuration.GetConnectionString(\"DefaultConnection\");\n        if (!string.IsNullOrEmpty(connectionString))\n        {\n            healthChecksBuilder.AddNpgSql(\n                connectionString,\n                name: \"database\",\n                tags: new[] { \"ready\", \"db\" });\n        }\n\n        // Redis check\n        var redisConnection = configuration.GetConnectionString(\"Redis\");\n        if (!string.IsNullOrEmpty(redisConnection))\n        {\n            healthChecksBuilder.AddRedis(\n                redisConnection,\n                name: \"redis\",\n                tags: new[] { \"ready\", \"cache\" });\n        }\n\n        return services;\n    }\n\n    public static IApplicationBuilder UseApplicationHealthChecks(this IApplicationBuilder app)\n    {\n        // Kubernetes liveness probe\n        app.UseHealthChecks(\"/health/live\", new HealthCheckOptions\n        {\n            Predicate = check => check.Tags.Contains(\"live\"),\n            ResponseWriter = UIResponseWriter.WriteHealthCheckUIResponse\n        });\n\n        // Kubernetes readiness probe\n        app.UseHealthChecks(\"/health/ready\", new HealthCheckOptions\n        {\n            Predicate = check => check.Tags.Contains(\"ready\"),\n            ResponseWriter = UIResponseWriter.WriteHealthCheckUIResponse\n        });\n\n        // Full health status\n        app.UseHealthChecks(\"/health\", new HealthCheckOptions\n        {\n            ResponseWriter = UIResponseWriter.WriteHealthCheckUIResponse\n        });\n\n        return app;\n    }\n}\n```\n\n### 7. Update Program.cs\n\nAdd to Program.cs:\n```csharp\nusing {{Namespace}}.Infrastructure.Observability.Logging;\nusing {{Namespace}}.Infrastructure.Observability.Tracing;\nusing {{Namespace}}.Infrastructure.Observability.Metrics;\nusing {{Namespace}}.Infrastructure.Observability.HealthChecks;\n\nvar builder = WebApplication.CreateBuilder(args);\n\n// Configure structured logging\nbuilder.Host.UseStructuredLogging();\n\n// Add observability\nbuilder.Services.AddDistributedTracing(builder.Configuration);\nbuilder.Services.AddApplicationMetrics(builder.Configuration);\nbuilder.Services.AddApplicationHealthChecks(builder.Configuration);\n\nvar app = builder.Build();\n\n// Use observability middleware\napp.UseCorrelationId();\napp.UseSerilogRequestLogging();\n\n// Health checks\napp.UseApplicationHealthChecks();\n\n// Prometheus metrics endpoint\napp.MapPrometheusScrapingEndpoint();\n```\n\n### 8. Update appsettings.json\n\n```json\n{\n  \"OpenTelemetry\": {\n    \"ServiceName\": \"{{ProjectName}}\",\n    \"ServiceVersion\": \"1.0.0\",\n    \"OtlpEndpoint\": \"http://otel-collector:4317\"\n  },\n  \"Seq\": {\n    \"ServerUrl\": \"http://localhost:5341\"\n  },\n  \"Serilog\": {\n    \"MinimumLevel\": {\n      \"Default\": \"Information\",\n      \"Override\": {\n        \"Microsoft\": \"Warning\",\n        \"Microsoft.Hosting.Lifetime\": \"Information\",\n        \"Microsoft.EntityFrameworkCore\": \"Warning\",\n        \"System\": \"Warning\"\n      }\n    }\n  }\n}\n```\n\n## Output\n\n```markdown\n## Observability Stack Added\n\n### Files Created\n**Infrastructure Layer:**\n- Observability/Logging/LoggingExtensions.cs\n- Observability/Logging/CorrelationIdMiddleware.cs\n- Observability/Tracing/TracingExtensions.cs\n- Observability/Metrics/MetricsExtensions.cs\n- Observability/Metrics/ApplicationMetrics.cs\n- Observability/HealthChecks/HealthCheckExtensions.cs\n\n### NuGet Packages Added\n- Serilog.AspNetCore\n- OpenTelemetry.*\n- AspNetCore.HealthChecks.*\n\n### Endpoints\n| Endpoint | Purpose |\n|----------|---------|\n| /health | Full health status |\n| /health/live | Kubernetes liveness probe |\n| /health/ready | Kubernetes readiness probe |\n| /metrics | Prometheus metrics |\n\n### Configuration Required\nUpdate appsettings.json with OpenTelemetry and Serilog settings.\n\n### Observability Stack\n- **Logging**: Serilog with structured JSON output\n- **Tracing**: OpenTelemetry with OTLP export\n- **Metrics**: Prometheus-compatible metrics\n- **Health**: Kubernetes-ready health checks\n\n### Local Development\n```bash\n# Start observability stack\ndocker-compose -f docker-compose.observability.yml up -d\n\n# Services:\n# - Jaeger: http://localhost:16686\n# - Prometheus: http://localhost:9090\n# - Grafana: http://localhost:3000\n# - Seq: http://localhost:5341\n```\n```\n\n## Example\n\n```\nUser: /add-observability --logging serilog --tracing otlp --metrics --health-checks --story ACF-070\n\nClaude: Adding comprehensive observability stack...\n\nCreating logging infrastructure:\n1. Serilog with structured logging\n2. Correlation ID middleware\n3. Request logging enrichment\n\nCreating tracing:\n4. OpenTelemetry with OTLP exporter\n5. ASP.NET Core instrumentation\n6. EF Core instrumentation\n\nCreating metrics:\n7. Prometheus exporter\n8. Custom application metrics\n9. Runtime metrics\n\nCreating health checks:\n10. Liveness and readiness probes\n11. Database health check\n12. Redis health check\n\nObservability stack added successfully.\n\nEndpoints:\n- /health/live - Liveness probe\n- /health/ready - Readiness probe\n- /metrics - Prometheus metrics\n```\n"
    },
    "add-mobile-service": {
      "prompt": "# /add-mobile-service - Add API Service\n\nCreate an API service with TanStack Query hooks for React Native.\n\n## Usage\n```\n/add-mobile-service <EntityName> [base-path] [options]\n```\n\nExamples:\n- `/add-mobile-service Product /products`\n- `/add-mobile-service Order /orders --crud`\n- `/add-mobile-service User /users --auth-required`\n- `/add-mobile-service Cart /cart --optimistic`\n\nOptions:\n- `--crud` - Generate full CRUD operations\n- `--auth-required` - Include auth token in requests\n- `--optimistic` - Add optimistic update patterns\n- `--paginated` - Add pagination support\n- `--story <ACF-###>` - Link to story ID\n\n## Instructions\n\nWhen invoked:\n\n### 1. Parse Service Information\n\nExtract:\n- Entity name (singular, PascalCase)\n- Base API path\n- Operations needed\n- Special patterns (optimistic, pagination)\n\n### 2. Generate Type Definitions\n\n```typescript\n// types/<entity>.types.ts\nexport interface <Entity> {\n  id: string;\n  // Add entity properties\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface Create<Entity>Dto {\n  // Create payload\n}\n\nexport interface Update<Entity>Dto {\n  // Update payload (Partial<Create>)\n}\n\nexport interface <Entity>ListParams {\n  page?: number;\n  limit?: number;\n  search?: string;\n  sortBy?: string;\n  sortOrder?: 'asc' | 'desc';\n}\n\nexport interface <Entity>ListResponse {\n  data: <Entity>[];\n  meta: {\n    total: number;\n    page: number;\n    limit: number;\n    totalPages: number;\n  };\n}\n```\n\n### 3. Generate Service Functions\n\n```typescript\n// services/api/<entity>Service.ts\nimport { apiClient } from './apiClient';\nimport type {\n  <Entity>,\n  Create<Entity>Dto,\n  Update<Entity>Dto,\n  <Entity>ListParams,\n  <Entity>ListResponse,\n} from '@/types/<entity>.types';\n\nexport const <entity>Service = {\n  // List with pagination\n  async getAll(params?: <Entity>ListParams): Promise<<Entity>ListResponse> {\n    const { data } = await apiClient.get('/<entities>', { params });\n    return data;\n  },\n\n  // Get by ID\n  async getById(id: string): Promise<<Entity>> {\n    const { data } = await apiClient.get(`/<entities>/${id}`);\n    return data;\n  },\n\n  // Create\n  async create(dto: Create<Entity>Dto): Promise<<Entity>> {\n    const { data } = await apiClient.post('/<entities>', dto);\n    return data;\n  },\n\n  // Update\n  async update(id: string, dto: Update<Entity>Dto): Promise<<Entity>> {\n    const { data } = await apiClient.patch(`/<entities>/${id}`, dto);\n    return data;\n  },\n\n  // Delete\n  async delete(id: string): Promise<void> {\n    await apiClient.delete(`/<entities>/${id}`);\n  },\n};\n```\n\n### 4. Generate TanStack Query Hooks\n\n```typescript\n// hooks/api/use<Entity>.ts\nimport {\n  useQuery,\n  useMutation,\n  useQueryClient,\n  useInfiniteQuery,\n} from '@tanstack/react-query';\nimport { <entity>Service } from '@/services/api/<entity>Service';\nimport type {\n  <Entity>,\n  Create<Entity>Dto,\n  Update<Entity>Dto,\n  <Entity>ListParams,\n} from '@/types/<entity>.types';\n\n// Query Keys\nexport const <entity>Keys = {\n  all: ['<entities>'] as const,\n  lists: () => [...<entity>Keys.all, 'list'] as const,\n  list: (params?: <Entity>ListParams) => [...<entity>Keys.lists(), params] as const,\n  details: () => [...<entity>Keys.all, 'detail'] as const,\n  detail: (id: string) => [...<entity>Keys.details(), id] as const,\n};\n\n// List Hook\nexport function use<Entity>List(params?: <Entity>ListParams) {\n  return useQuery({\n    queryKey: <entity>Keys.list(params),\n    queryFn: () => <entity>Service.getAll(params),\n  });\n}\n\n// Infinite List Hook (for pagination)\nexport function use<Entity>InfiniteList(params?: Omit<<Entity>ListParams, 'page'>) {\n  return useInfiniteQuery({\n    queryKey: <entity>Keys.list(params),\n    queryFn: ({ pageParam = 1 }) =>\n      <entity>Service.getAll({ ...params, page: pageParam }),\n    getNextPageParam: (lastPage) =>\n      lastPage.meta.page < lastPage.meta.totalPages\n        ? lastPage.meta.page + 1\n        : undefined,\n    initialPageParam: 1,\n  });\n}\n\n// Detail Hook\nexport function use<Entity>(id: string) {\n  return useQuery({\n    queryKey: <entity>Keys.detail(id),\n    queryFn: () => <entity>Service.getById(id),\n    enabled: !!id,\n  });\n}\n\n// Create Mutation\nexport function useCreate<Entity>() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (dto: Create<Entity>Dto) => <entity>Service.create(dto),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: <entity>Keys.lists() });\n    },\n  });\n}\n\n// Update Mutation with Optimistic Updates\nexport function useUpdate<Entity>() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, dto }: { id: string; dto: Update<Entity>Dto }) =>\n      <entity>Service.update(id, dto),\n    onMutate: async ({ id, dto }) => {\n      // Cancel outgoing refetches\n      await queryClient.cancelQueries({ queryKey: <entity>Keys.detail(id) });\n\n      // Snapshot current value\n      const previous = queryClient.getQueryData<<Entity>>(<entity>Keys.detail(id));\n\n      // Optimistically update\n      queryClient.setQueryData<<Entity>>(<entity>Keys.detail(id), (old) =>\n        old ? { ...old, ...dto } : old\n      );\n\n      return { previous };\n    },\n    onError: (err, { id }, context) => {\n      // Rollback on error\n      if (context?.previous) {\n        queryClient.setQueryData(<entity>Keys.detail(id), context.previous);\n      }\n    },\n    onSettled: (_, __, { id }) => {\n      // Refetch to ensure consistency\n      queryClient.invalidateQueries({ queryKey: <entity>Keys.detail(id) });\n      queryClient.invalidateQueries({ queryKey: <entity>Keys.lists() });\n    },\n  });\n}\n\n// Delete Mutation\nexport function useDelete<Entity>() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (id: string) => <entity>Service.delete(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: <entity>Keys.lists() });\n    },\n  });\n}\n```\n\n### 5. Generate Tests\n\n```typescript\n// hooks/api/__tests__/use<Entity>.test.ts\nimport { renderHook, waitFor } from '@testing-library/react-native';\nimport { createWrapper } from '@/test/utils';\nimport { use<Entity>List, use<Entity>, useCreate<Entity> } from '../use<Entity>';\nimport { server } from '@/mocks/server';\nimport { rest } from 'msw';\n\ndescribe('use<Entity> hooks', () => {\n  describe('use<Entity>List', () => {\n    it('fetches <entities> successfully', async () => {\n      const { result } = renderHook(() => use<Entity>List(), {\n        wrapper: createWrapper(),\n      });\n\n      await waitFor(() => expect(result.current.isSuccess).toBe(true));\n\n      expect(result.current.data?.data).toHaveLength(3);\n    });\n  });\n\n  describe('use<Entity>', () => {\n    it('fetches single <entity>', async () => {\n      const { result } = renderHook(() => use<Entity>('1'), {\n        wrapper: createWrapper(),\n      });\n\n      await waitFor(() => expect(result.current.isSuccess).toBe(true));\n\n      expect(result.current.data?.id).toBe('1');\n    });\n  });\n\n  describe('useCreate<Entity>', () => {\n    it('creates <entity> and invalidates list', async () => {\n      const { result } = renderHook(() => useCreate<Entity>(), {\n        wrapper: createWrapper(),\n      });\n\n      await result.current.mutateAsync({ /* dto */ });\n\n      expect(result.current.isSuccess).toBe(true);\n    });\n  });\n});\n```\n\n## Output\n\n```markdown\n## Service Created: <Entity>Service\n\n### Files Created\n- `types/<entity>.types.ts` - TypeScript interfaces\n- `services/api/<entity>Service.ts` - API functions\n- `hooks/api/use<Entity>.ts` - TanStack Query hooks\n- `hooks/api/__tests__/use<Entity>.test.ts` - Tests\n- `mocks/handlers/<entity>.ts` - MSW handlers (if testing)\n\n### Available Hooks\n- `use<Entity>List(params?)` - Fetch paginated list\n- `use<Entity>(id)` - Fetch single entity\n- `useCreate<Entity>()` - Create mutation\n- `useUpdate<Entity>()` - Update mutation (optimistic)\n- `useDelete<Entity>()` - Delete mutation\n\n### Query Keys\n- `<entity>Keys.all` - All <entity> queries\n- `<entity>Keys.list(params)` - List queries\n- `<entity>Keys.detail(id)` - Detail queries\n\n### Usage Example\n```typescript\nimport { use<Entity>List, useCreate<Entity> } from '@/hooks/api/use<Entity>';\n\nfunction <Entity>ListScreen() {\n  const { data, isLoading } = use<Entity>List();\n  const createMutation = useCreate<Entity>();\n\n  const handleCreate = async () => {\n    await createMutation.mutateAsync({ /* dto */ });\n  };\n}\n```\n```\n\n## Example\n\n```\nUser: /add-mobile-service Product /products --crud --optimistic\n\nClaude: Creating Product service with CRUD operations...\n\nFiles created:\n- types/product.types.ts\n- services/api/productService.ts\n- hooks/api/useProduct.ts\n- hooks/api/__tests__/useProduct.test.ts\n\nAvailable hooks:\n- useProductList() - with pagination\n- useProduct(id) - single product\n- useCreateProduct() - create mutation\n- useUpdateProduct() - with optimistic updates\n- useDeleteProduct() - delete mutation\n```\n"
    },
    "add-mobile-screen": {
      "prompt": "# /add-mobile-screen - Add React Native Screen\n\nScaffold a new Expo Router screen with observability and design system integration.\n\n## Usage\n```\n/add-mobile-screen <ScreenName> [route-path] [options]\n```\n\nExamples:\n- `/add-mobile-screen ProductDetail /products/[id]`\n- `/add-mobile-screen Settings /settings`\n- `/add-mobile-screen OrderHistory /(tabs)/orders`\n- `/add-mobile-screen Login /(auth)/login --minimal`\n\nOptions:\n- `--minimal` - Basic screen without data fetching\n- `--list` - Include FlatList pattern\n- `--form` - Include form with validation\n- `--protected` - Require authentication\n- `--story <ACF-###>` - Link to story ID\n\n## Instructions\n\nWhen invoked:\n\n### 1. Parse Screen Information\n\nExtract:\n- Screen name (PascalCase)\n- Route path (determines file location)\n- Screen type (minimal, list, form)\n- Auth requirement\n\n### 2. Determine File Location\n\nMap route path to Expo Router file structure:\n\n| Route Path | File Location |\n|------------|---------------|\n| `/products/[id]` | `app/products/[id].tsx` |\n| `/(tabs)/orders` | `app/(tabs)/orders.tsx` |\n| `/(auth)/login` | `app/(auth)/login.tsx` |\n| `/settings/profile` | `app/settings/profile.tsx` |\n\n### 3. Generate Screen Component\n\n**Standard Screen Template**:\n```typescript\n// app/<route-path>.tsx\nimport { View, Text, StyleSheet } from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { Stack, useLocalSearchParams } from 'expo-router';\nimport * as Sentry from '@sentry/react-native';\nimport { useTheme } from '@/theme';\nimport { useScreenTransaction } from '@/observability/useScreenTransaction';\nimport { ScreenErrorBoundary } from '@/observability/ErrorBoundary';\n\nexport default function <ScreenName>Screen() {\n  const { colors, spacing } = useTheme();\n  const params = useLocalSearchParams<{ id: string }>();\n  const { markInteractive } = useScreenTransaction('<ScreenName>');\n\n  // Track screen load\n  useEffect(() => {\n    markInteractive();\n  }, []);\n\n  return (\n    <ScreenErrorBoundary screenName=\"<ScreenName>\">\n      <SafeAreaView style={[styles.container, { backgroundColor: colors.background.primary }]}>\n        <Stack.Screen options={{ title: '<Screen Title>' }} />\n\n        {/* Screen content */}\n\n      </SafeAreaView>\n    </ScreenErrorBoundary>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n});\n```\n\n**List Screen Template** (`--list`):\n```typescript\nimport { FlatList, RefreshControl } from 'react-native';\nimport { useQuery } from '@tanstack/react-query';\n\nexport default function <ScreenName>Screen() {\n  const { data, isLoading, error, refetch, isRefetching } = use<Entity>List();\n\n  if (isLoading) return <LoadingSpinner />;\n  if (error) return <ErrorView error={error} onRetry={refetch} />;\n\n  return (\n    <SafeAreaView style={styles.container}>\n      <FlatList\n        data={data}\n        keyExtractor={(item) => item.id}\n        renderItem={({ item }) => <<Entity>Card item={item} />}\n        refreshControl={\n          <RefreshControl refreshing={isRefetching} onRefresh={refetch} />\n        }\n        contentContainerStyle={styles.list}\n        ItemSeparatorComponent={() => <View style={styles.separator} />}\n        ListEmptyComponent={<EmptyState message=\"No items found\" />}\n      />\n    </SafeAreaView>\n  );\n}\n```\n\n**Form Screen Template** (`--form`):\n```typescript\nimport { useForm, Controller } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\n\nconst schema = z.object({\n  // Define schema\n});\n\ntype FormData = z.infer<typeof schema>;\n\nexport default function <ScreenName>Screen() {\n  const { control, handleSubmit, formState: { errors, isSubmitting } } = useForm<FormData>({\n    resolver: zodResolver(schema),\n  });\n\n  const mutation = use<Action>Mutation();\n\n  const onSubmit = async (data: FormData) => {\n    try {\n      await mutation.mutateAsync(data);\n      router.back();\n    } catch (error) {\n      // Handle error\n    }\n  };\n\n  return (\n    <SafeAreaView style={styles.container}>\n      <KeyboardAvoidingView behavior={Platform.OS === 'ios' ? 'padding' : 'height'}>\n        <ScrollView contentContainerStyle={styles.form}>\n          <Controller\n            control={control}\n            name=\"fieldName\"\n            render={({ field: { onChange, value } }) => (\n              <Input\n                label=\"Field Label\"\n                value={value}\n                onChangeText={onChange}\n                error={errors.fieldName?.message}\n              />\n            )}\n          />\n\n          <Button\n            label=\"Submit\"\n            onPress={handleSubmit(onSubmit)}\n            loading={isSubmitting}\n          />\n        </ScrollView>\n      </KeyboardAvoidingView>\n    </SafeAreaView>\n  );\n}\n```\n\n### 4. Generate Supporting Files\n\n**For protected screens**:\n- Ensure parent layout has auth check\n- Add to protected route group\n\n**For list screens**:\n- Create corresponding query hook\n- Create list item component\n\n**For form screens**:\n- Create Zod schema\n- Create mutation hook\n\n### 5. Add Tests\n\n```typescript\n// __tests__/<ScreenName>.test.tsx\nimport { render, screen } from '@testing-library/react-native';\nimport { renderWithProviders } from '@/test/utils';\nimport <ScreenName>Screen from '../<route-path>';\n\ndescribe('<ScreenName>Screen', () => {\n  it('renders correctly', () => {\n    renderWithProviders(<<ScreenName>Screen />);\n    expect(screen.getByText('<Expected Text>')).toBeTruthy();\n  });\n\n  it('tracks screen load', () => {\n    renderWithProviders(<<ScreenName>Screen />);\n    expect(Sentry.startTransaction).toHaveBeenCalledWith({\n      name: '<ScreenName>',\n      op: 'ui.load',\n    });\n  });\n});\n```\n\n## Output\n\n```markdown\n## Screen Created: <ScreenName>\n\n### Files Created\n- `app/<route-path>.tsx` - Screen component\n- `components/features/<feature>/<Component>.tsx` - Supporting components\n- `hooks/api/use<Entity>.ts` - Data hooks (if needed)\n- `__tests__/<ScreenName>.test.tsx` - Tests\n\n### Route Information\n- Path: /<route>\n- Protected: Yes/No\n- Tab: (tabs)/<name> or None\n\n### Integration\n- Observability: Screen transaction + error boundary\n- Design System: Theme tokens used\n- State: [TanStack Query / Redux / Local]\n\n### Next Steps\n1. Implement business logic\n2. Connect to API\n3. Add accessibility labels\n4. Run tests: `npm test <ScreenName>`\n```\n\n## Example\n\n```\nUser: /add-mobile-screen ProductDetail /products/[id] --protected --story ACF-042\n\nClaude: Creating ProductDetail screen...\n\nFiles created:\n- app/products/[id].tsx\n- components/features/products/ProductDetailView.tsx\n- hooks/api/useProduct.ts\n- __tests__/ProductDetail.test.tsx\n\nScreen is protected and linked to ACF-042.\n\nRun `npm run ios` to test the new screen.\n```\n"
    },
    "add-mobile-observability": {
      "prompt": "# /add-mobile-observability - Add Observability\n\nAdd full Sentry observability stack to a React Native/Expo project.\n\n## Usage\n```\n/add-mobile-observability [options]\n```\n\nOptions:\n- `--dsn <dsn>` - Sentry DSN (will prompt if not provided)\n- `--performance` - Enable performance monitoring\n- `--replay` - Enable session replay\n- `--story <ACF-###>` - Link to story ID\n\n## Instructions\n\nWhen invoked:\n\n### 1. Install Dependencies\n\n```bash\nnpx expo install @sentry/react-native\n```\n\n### 2. Create Sentry Configuration\n\n```typescript\n// observability/sentry.config.ts\nimport * as Sentry from '@sentry/react-native';\nimport * as Application from 'expo-application';\nimport Constants from 'expo-constants';\n\nexport function initializeSentry() {\n  const dsn = Constants.expoConfig?.extra?.sentryDsn;\n\n  if (!dsn) {\n    console.warn('Sentry DSN not configured');\n    return;\n  }\n\n  Sentry.init({\n    dsn,\n\n    // Environment\n    environment: __DEV__ ? 'development' : 'production',\n\n    // Release tracking\n    release: `${Application.applicationId}@${Application.nativeApplicationVersion}+${Application.nativeBuildVersion}`,\n    dist: Application.nativeBuildVersion ?? undefined,\n\n    // Performance Monitoring\n    tracesSampleRate: __DEV__ ? 1.0 : 0.2,\n    profilesSampleRate: __DEV__ ? 1.0 : 0.1,\n\n    // Features\n    attachScreenshot: true,\n    attachStacktrace: true,\n    enableAutoSessionTracking: true,\n    enableNative: true,\n    enableNativeCrashHandling: true,\n\n    // Privacy\n    sendDefaultPii: false,\n\n    // Auto instrumentation\n    enableAutoPerformanceTracing: true,\n    enableNativeFramesTracking: true,\n\n    // Filtering\n    beforeSend: (event, hint) => {\n      // Filter out known non-issues\n      if (event.exception?.values?.[0]?.type === 'NetworkError') {\n        // Log network errors but don't send to Sentry\n        console.log('Network error:', hint.originalException);\n        return null;\n      }\n\n      // Don't send in development\n      if (__DEV__) {\n        console.log('Sentry event (dev):', event);\n        return null;\n      }\n\n      return event;\n    },\n\n    // Breadcrumb filtering\n    beforeBreadcrumb: (breadcrumb) => {\n      // Filter out noisy breadcrumbs\n      if (breadcrumb.category === 'console' && breadcrumb.level === 'debug') {\n        return null;\n      }\n      return breadcrumb;\n    },\n  });\n}\n\n// Helper to capture exceptions with context\nexport function captureError(\n  error: Error,\n  context?: Record<string, unknown>\n) {\n  Sentry.withScope((scope) => {\n    if (context) {\n      scope.setContext('additional', context);\n    }\n    Sentry.captureException(error);\n  });\n}\n```\n\n### 3. Create Error Boundaries\n\n```typescript\n// observability/ErrorBoundary.tsx\nimport React, { Component, ReactNode } from 'react';\nimport { View, Text, Button, StyleSheet } from 'react-native';\nimport * as Sentry from '@sentry/react-native';\nimport { ErrorBoundary as SentryErrorBoundary } from '@sentry/react-native';\n\n// Root Error Boundary\nexport function RootErrorBoundary({ children }: { children: ReactNode }) {\n  return (\n    <SentryErrorBoundary\n      fallback={({ error, resetError }) => (\n        <CrashScreen error={error} onRetry={resetError} />\n      )}\n      onError={(error, componentStack) => {\n        Sentry.withScope((scope) => {\n          scope.setTag('error.boundary', 'root');\n          scope.setTag('error.fatal', 'true');\n          scope.setContext('react', { componentStack });\n        });\n      }}\n    >\n      {children}\n    </SentryErrorBoundary>\n  );\n}\n\n// Screen Error Boundary\ninterface ScreenErrorBoundaryProps {\n  screenName: string;\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\ninterface ScreenErrorBoundaryState {\n  hasError: boolean;\n  error: Error | null;\n}\n\nexport class ScreenErrorBoundary extends Component<\n  ScreenErrorBoundaryProps,\n  ScreenErrorBoundaryState\n> {\n  state: ScreenErrorBoundaryState = { hasError: false, error: null };\n\n  static getDerivedStateFromError(error: Error) {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    Sentry.withScope((scope) => {\n      scope.setTag('error.boundary', 'screen');\n      scope.setTag('screen.name', this.props.screenName);\n      scope.setContext('react', { componentStack: errorInfo.componentStack });\n      Sentry.captureException(error);\n    });\n  }\n\n  handleRetry = () => {\n    this.setState({ hasError: false, error: null });\n  };\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        this.props.fallback ?? (\n          <ScreenErrorFallback\n            error={this.state.error}\n            onRetry={this.handleRetry}\n          />\n        )\n      );\n    }\n    return this.props.children;\n  }\n}\n\n// Crash Screen Component\nfunction CrashScreen({\n  error,\n  onRetry,\n}: {\n  error: Error;\n  onRetry: () => void;\n}) {\n  return (\n    <View style={styles.container}>\n      <Text style={styles.title}>Something went wrong</Text>\n      <Text style={styles.message}>\n        We've been notified and are working on a fix.\n      </Text>\n      <Button title=\"Try Again\" onPress={onRetry} />\n    </View>\n  );\n}\n\n// Screen Error Fallback\nfunction ScreenErrorFallback({\n  error,\n  onRetry,\n}: {\n  error: Error | null;\n  onRetry: () => void;\n}) {\n  return (\n    <View style={styles.screenError}>\n      <Text style={styles.errorTitle}>Unable to load</Text>\n      <Text style={styles.errorMessage}>\n        There was a problem loading this screen.\n      </Text>\n      <Button title=\"Retry\" onPress={onRetry} />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 24,\n    backgroundColor: '#FFFFFF',\n  },\n  title: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    marginBottom: 12,\n  },\n  message: {\n    fontSize: 16,\n    textAlign: 'center',\n    marginBottom: 24,\n    color: '#666',\n  },\n  screenError: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 24,\n  },\n  errorTitle: {\n    fontSize: 18,\n    fontWeight: '600',\n    marginBottom: 8,\n  },\n  errorMessage: {\n    fontSize: 14,\n    color: '#666',\n    marginBottom: 16,\n  },\n});\n```\n\n### 4. Create Performance Hooks\n\n```typescript\n// observability/useScreenTransaction.ts\nimport { useEffect, useRef, useCallback } from 'react';\nimport * as Sentry from '@sentry/react-native';\n\nexport function useScreenTransaction(screenName: string) {\n  const transactionRef = useRef<ReturnType<typeof Sentry.startTransaction> | null>(null);\n  const startTime = useRef(performance.now());\n\n  useEffect(() => {\n    transactionRef.current = Sentry.startTransaction({\n      name: screenName,\n      op: 'ui.load',\n    });\n\n    return () => {\n      transactionRef.current?.finish();\n    };\n  }, [screenName]);\n\n  const startSpan = useCallback(\n    (name: string, op: string) => {\n      return transactionRef.current?.startChild({\n        op,\n        description: name,\n      });\n    },\n    []\n  );\n\n  const markInteractive = useCallback(() => {\n    const tti = performance.now() - startTime.current;\n    Sentry.setMeasurement('time_to_interactive', tti, 'millisecond');\n\n    Sentry.addBreadcrumb({\n      category: 'ui.lifecycle',\n      message: `${screenName} became interactive`,\n      level: 'info',\n      data: { tti },\n    });\n  }, [screenName]);\n\n  return { startSpan, markInteractive };\n}\n```\n\n### 5. Create Breadcrumb Hooks\n\n```typescript\n// observability/useBreadcrumbs.ts\nimport { useCallback } from 'react';\nimport * as Sentry from '@sentry/react-native';\n\nexport function useBreadcrumbs() {\n  const trackAction = useCallback(\n    (action: string, data?: Record<string, unknown>) => {\n      Sentry.addBreadcrumb({\n        category: 'user.action',\n        message: action,\n        level: 'info',\n        data: {\n          ...data,\n          timestamp: new Date().toISOString(),\n        },\n      });\n    },\n    []\n  );\n\n  const trackNavigation = useCallback(\n    (from: string, to: string) => {\n      Sentry.addBreadcrumb({\n        category: 'navigation',\n        message: `Navigate from ${from} to ${to}`,\n        level: 'info',\n        data: { from, to },\n      });\n    },\n    []\n  );\n\n  const trackStateChange = useCallback(\n    (stateName: string, oldValue: unknown, newValue: unknown) => {\n      Sentry.addBreadcrumb({\n        category: 'state.change',\n        message: `${stateName} changed`,\n        level: 'info',\n        data: { stateName, oldValue, newValue },\n      });\n    },\n    []\n  );\n\n  const trackNetworkRequest = useCallback(\n    (method: string, url: string, status: number, duration: number) => {\n      Sentry.addBreadcrumb({\n        category: 'http',\n        message: `${method} ${url}`,\n        level: status >= 400 ? 'warning' : 'info',\n        data: { method, url, status, duration },\n      });\n    },\n    []\n  );\n\n  return {\n    trackAction,\n    trackNavigation,\n    trackStateChange,\n    trackNetworkRequest,\n  };\n}\n```\n\n### 6. Create Navigation Tracking\n\n```typescript\n// observability/navigationTracking.ts\nimport { useEffect } from 'react';\nimport { usePathname, useSegments } from 'expo-router';\nimport * as Sentry from '@sentry/react-native';\n\nexport function useNavigationTracking() {\n  const pathname = usePathname();\n  const segments = useSegments();\n\n  useEffect(() => {\n    const routeName = segments.join('/') || 'index';\n\n    Sentry.addBreadcrumb({\n      category: 'navigation',\n      message: `Navigated to ${routeName}`,\n      level: 'info',\n      data: {\n        pathname,\n        segments,\n        timestamp: new Date().toISOString(),\n      },\n    });\n\n    // Set current route as Sentry tag for context\n    Sentry.setTag('route', routeName);\n  }, [pathname, segments]);\n}\n```\n\n### 7. Update App Config for Source Maps\n\n```typescript\n// app.config.ts\nexport default {\n  expo: {\n    // ... other config\n    plugins: [\n      [\n        '@sentry/react-native/expo',\n        {\n          organization: process.env.SENTRY_ORG,\n          project: process.env.SENTRY_PROJECT,\n          url: 'https://sentry.io/',\n        },\n      ],\n    ],\n    extra: {\n      sentryDsn: process.env.SENTRY_DSN,\n    },\n  },\n};\n```\n\n### 8. Update EAS Configuration\n\n```json\n// eas.json\n{\n  \"build\": {\n    \"production\": {\n      \"env\": {\n        \"SENTRY_AUTH_TOKEN\": \"@sentry-auth-token\"\n      }\n    }\n  }\n}\n```\n\n### 9. Create Test Utilities\n\n```typescript\n// observability/testUtils.ts\nimport * as Sentry from '@sentry/react-native';\n\nexport const crashTests = {\n  jsError: () => {\n    throw new Error('Test JS error');\n  },\n\n  nativeCrash: () => {\n    Sentry.nativeCrash();\n  },\n\n  sendTestEvent: () => {\n    Sentry.captureMessage('Test event from mobile app', 'info');\n  },\n\n  testBreadcrumbs: () => {\n    Sentry.addBreadcrumb({\n      category: 'test',\n      message: 'Test breadcrumb',\n      level: 'info',\n    });\n    Sentry.captureMessage('Test with breadcrumbs', 'info');\n  },\n};\n```\n\n## Output\n\n```markdown\n## Observability Added\n\n### Files Created\n- `observability/sentry.config.ts` - Sentry initialization\n- `observability/ErrorBoundary.tsx` - Error boundary components\n- `observability/useScreenTransaction.ts` - Screen performance hook\n- `observability/useBreadcrumbs.ts` - Breadcrumb tracking hook\n- `observability/navigationTracking.ts` - Navigation tracking\n- `observability/testUtils.ts` - Test utilities\n\n### Files Modified\n- `app.config.ts` - Added Sentry plugin\n- `app/_layout.tsx` - Added initialization\n- `eas.json` - Added Sentry auth token\n\n### Environment Variables Required\n```\nSENTRY_DSN=https://xxx@xxx.ingest.sentry.io/xxx\nSENTRY_ORG=your-org\nSENTRY_PROJECT=your-project\nSENTRY_AUTH_TOKEN=your-auth-token\n```\n\n### Usage\n```typescript\n// In screens\nimport { useScreenTransaction } from '@/observability/useScreenTransaction';\n\nfunction MyScreen() {\n  const { markInteractive } = useScreenTransaction('MyScreen');\n\n  useEffect(() => {\n    // After content loads\n    markInteractive();\n  }, []);\n}\n```\n\n### Verification\nRun test crash in development:\n```typescript\nimport { crashTests } from '@/observability/testUtils';\ncrashTests.sendTestEvent(); // Check Sentry dashboard\n```\n```\n"
    },
    "add-mobile-auth": {
      "prompt": "# /add-mobile-auth - Add Authentication\n\nAdd JWT authentication to a React Native/Expo project.\n\n## Usage\n```\n/add-mobile-auth [options]\n```\n\nOptions:\n- `--social` - Include social auth (Google, Apple)\n- `--biometric` - Include biometric authentication\n- `--mfa` - Include multi-factor authentication support\n- `--story <ACF-###>` - Link to story ID\n\n## Instructions\n\nWhen invoked:\n\n### 1. Create Auth Storage\n\n```typescript\n// services/auth/authStorage.ts\nimport * as SecureStore from 'expo-secure-store';\n\nconst STORAGE_KEYS = {\n  ACCESS_TOKEN: 'auth_access_token',\n  REFRESH_TOKEN: 'auth_refresh_token',\n  USER: 'auth_user',\n} as const;\n\nexport interface AuthTokens {\n  accessToken: string;\n  refreshToken: string;\n  expiresAt: number;\n}\n\nexport const authStorage = {\n  // Access Token\n  async getAccessToken(): Promise<string | null> {\n    return SecureStore.getItemAsync(STORAGE_KEYS.ACCESS_TOKEN);\n  },\n\n  async setAccessToken(token: string): Promise<void> {\n    await SecureStore.setItemAsync(STORAGE_KEYS.ACCESS_TOKEN, token);\n  },\n\n  // Refresh Token\n  async getRefreshToken(): Promise<string | null> {\n    return SecureStore.getItemAsync(STORAGE_KEYS.REFRESH_TOKEN);\n  },\n\n  async setRefreshToken(token: string): Promise<void> {\n    await SecureStore.setItemAsync(STORAGE_KEYS.REFRESH_TOKEN, token);\n  },\n\n  // Set both tokens\n  async setTokens(tokens: AuthTokens): Promise<void> {\n    await Promise.all([\n      this.setAccessToken(tokens.accessToken),\n      this.setRefreshToken(tokens.refreshToken),\n    ]);\n  },\n\n  // Clear all auth data\n  async clearAll(): Promise<void> {\n    await Promise.all([\n      SecureStore.deleteItemAsync(STORAGE_KEYS.ACCESS_TOKEN),\n      SecureStore.deleteItemAsync(STORAGE_KEYS.REFRESH_TOKEN),\n      SecureStore.deleteItemAsync(STORAGE_KEYS.USER),\n    ]);\n  },\n};\n```\n\n### 2. Create Auth Service\n\n```typescript\n// services/auth/authService.ts\nimport { apiClient } from '@/services/api/apiClient';\nimport { authStorage, AuthTokens } from './authStorage';\nimport type { User, LoginCredentials, RegisterData } from '@/types/auth.types';\n\nexport interface AuthResponse {\n  user: User;\n  tokens: AuthTokens;\n}\n\nexport const authService = {\n  async login(credentials: LoginCredentials): Promise<AuthResponse> {\n    const { data } = await apiClient.post<AuthResponse>('/auth/login', credentials);\n    await authStorage.setTokens(data.tokens);\n    return data;\n  },\n\n  async register(data: RegisterData): Promise<AuthResponse> {\n    const { data: response } = await apiClient.post<AuthResponse>('/auth/register', data);\n    await authStorage.setTokens(response.tokens);\n    return response;\n  },\n\n  async logout(): Promise<void> {\n    try {\n      await apiClient.post('/auth/logout');\n    } finally {\n      await authStorage.clearAll();\n    }\n  },\n\n  async refreshTokens(): Promise<AuthTokens> {\n    const refreshToken = await authStorage.getRefreshToken();\n    if (!refreshToken) {\n      throw new Error('No refresh token available');\n    }\n\n    const { data } = await apiClient.post<{ tokens: AuthTokens }>('/auth/refresh', {\n      refreshToken,\n    });\n\n    await authStorage.setTokens(data.tokens);\n    return data.tokens;\n  },\n\n  async getCurrentUser(): Promise<User | null> {\n    try {\n      const { data } = await apiClient.get<User>('/users/me');\n      return data;\n    } catch {\n      return null;\n    }\n  },\n\n  async forgotPassword(email: string): Promise<void> {\n    await apiClient.post('/auth/forgot-password', { email });\n  },\n\n  async resetPassword(token: string, password: string): Promise<void> {\n    await apiClient.post('/auth/reset-password', { token, password });\n  },\n};\n```\n\n### 3. Create Auth Redux Slice\n\n```typescript\n// slices/authSlice.ts\nimport { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\nimport { authService, AuthResponse } from '@/services/auth/authService';\nimport { authStorage } from '@/services/auth/authStorage';\nimport type { User, LoginCredentials, RegisterData } from '@/types/auth.types';\nimport type { RootState } from '@/store';\n\ninterface AuthState {\n  user: User | null;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  isInitialized: boolean;\n  error: string | null;\n}\n\nconst initialState: AuthState = {\n  user: null,\n  isAuthenticated: false,\n  isLoading: false,\n  isInitialized: false,\n  error: null,\n};\n\n// Async Thunks\nexport const initializeAuth = createAsyncThunk(\n  'auth/initialize',\n  async (_, { rejectWithValue }) => {\n    try {\n      const token = await authStorage.getAccessToken();\n      if (!token) return null;\n\n      const user = await authService.getCurrentUser();\n      return user;\n    } catch (error) {\n      await authStorage.clearAll();\n      return rejectWithValue('Session expired');\n    }\n  }\n);\n\nexport const login = createAsyncThunk(\n  'auth/login',\n  async (credentials: LoginCredentials, { rejectWithValue }) => {\n    try {\n      const response = await authService.login(credentials);\n      return response;\n    } catch (error: any) {\n      return rejectWithValue(error.message || 'Login failed');\n    }\n  }\n);\n\nexport const register = createAsyncThunk(\n  'auth/register',\n  async (data: RegisterData, { rejectWithValue }) => {\n    try {\n      const response = await authService.register(data);\n      return response;\n    } catch (error: any) {\n      return rejectWithValue(error.message || 'Registration failed');\n    }\n  }\n);\n\nexport const logout = createAsyncThunk('auth/logout', async () => {\n  await authService.logout();\n});\n\n// Slice\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    clearError: (state) => {\n      state.error = null;\n    },\n    setUser: (state, action: PayloadAction<User>) => {\n      state.user = action.payload;\n    },\n  },\n  extraReducers: (builder) => {\n    // Initialize\n    builder\n      .addCase(initializeAuth.pending, (state) => {\n        state.isLoading = true;\n      })\n      .addCase(initializeAuth.fulfilled, (state, action) => {\n        state.isLoading = false;\n        state.isInitialized = true;\n        state.user = action.payload;\n        state.isAuthenticated = !!action.payload;\n      })\n      .addCase(initializeAuth.rejected, (state) => {\n        state.isLoading = false;\n        state.isInitialized = true;\n        state.isAuthenticated = false;\n      });\n\n    // Login\n    builder\n      .addCase(login.pending, (state) => {\n        state.isLoading = true;\n        state.error = null;\n      })\n      .addCase(login.fulfilled, (state, action) => {\n        state.isLoading = false;\n        state.user = action.payload.user;\n        state.isAuthenticated = true;\n      })\n      .addCase(login.rejected, (state, action) => {\n        state.isLoading = false;\n        state.error = action.payload as string;\n      });\n\n    // Register\n    builder\n      .addCase(register.pending, (state) => {\n        state.isLoading = true;\n        state.error = null;\n      })\n      .addCase(register.fulfilled, (state, action) => {\n        state.isLoading = false;\n        state.user = action.payload.user;\n        state.isAuthenticated = true;\n      })\n      .addCase(register.rejected, (state, action) => {\n        state.isLoading = false;\n        state.error = action.payload as string;\n      });\n\n    // Logout\n    builder.addCase(logout.fulfilled, (state) => {\n      state.user = null;\n      state.isAuthenticated = false;\n    });\n  },\n});\n\nexport const { clearError, setUser } = authSlice.actions;\n\n// Selectors\nexport const selectUser = (state: RootState) => state.auth.user;\nexport const selectIsAuthenticated = (state: RootState) => state.auth.isAuthenticated;\nexport const selectIsAuthLoading = (state: RootState) => state.auth.isLoading;\nexport const selectAuthError = (state: RootState) => state.auth.error;\nexport const selectIsInitialized = (state: RootState) => state.auth.isInitialized;\n\nexport default authSlice.reducer;\n```\n\n### 4. Create Auth Hook\n\n```typescript\n// hooks/useAuth.ts\nimport { useAppDispatch, useAppSelector } from '@/store/hooks';\nimport {\n  login,\n  register,\n  logout,\n  initializeAuth,\n  clearError,\n  selectUser,\n  selectIsAuthenticated,\n  selectIsAuthLoading,\n  selectAuthError,\n  selectIsInitialized,\n} from '@/slices/authSlice';\nimport type { LoginCredentials, RegisterData } from '@/types/auth.types';\n\nexport function useAuth() {\n  const dispatch = useAppDispatch();\n  const user = useAppSelector(selectUser);\n  const isAuthenticated = useAppSelector(selectIsAuthenticated);\n  const isLoading = useAppSelector(selectIsAuthLoading);\n  const error = useAppSelector(selectAuthError);\n  const isInitialized = useAppSelector(selectIsInitialized);\n\n  return {\n    user,\n    isAuthenticated,\n    isLoading,\n    error,\n    isInitialized,\n    login: (credentials: LoginCredentials) => dispatch(login(credentials)),\n    register: (data: RegisterData) => dispatch(register(data)),\n    logout: () => dispatch(logout()),\n    initialize: () => dispatch(initializeAuth()),\n    clearError: () => dispatch(clearError()),\n  };\n}\n```\n\n### 5. Create Auth Screens\n\n**Login Screen**:\n```typescript\n// app/(auth)/login.tsx\nimport { useState } from 'react';\nimport { View, Text, KeyboardAvoidingView, Platform } from 'react-native';\nimport { Link, router } from 'expo-router';\nimport { useForm, Controller } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\nimport { useAuth } from '@/hooks/useAuth';\nimport { Input, Button } from '@/components/ui';\nimport { useTheme } from '@/theme';\n\nconst loginSchema = z.object({\n  email: z.string().email('Invalid email'),\n  password: z.string().min(8, 'Password must be at least 8 characters'),\n});\n\ntype LoginForm = z.infer<typeof loginSchema>;\n\nexport default function LoginScreen() {\n  const { login, isLoading, error } = useAuth();\n  const { colors, spacing } = useTheme();\n\n  const { control, handleSubmit, formState: { errors } } = useForm<LoginForm>({\n    resolver: zodResolver(loginSchema),\n  });\n\n  const onSubmit = async (data: LoginForm) => {\n    const result = await login(data);\n    if (login.fulfilled.match(result)) {\n      router.replace('/(app)/(tabs)');\n    }\n  };\n\n  return (\n    <KeyboardAvoidingView\n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n      style={styles.container}\n    >\n      <View style={styles.form}>\n        <Text style={styles.title}>Welcome Back</Text>\n\n        {error && <Text style={styles.error}>{error}</Text>}\n\n        <Controller\n          control={control}\n          name=\"email\"\n          render={({ field: { onChange, value } }) => (\n            <Input\n              label=\"Email\"\n              value={value}\n              onChangeText={onChange}\n              error={errors.email?.message}\n              keyboardType=\"email-address\"\n              autoCapitalize=\"none\"\n            />\n          )}\n        />\n\n        <Controller\n          control={control}\n          name=\"password\"\n          render={({ field: { onChange, value } }) => (\n            <Input\n              label=\"Password\"\n              value={value}\n              onChangeText={onChange}\n              error={errors.password?.message}\n              secureTextEntry\n            />\n          )}\n        />\n\n        <Button\n          label=\"Sign In\"\n          onPress={handleSubmit(onSubmit)}\n          loading={isLoading}\n        />\n\n        <Link href=\"/forgot-password\">\n          <Text style={styles.link}>Forgot Password?</Text>\n        </Link>\n\n        <Link href=\"/register\">\n          <Text style={styles.link}>Don't have an account? Sign Up</Text>\n        </Link>\n      </View>\n    </KeyboardAvoidingView>\n  );\n}\n```\n\n### 6. Update API Client with Token Refresh\n\n```typescript\n// services/api/apiClient.ts - Add interceptors\nimport { authStorage } from '@/services/auth/authStorage';\nimport { authService } from '@/services/auth/authService';\n\n// Request interceptor - add auth token\napiClient.interceptors.request.use(async (config) => {\n  const token = await authStorage.getAccessToken();\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n\n// Response interceptor - handle token refresh\napiClient.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    const originalRequest = error.config;\n\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n\n      try {\n        await authService.refreshTokens();\n        const newToken = await authStorage.getAccessToken();\n        originalRequest.headers.Authorization = `Bearer ${newToken}`;\n        return apiClient(originalRequest);\n      } catch (refreshError) {\n        // Redirect to login\n        await authStorage.clearAll();\n        return Promise.reject(refreshError);\n      }\n    }\n\n    return Promise.reject(error);\n  }\n);\n```\n\n## Output\n\n```markdown\n## Authentication Added\n\n### Files Created\n- `services/auth/authStorage.ts` - Secure token storage\n- `services/auth/authService.ts` - Auth API calls\n- `slices/authSlice.ts` - Redux auth state\n- `hooks/useAuth.ts` - Auth hook\n- `types/auth.types.ts` - TypeScript types\n- `app/(auth)/login.tsx` - Login screen\n- `app/(auth)/register.tsx` - Register screen\n- `app/(auth)/forgot-password.tsx` - Forgot password screen\n\n### Files Modified\n- `services/api/apiClient.ts` - Added auth interceptors\n- `store/index.ts` - Added auth reducer\n- `app/(app)/_layout.tsx` - Added auth guard\n\n### Features\n- JWT token storage with expo-secure-store\n- Automatic token refresh\n- Protected route guards\n- Login/Register/Forgot Password screens\n- useAuth hook for easy access\n\n### Usage\n```typescript\nimport { useAuth } from '@/hooks/useAuth';\n\nfunction ProfileScreen() {\n  const { user, isAuthenticated, logout } = useAuth();\n\n  return (\n    <View>\n      <Text>Welcome, {user?.name}</Text>\n      <Button onPress={logout} label=\"Sign Out\" />\n    </View>\n  );\n}\n```\n```\n"
    },
    "add-k8s": {
      "prompt": "# /add-k8s - Add Kubernetes Configuration\n\nAdd Kubernetes manifests and Helm charts for deploying .NET applications.\n\n## Usage\n```\n/add-k8s [options]\n```\n\nOptions:\n- `--helm` - Generate Helm chart (default: plain manifests)\n- `--hpa` - Include Horizontal Pod Autoscaler\n- `--ingress <nginx|traefik>` - Include Ingress configuration\n- `--tls` - Include TLS/cert-manager configuration\n- `--story <ACF-###>` - Link to story ID\n\n## Instructions\n\nWhen invoked:\n\n### 1. Analyze Project Requirements\n\nDetermine:\n- Application name and namespace\n- Resource requirements (CPU, memory)\n- Dependencies (database, cache, etc.)\n- Scaling requirements\n\n### 2. Generate Directory Structure\n\n**Plain Manifests:**\n```\nk8s/\n‚îú‚îÄ‚îÄ base/\n‚îÇ   ‚îú‚îÄ‚îÄ deployment.yaml\n‚îÇ   ‚îú‚îÄ‚îÄ service.yaml\n‚îÇ   ‚îú‚îÄ‚îÄ configmap.yaml\n‚îÇ   ‚îî‚îÄ‚îÄ secret.yaml\n‚îú‚îÄ‚îÄ overlays/\n‚îÇ   ‚îú‚îÄ‚îÄ staging/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ kustomization.yaml\n‚îÇ   ‚îî‚îÄ‚îÄ production/\n‚îÇ       ‚îî‚îÄ‚îÄ kustomization.yaml\n‚îî‚îÄ‚îÄ kustomization.yaml\n```\n\n**Helm Chart:**\n```\nhelm/{{ProjectName}}/\n‚îú‚îÄ‚îÄ Chart.yaml\n‚îú‚îÄ‚îÄ values.yaml\n‚îú‚îÄ‚îÄ values-staging.yaml\n‚îú‚îÄ‚îÄ values-production.yaml\n‚îî‚îÄ‚îÄ templates/\n    ‚îú‚îÄ‚îÄ _helpers.tpl\n    ‚îú‚îÄ‚îÄ deployment.yaml\n    ‚îú‚îÄ‚îÄ service.yaml\n    ‚îú‚îÄ‚îÄ ingress.yaml\n    ‚îú‚îÄ‚îÄ configmap.yaml\n    ‚îú‚îÄ‚îÄ secret.yaml\n    ‚îú‚îÄ‚îÄ hpa.yaml\n    ‚îú‚îÄ‚îÄ pdb.yaml\n    ‚îî‚îÄ‚îÄ serviceaccount.yaml\n```\n\n### 3. Generate Deployment Manifest\n\n**deployment.yaml**:\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: {{ include \"app.fullname\" . }}\n  labels:\n    {{- include \"app.labels\" . | nindent 4 }}\nspec:\n  replicas: {{ .Values.replicaCount }}\n  selector:\n    matchLabels:\n      {{- include \"app.selectorLabels\" . | nindent 6 }}\n  template:\n    metadata:\n      labels:\n        {{- include \"app.selectorLabels\" . | nindent 8 }}\n      annotations:\n        prometheus.io/scrape: \"true\"\n        prometheus.io/port: \"8080\"\n        prometheus.io/path: \"/metrics\"\n    spec:\n      serviceAccountName: {{ include \"app.serviceAccountName\" . }}\n      securityContext:\n        runAsNonRoot: true\n        runAsUser: 1000\n        fsGroup: 2000\n        seccompProfile:\n          type: RuntimeDefault\n      containers:\n        - name: {{ .Chart.Name }}\n          image: \"{{ .Values.image.repository }}:{{ .Values.image.tag | default .Chart.AppVersion }}\"\n          imagePullPolicy: {{ .Values.image.pullPolicy }}\n          ports:\n            - name: http\n              containerPort: 8080\n              protocol: TCP\n          env:\n            - name: ASPNETCORE_ENVIRONMENT\n              value: \"{{ .Values.environment }}\"\n            - name: ASPNETCORE_URLS\n              value: \"http://+:8080\"\n            {{- range $key, $value := .Values.env }}\n            - name: {{ $key }}\n              value: {{ $value | quote }}\n            {{- end }}\n          envFrom:\n            - configMapRef:\n                name: {{ include \"app.fullname\" . }}-config\n            - secretRef:\n                name: {{ include \"app.fullname\" . }}-secrets\n          resources:\n            {{- toYaml .Values.resources | nindent 12 }}\n          livenessProbe:\n            httpGet:\n              path: /health/live\n              port: http\n            initialDelaySeconds: {{ .Values.probes.liveness.initialDelaySeconds }}\n            periodSeconds: {{ .Values.probes.liveness.periodSeconds }}\n            timeoutSeconds: {{ .Values.probes.liveness.timeoutSeconds }}\n            failureThreshold: {{ .Values.probes.liveness.failureThreshold }}\n          readinessProbe:\n            httpGet:\n              path: /health/ready\n              port: http\n            initialDelaySeconds: {{ .Values.probes.readiness.initialDelaySeconds }}\n            periodSeconds: {{ .Values.probes.readiness.periodSeconds }}\n            timeoutSeconds: {{ .Values.probes.readiness.timeoutSeconds }}\n            failureThreshold: {{ .Values.probes.readiness.failureThreshold }}\n          securityContext:\n            allowPrivilegeEscalation: false\n            readOnlyRootFilesystem: true\n            capabilities:\n              drop:\n                - ALL\n          volumeMounts:\n            - name: tmp\n              mountPath: /tmp\n      volumes:\n        - name: tmp\n          emptyDir: {}\n      {{- with .Values.nodeSelector }}\n      nodeSelector:\n        {{- toYaml . | nindent 8 }}\n      {{- end }}\n      {{- with .Values.affinity }}\n      affinity:\n        {{- toYaml . | nindent 8 }}\n      {{- end }}\n      {{- with .Values.tolerations }}\n      tolerations:\n        {{- toYaml . | nindent 8 }}\n      {{- end }}\n```\n\n### 4. Generate Service Manifest\n\n**service.yaml**:\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: {{ include \"app.fullname\" . }}\n  labels:\n    {{- include \"app.labels\" . | nindent 4 }}\nspec:\n  type: {{ .Values.service.type }}\n  ports:\n    - port: {{ .Values.service.port }}\n      targetPort: http\n      protocol: TCP\n      name: http\n  selector:\n    {{- include \"app.selectorLabels\" . | nindent 4 }}\n```\n\n### 5. Generate Ingress Manifest (if --ingress)\n\n**ingress.yaml**:\n```yaml\n{{- if .Values.ingress.enabled -}}\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: {{ include \"app.fullname\" . }}\n  labels:\n    {{- include \"app.labels\" . | nindent 4 }}\n  annotations:\n    {{- if eq .Values.ingress.className \"nginx\" }}\n    kubernetes.io/ingress.class: nginx\n    nginx.ingress.kubernetes.io/ssl-redirect: \"true\"\n    nginx.ingress.kubernetes.io/proxy-body-size: \"10m\"\n    nginx.ingress.kubernetes.io/proxy-read-timeout: \"60\"\n    {{- end }}\n    {{- if .Values.ingress.tls.enabled }}\n    cert-manager.io/cluster-issuer: {{ .Values.ingress.tls.clusterIssuer }}\n    {{- end }}\n    {{- with .Values.ingress.annotations }}\n    {{- toYaml . | nindent 4 }}\n    {{- end }}\nspec:\n  ingressClassName: {{ .Values.ingress.className }}\n  {{- if .Values.ingress.tls.enabled }}\n  tls:\n    - hosts:\n        - {{ .Values.ingress.host }}\n      secretName: {{ include \"app.fullname\" . }}-tls\n  {{- end }}\n  rules:\n    - host: {{ .Values.ingress.host }}\n      http:\n        paths:\n          - path: {{ .Values.ingress.path }}\n            pathType: Prefix\n            backend:\n              service:\n                name: {{ include \"app.fullname\" . }}\n                port:\n                  number: {{ .Values.service.port }}\n{{- end }}\n```\n\n### 6. Generate HPA Manifest (if --hpa)\n\n**hpa.yaml**:\n```yaml\n{{- if .Values.autoscaling.enabled }}\napiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: {{ include \"app.fullname\" . }}\n  labels:\n    {{- include \"app.labels\" . | nindent 4 }}\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: {{ include \"app.fullname\" . }}\n  minReplicas: {{ .Values.autoscaling.minReplicas }}\n  maxReplicas: {{ .Values.autoscaling.maxReplicas }}\n  metrics:\n    - type: Resource\n      resource:\n        name: cpu\n        target:\n          type: Utilization\n          averageUtilization: {{ .Values.autoscaling.targetCPUUtilizationPercentage }}\n    - type: Resource\n      resource:\n        name: memory\n        target:\n          type: Utilization\n          averageUtilization: {{ .Values.autoscaling.targetMemoryUtilizationPercentage }}\n  behavior:\n    scaleDown:\n      stabilizationWindowSeconds: 300\n      policies:\n        - type: Percent\n          value: 10\n          periodSeconds: 60\n    scaleUp:\n      stabilizationWindowSeconds: 0\n      policies:\n        - type: Percent\n          value: 100\n          periodSeconds: 15\n        - type: Pods\n          value: 4\n          periodSeconds: 15\n      selectPolicy: Max\n{{- end }}\n```\n\n### 7. Generate Pod Disruption Budget\n\n**pdb.yaml**:\n```yaml\napiVersion: policy/v1\nkind: PodDisruptionBudget\nmetadata:\n  name: {{ include \"app.fullname\" . }}\n  labels:\n    {{- include \"app.labels\" . | nindent 4 }}\nspec:\n  minAvailable: {{ .Values.pdb.minAvailable }}\n  selector:\n    matchLabels:\n      {{- include \"app.selectorLabels\" . | nindent 6 }}\n```\n\n### 8. Generate Values File\n\n**values.yaml**:\n```yaml\n# Default values for {{ProjectName}}\nreplicaCount: 2\n\nimage:\n  repository: ghcr.io/your-org/{{ProjectName}}\n  pullPolicy: IfNotPresent\n  tag: \"\"\n\nenvironment: Production\n\nservice:\n  type: ClusterIP\n  port: 80\n\ningress:\n  enabled: true\n  className: nginx\n  host: api.example.com\n  path: /\n  annotations: {}\n  tls:\n    enabled: true\n    clusterIssuer: letsencrypt-prod\n\nresources:\n  limits:\n    cpu: 500m\n    memory: 512Mi\n  requests:\n    cpu: 100m\n    memory: 256Mi\n\nautoscaling:\n  enabled: true\n  minReplicas: 2\n  maxReplicas: 10\n  targetCPUUtilizationPercentage: 70\n  targetMemoryUtilizationPercentage: 80\n\npdb:\n  minAvailable: 1\n\nprobes:\n  liveness:\n    initialDelaySeconds: 10\n    periodSeconds: 15\n    timeoutSeconds: 5\n    failureThreshold: 3\n  readiness:\n    initialDelaySeconds: 5\n    periodSeconds: 10\n    timeoutSeconds: 5\n    failureThreshold: 3\n\nenv: {}\n\nnodeSelector: {}\n\ntolerations: []\n\naffinity: {}\n```\n\n**values-production.yaml**:\n```yaml\nreplicaCount: 3\n\nenvironment: Production\n\ningress:\n  host: api.example.com\n\nresources:\n  limits:\n    cpu: 1000m\n    memory: 1Gi\n  requests:\n    cpu: 250m\n    memory: 512Mi\n\nautoscaling:\n  minReplicas: 3\n  maxReplicas: 20\n```\n\n## Security Best Practices\n\n- [ ] Non-root user in containers\n- [ ] Read-only root filesystem\n- [ ] No privilege escalation\n- [ ] Dropped ALL capabilities\n- [ ] Resource limits set\n- [ ] Network policies configured\n- [ ] Secrets managed externally (Sealed Secrets or External Secrets)\n- [ ] Pod Security Standards enforced\n\n## Output\n\n```markdown\n## Kubernetes Configuration Created\n\n### Files Created\n**Helm Chart:**\n- helm/{{ProjectName}}/Chart.yaml\n- helm/{{ProjectName}}/values.yaml\n- helm/{{ProjectName}}/values-staging.yaml\n- helm/{{ProjectName}}/values-production.yaml\n- helm/{{ProjectName}}/templates/*.yaml\n\n### Deployment Commands\n```bash\n# Install to staging\nhelm install {{ProjectName}} ./helm/{{ProjectName}} \\\n  -f ./helm/{{ProjectName}}/values-staging.yaml \\\n  -n staging\n\n# Upgrade production\nhelm upgrade {{ProjectName}} ./helm/{{ProjectName}} \\\n  -f ./helm/{{ProjectName}}/values-production.yaml \\\n  -n production\n\n# Dry run\nhelm install {{ProjectName}} ./helm/{{ProjectName}} --dry-run --debug\n```\n\n### Prerequisites\n- Kubernetes cluster 1.25+\n- Helm 3.x\n- NGINX Ingress Controller\n- cert-manager (for TLS)\n- External Secrets Operator (recommended)\n\n### Next Steps\n1. Update image repository in values.yaml\n2. Configure ingress hostname\n3. Set up secrets management\n4. Configure network policies\n```\n\n## Example\n\n```\nUser: /add-k8s --helm --hpa --ingress nginx --tls --story ACF-065\n\nClaude: Creating Kubernetes configuration with Helm chart...\n\nGenerating Helm chart:\n1. Chart.yaml with metadata\n2. values.yaml (default configuration)\n3. values-staging.yaml\n4. values-production.yaml\n\nCreating templates:\n5. deployment.yaml (with security context)\n6. service.yaml (ClusterIP)\n7. ingress.yaml (NGINX with TLS)\n8. hpa.yaml (CPU/Memory scaling)\n9. pdb.yaml (Pod Disruption Budget)\n10. configmap.yaml\n11. secret.yaml\n\nKubernetes configuration created successfully.\n\nDeploy with:\n  helm install orderservice ./helm/orderservice -n staging\n```\n"
    },
    "add-entity": {
      "prompt": "# /add-entity - Add Domain Entity\n\nAdd a new domain entity following DDD patterns.\n\n## Usage\n```\n/add-entity <EntityName> [options]\n```\n\nOptions:\n- `--aggregate` - Mark as aggregate root\n- `--with-events` - Include domain events\n- `--with-repository` - Generate repository interface\n\n## Instructions\n\nWhen invoked:\n\n### 1. Gather Entity Information\n\nAsk for:\n- Entity name (PascalCase)\n- Key properties and their types\n- Whether it's an aggregate root\n- Related entities (for navigation properties)\n\n### 2. Generate Files\n\n**Entity Class** (`src/Project.Domain/Entities/<EntityName>.cs`):\n```csharp\nnamespace Project.Domain.Entities;\n\npublic class <EntityName> : BaseEntity, IAggregateRoot\n{\n    public Guid Id { get; private set; }\n    public DateTime CreatedAt { get; private set; }\n    // Properties...\n\n    public static <EntityName> Create(/* params */)\n    {\n        var entity = new <EntityName>\n        {\n            Id = Guid.NewGuid(),\n            CreatedAt = DateTime.UtcNow\n        };\n        entity.AddDomainEvent(new <EntityName>CreatedEvent(entity.Id));\n        return entity;\n    }\n\n    private <EntityName>() { }\n}\n```\n\n**Domain Events** (if `--with-events`):\n```csharp\npublic record <EntityName>CreatedEvent(Guid <EntityName>Id) : IDomainEvent;\npublic record <EntityName>UpdatedEvent(Guid <EntityName>Id) : IDomainEvent;\n```\n\n**Repository Interface** (if `--with-repository`):\n```csharp\npublic interface I<EntityName>Repository : IRepository<<EntityName>>\n{\n    Task<<EntityName>?> GetByIdAsync(Guid id, CancellationToken ct = default);\n    Task AddAsync(<EntityName> entity, CancellationToken ct = default);\n    void Update(<EntityName> entity);\n}\n```\n\n### 3. Update EF Configuration\n\nCreate or update Infrastructure configuration:\n```csharp\n// src/Project.Infrastructure/Persistence/Configurations/<EntityName>Configuration.cs\npublic class <EntityName>Configuration : IEntityTypeConfiguration<<EntityName>>\n{\n    public void Configure(EntityTypeBuilder<<EntityName>> builder)\n    {\n        builder.ToTable(\"<EntityName>s\");\n        builder.HasKey(e => e.Id);\n        // Configure properties...\n    }\n}\n```\n\n### 4. Add to DbContext\n\nUpdate `ApplicationDbContext.cs`:\n```csharp\npublic DbSet<<EntityName>> <EntityName>s => Set<<EntityName>>();\n```\n\n### 5. Generate Tests\n\nCreate unit tests for entity creation and business methods.\n\n## Templates Used\n\n- `.claude/templates/entity.cs.template`\n- `.claude/templates/repository.cs.template`\n\n## Output\n\n```markdown\n## Entity Created: <EntityName>\n\n### Files Created\n- src/Project.Domain/Entities/<EntityName>.cs\n- src/Project.Domain/Events/<EntityName>Events.cs\n- src/Project.Domain/Repositories/I<EntityName>Repository.cs\n- src/Project.Infrastructure/Persistence/Configurations/<EntityName>Configuration.cs\n\n### Next Steps\n1. Add properties to the entity\n2. Implement repository in Infrastructure\n3. Register in DI container\n4. Create CQRS commands/queries with `/add-command` or `/add-query`\n```\n\n## Example\n\n```\nUser: /add-entity Order --aggregate --with-events --with-repository\n\nClaude: Creating Order entity as aggregate root...\n\nI'll create the following:\n1. Order entity with factory method\n2. OrderCreatedEvent and OrderUpdatedEvent\n3. IOrderRepository interface\n4. EF Core configuration\n\nProperties for Order:\n- What properties should the Order have? (e.g., CustomerId, Status, TotalAmount)\n\n[After gathering info, generates all files]\n\nEntity Order created successfully.\n```\n"
    },
    "add-endpoint": {
      "prompt": "# /add-endpoint - Add API Endpoint\n\nAdd a new API endpoint with full CQRS implementation.\n\n## Usage\n```\n/add-endpoint <HttpMethod> <Route> [options]\n```\n\nExamples:\n- `/add-endpoint GET /orders/{id}`\n- `/add-endpoint POST /orders`\n- `/add-endpoint PUT /orders/{id}`\n- `/add-endpoint DELETE /orders/{id}`\n\nOptions:\n- `--auth` - Require authentication\n- `--role <role>` - Require specific role\n- `--story <ACF-###>` - Link to story ID\n\n## Instructions\n\nWhen invoked:\n\n### 1. Parse Route Information\n\nExtract:\n- HTTP method (GET, POST, PUT, DELETE, PATCH)\n- Route template\n- Route parameters\n- Controller name (from route)\n\n### 2. Determine Required Components\n\n| HTTP Method | Components |\n|-------------|------------|\n| GET (single) | Query + Handler + DTO |\n| GET (list) | Query + Handler + DTO |\n| POST | Command + Handler + Validator + Request |\n| PUT | Command + Handler + Validator + Request |\n| DELETE | Command + Handler |\n| PATCH | Command + Handler + Validator + Request |\n\n### 3. Generate Files\n\n**For GET endpoint**:\n```csharp\n// Query\npublic record Get<Entity>ByIdQuery(Guid Id) : IRequest<<Entity>Dto?>;\n\n// Handler\npublic class Get<Entity>ByIdHandler : IRequestHandler<Get<Entity>ByIdQuery, <Entity>Dto?>\n{\n    // Implementation...\n}\n\n// Controller action\n[HttpGet(\"{id:guid}\")]\n[ProducesResponseType(typeof(<Entity>Dto), StatusCodes.Status200OK)]\n[ProducesResponseType(StatusCodes.Status404NotFound)]\npublic async Task<IActionResult> GetById(Guid id, CancellationToken ct)\n{\n    var result = await _mediator.Send(new Get<Entity>ByIdQuery(id), ct);\n    return result is null ? NotFound() : Ok(result);\n}\n```\n\n**For POST endpoint**:\n```csharp\n// Command\npublic record Create<Entity>Command(/* properties */) : IRequest<Result<Guid>>;\n\n// Handler\npublic class Create<Entity>Handler : IRequestHandler<Create<Entity>Command, Result<Guid>>\n{\n    // Implementation...\n}\n\n// Validator\npublic class Create<Entity>Validator : AbstractValidator<Create<Entity>Command>\n{\n    // Validation rules...\n}\n\n// Controller action\n[HttpPost]\n[ProducesResponseType(typeof(Guid), StatusCodes.Status201Created)]\n[ProducesResponseType(typeof(ProblemDetails), StatusCodes.Status400BadRequest)]\npublic async Task<IActionResult> Create([FromBody] Create<Entity>Request request, CancellationToken ct)\n{\n    var command = new Create<Entity>Command(/* map request */);\n    var result = await _mediator.Send(command, ct);\n\n    return result.IsFailure\n        ? BadRequest(result.Error)\n        : CreatedAtAction(nameof(GetById), new { id = result.Value }, result.Value);\n}\n```\n\n### 4. Generate Tests\n\nCreate integration tests for the endpoint:\n```csharp\n[Fact]\n[Trait(\"Story\", \"<StoryId>\")]\npublic async Task <Method>_<Scenario>_Returns<Status>()\n{\n    // Test implementation\n}\n```\n\n### 5. Update OpenAPI Documentation\n\nEnsure proper XML comments and attributes:\n```csharp\n/// <summary>\n/// Creates a new <Entity>.\n/// </summary>\n/// <param name=\"request\">The creation request</param>\n/// <returns>The created entity ID</returns>\n/// <response code=\"201\">Returns the created entity ID</response>\n/// <response code=\"400\">If the request is invalid</response>\n```\n\n## Templates Used\n\n- `.claude/templates/controller.cs.template`\n- `.claude/templates/command-handler.cs.template`\n- `.claude/templates/query-handler.cs.template`\n- `.claude/templates/integration-test.cs.template`\n\n## Output\n\n```markdown\n## Endpoint Created: <Method> <Route>\n\n### Files Created/Modified\n- src/Project.Api/Controllers/<Controller>Controller.cs (modified)\n- src/Project.Application/Commands/<Feature>/Create<Entity>Command.cs\n- src/Project.Application/Commands/<Feature>/Create<Entity>Handler.cs\n- src/Project.Application/Commands/<Feature>/Create<Entity>Validator.cs\n- tests/Project.IntegrationTests/Api/<Controller>Tests.cs\n\n### Endpoint Details\n- Method: POST\n- Route: /api/orders\n- Auth: Required\n- Role: None\n\n### Test Coverage\n- Create_ValidRequest_ReturnsCreated\n- Create_InvalidRequest_ReturnsBadRequest\n```\n\n## Example\n\n```\nUser: /add-endpoint POST /orders --auth --story ACF-042\n\nClaude: Creating POST /orders endpoint...\n\nThis will create:\n1. CreateOrderCommand + Handler + Validator\n2. Controller action with [Authorize]\n3. Integration tests linked to ACF-042\n\nWhat properties should CreateOrderRequest have?\n- CustomerId (Guid)\n- Items (List<OrderItemRequest>)\n- etc.\n\n[After gathering info, generates all files]\n\nEndpoint created: POST /api/orders\n```\n"
    },
    "add-docker": {
      "prompt": "# /add-docker - Add Docker Configuration\n\nAdd Docker configuration for containerizing .NET applications.\n\n## Usage\n```\n/add-docker [options]\n```\n\nOptions:\n- `--compose` - Include docker-compose for local development\n- `--db <postgres|sqlserver|mysql>` - Include database service\n- `--cache` - Include Redis cache service\n- `--story <ACF-###>` - Link to story ID\n\n## Instructions\n\nWhen invoked:\n\n### 1. Analyze Project Structure\n\nDetermine:\n- Solution name and project structure\n- API project location (src/*.Api/)\n- Dependencies (database, cache, etc.)\n- Target .NET version (8.0)\n\n### 2. Generate Dockerfile\n\nCreate multi-stage Dockerfile:\n\n```dockerfile\n# Build stage\nFROM mcr.microsoft.com/dotnet/sdk:8.0 AS build\nWORKDIR /src\n\n# Copy project files and restore\nCOPY [\"src/{{ProjectName}}.Api/{{ProjectName}}.Api.csproj\", \"{{ProjectName}}.Api/\"]\nCOPY [\"src/{{ProjectName}}.Application/{{ProjectName}}.Application.csproj\", \"{{ProjectName}}.Application/\"]\nCOPY [\"src/{{ProjectName}}.Domain/{{ProjectName}}.Domain.csproj\", \"{{ProjectName}}.Domain/\"]\nCOPY [\"src/{{ProjectName}}.Infrastructure/{{ProjectName}}.Infrastructure.csproj\", \"{{ProjectName}}.Infrastructure/\"]\nRUN dotnet restore \"{{ProjectName}}.Api/{{ProjectName}}.Api.csproj\"\n\n# Copy everything and build\nCOPY . .\nWORKDIR \"/src/{{ProjectName}}.Api\"\nRUN dotnet build \"{{ProjectName}}.Api.csproj\" -c Release -o /app/build\n\n# Publish stage\nFROM build AS publish\nRUN dotnet publish \"{{ProjectName}}.Api.csproj\" -c Release -o /app/publish /p:UseAppHost=false\n\n# Runtime stage\nFROM mcr.microsoft.com/dotnet/aspnet:8.0 AS final\nWORKDIR /app\n\n# Create non-root user\nRUN addgroup --system --gid 1000 appgroup && \\\n    adduser --system --uid 1000 --ingroup appgroup appuser\n\nEXPOSE 8080\nCOPY --from=publish /app/publish .\n\n# Set ownership and switch to non-root user\nRUN chown -R appuser:appgroup /app\nUSER appuser\n\nENTRYPOINT [\"dotnet\", \"{{ProjectName}}.Api.dll\"]\n\n# Health check\nHEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n  CMD curl -f http://localhost:8080/health || exit 1\n```\n\n### 3. Generate Docker Compose (if --compose)\n\n```yaml\nversion: '3.8'\n\nservices:\n  api:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    ports:\n      - \"5000:8080\"\n    environment:\n      - ASPNETCORE_ENVIRONMENT=Development\n      - ConnectionStrings__DefaultConnection=${DATABASE_CONNECTION}\n      - JwtSettings__Secret=${JWT_SECRET}\n    depends_on:\n      db:\n        condition: service_healthy\n    networks:\n      - app-network\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8080/health\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n\n  db:\n    image: postgres:16-alpine\n    environment:\n      - POSTGRES_DB={{ProjectName}}\n      - POSTGRES_USER=app\n      - POSTGRES_PASSWORD=app_password\n    ports:\n      - \"5432:5432\"\n    volumes:\n      - postgres-data:/var/lib/postgresql/data\n    healthcheck:\n      test: [\"CMD-SHELL\", \"pg_isready -U app\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n    networks:\n      - app-network\n\n  redis:\n    image: redis:7-alpine\n    ports:\n      - \"6379:6379\"\n    volumes:\n      - redis-data:/data\n    networks:\n      - app-network\n\nvolumes:\n  postgres-data:\n  redis-data:\n\nnetworks:\n  app-network:\n    driver: bridge\n```\n\n### 4. Generate .dockerignore\n\n```\n**/bin/\n**/obj/\n**/out/\n**/.vs/\n**/TestResults/\n**/*.user\n**/*.suo\n**/*.cache\n**/*.log\n**/.vscode/\n.git/\n.gitignore\n*.md\ndocker-compose*.yml\nDockerfile*\n.env*\n```\n\n### 5. Generate Environment File Template\n\nCreate `.env.template`:\n```bash\n# Database\nDATABASE_CONNECTION=Host=db;Database={{ProjectName}};Username=app;Password=app_password\n\n# JWT\nJWT_SECRET=your-256-bit-secret-key-here\n\n# Application\nASPNETCORE_ENVIRONMENT=Development\n```\n\n## Security Checklist\n\nBefore generating:\n- [ ] Non-root user in container\n- [ ] No secrets in Dockerfile\n- [ ] Minimal base image (Alpine where possible)\n- [ ] Health checks configured\n- [ ] Resource limits recommended\n- [ ] .dockerignore excludes sensitive files\n\n## Output\n\n```markdown\n## Docker Configuration Created\n\n### Files Created\n- Dockerfile\n- docker-compose.yml (if --compose)\n- docker-compose.override.yml (for dev settings)\n- .dockerignore\n- .env.template\n\n### Services Configured\n| Service | Image | Port |\n|---------|-------|------|\n| api | Custom build | 5000:8080 |\n| db | postgres:16-alpine | 5432:5432 |\n| redis | redis:7-alpine | 6379:6379 |\n\n### Quick Start\n```bash\n# Build and run\ndocker-compose up --build\n\n# Run in background\ndocker-compose up -d\n\n# View logs\ndocker-compose logs -f api\n\n# Stop\ndocker-compose down\n```\n\n### Production Notes\n1. Use secrets management (not env vars)\n2. Set resource limits\n3. Use image scanning\n4. Enable container security features\n```\n\n## Example\n\n```\nUser: /add-docker --compose --db postgres --cache --story ACF-050\n\nClaude: Adding Docker configuration for the project...\n\nDetected project: OrderService\n- API: src/OrderService.Api\n- Using .NET 8.0\n- PostgreSQL database required\n- Redis cache required\n\nCreating files:\n1. Dockerfile (multi-stage build)\n2. docker-compose.yml (api, postgres, redis)\n3. docker-compose.override.yml (dev settings)\n4. .dockerignore\n5. .env.template\n\nDocker configuration created successfully.\n\nTo start: docker-compose up --build\n```\n"
    },
    "add-cicd": {
      "prompt": "# /add-cicd - Add CI/CD Pipeline\n\nAdd GitHub Actions CI/CD workflows for .NET applications.\n\n## Usage\n```\n/add-cicd [options]\n```\n\nOptions:\n- `--provider <github|azure>` - CI/CD provider (default: github)\n- `--deploy <azure|aws|k8s>` - Deployment target\n- `--environments <list>` - Environments (e.g., staging,production)\n- `--story <ACF-###>` - Link to story ID\n\n## Instructions\n\nWhen invoked:\n\n### 1. Analyze Project Requirements\n\nDetermine:\n- Project structure and solution file location\n- Test projects (Unit, Integration, Architecture)\n- Docker configuration presence\n- Target deployment platform\n\n### 2. Generate Build and Test Workflow\n\nCreate `.github/workflows/build.yml`:\n\n```yaml\nname: Build and Test\n\non:\n  push:\n    branches: [main, develop]\n  pull_request:\n    branches: [main]\n\nenv:\n  DOTNET_VERSION: '8.0.x'\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v4\n\n      - name: Setup .NET\n        uses: actions/setup-dotnet@v4\n        with:\n          dotnet-version: ${{ env.DOTNET_VERSION }}\n\n      - name: Restore dependencies\n        run: dotnet restore\n\n      - name: Build\n        run: dotnet build --configuration Release --no-restore\n\n      - name: Run unit tests\n        run: |\n          dotnet test tests/*.UnitTests \\\n            --configuration Release \\\n            --no-build \\\n            --verbosity normal \\\n            --collect:\"XPlat Code Coverage\" \\\n            --results-directory ./TestResults\n\n      - name: Run integration tests\n        run: |\n          dotnet test tests/*.IntegrationTests \\\n            --configuration Release \\\n            --no-build \\\n            --verbosity normal\n\n      - name: Run architecture tests\n        run: |\n          dotnet test tests/*.ArchitectureTests \\\n            --configuration Release \\\n            --no-build \\\n            --verbosity normal\n\n      - name: Generate coverage report\n        uses: danielpalme/ReportGenerator-GitHub-Action@5.2.4\n        with:\n          reports: '**/coverage.cobertura.xml'\n          targetdir: coveragereport\n          reporttypes: 'HtmlInline;Cobertura'\n\n      - name: Upload coverage artifact\n        uses: actions/upload-artifact@v4\n        with:\n          name: coverage-report\n          path: coveragereport/\n\n      - name: Check coverage threshold\n        run: |\n          # Extract coverage percentage\n          coverage=$(grep -oP 'line-rate=\"\\K[^\"]+' coveragereport/Cobertura.xml | head -1)\n          coverage_percent=$(echo \"$coverage * 100\" | bc)\n          echo \"Coverage: $coverage_percent%\"\n\n          if (( $(echo \"$coverage_percent < 80\" | bc -l) )); then\n            echo \"::error::Coverage $coverage_percent% is below 80% threshold\"\n            exit 1\n          fi\n\n      - name: Upload test results\n        uses: actions/upload-artifact@v4\n        if: always()\n        with:\n          name: test-results\n          path: TestResults/\n```\n\n### 3. Generate Security Scan Workflow\n\nCreate `.github/workflows/security.yml`:\n\n```yaml\nname: Security Scan\n\non:\n  push:\n    branches: [main]\n  schedule:\n    - cron: '0 0 * * 0' # Weekly on Sunday\n\njobs:\n  security:\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v4\n\n      - name: Setup .NET\n        uses: actions/setup-dotnet@v4\n        with:\n          dotnet-version: '8.0.x'\n\n      - name: Check for vulnerable packages\n        run: |\n          dotnet list package --vulnerable --include-transitive 2>&1 | tee vulnerability-report.txt\n          if grep -q \"has the following vulnerable packages\" vulnerability-report.txt; then\n            echo \"::warning::Vulnerable packages detected\"\n          fi\n\n      - name: Run OWASP Dependency Check\n        uses: dependency-check/Dependency-Check_Action@main\n        with:\n          project: '{{ProjectName}}'\n          path: '.'\n          format: 'HTML'\n          out: 'reports'\n\n      - name: Upload security report\n        uses: actions/upload-artifact@v4\n        with:\n          name: security-report\n          path: reports/\n\n      - name: CodeQL Analysis\n        uses: github/codeql-action/init@v3\n        with:\n          languages: csharp\n\n      - name: Build for CodeQL\n        run: dotnet build\n\n      - name: Perform CodeQL Analysis\n        uses: github/codeql-action/analyze@v3\n```\n\n### 4. Generate Docker Build Workflow\n\nCreate `.github/workflows/docker.yml`:\n\n```yaml\nname: Build and Push Docker Image\n\non:\n  push:\n    branches: [main]\n    tags:\n      - 'v*'\n\nenv:\n  REGISTRY: ghcr.io\n  IMAGE_NAME: ${{ github.repository }}\n\njobs:\n  build-and-push:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: read\n      packages: write\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v4\n\n      - name: Set up Docker Buildx\n        uses: docker/setup-buildx-action@v3\n\n      - name: Log in to Container Registry\n        uses: docker/login-action@v3\n        with:\n          registry: ${{ env.REGISTRY }}\n          username: ${{ github.actor }}\n          password: ${{ secrets.GITHUB_TOKEN }}\n\n      - name: Extract metadata\n        id: meta\n        uses: docker/metadata-action@v5\n        with:\n          images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}\n          tags: |\n            type=ref,event=branch\n            type=semver,pattern={{version}}\n            type=semver,pattern={{major}}.{{minor}}\n            type=sha\n\n      - name: Build and push\n        uses: docker/build-push-action@v5\n        with:\n          context: .\n          push: true\n          tags: ${{ steps.meta.outputs.tags }}\n          labels: ${{ steps.meta.outputs.labels }}\n          cache-from: type=gha\n          cache-to: type=gha,mode=max\n```\n\n### 5. Generate Deployment Workflow\n\nCreate `.github/workflows/deploy.yml`:\n\n```yaml\nname: Deploy\n\non:\n  workflow_run:\n    workflows: [\"Build and Push Docker Image\"]\n    types: [completed]\n    branches: [main]\n\njobs:\n  deploy-staging:\n    runs-on: ubuntu-latest\n    if: ${{ github.event.workflow_run.conclusion == 'success' }}\n    environment:\n      name: staging\n      url: https://staging.example.com\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v4\n\n      - name: Deploy to staging\n        run: |\n          echo \"Deploying to staging...\"\n          # Add deployment commands here\n\n      - name: Health check\n        run: |\n          for i in {1..10}; do\n            if curl -sf https://staging.example.com/health; then\n              echo \"Health check passed\"\n              exit 0\n            fi\n            echo \"Retry $i/10...\"\n            sleep 10\n          done\n          echo \"Health check failed\"\n          exit 1\n\n      - name: Notify on failure\n        if: failure()\n        uses: 8398a7/action-slack@v3\n        with:\n          status: ${{ job.status }}\n          webhook_url: ${{ secrets.SLACK_WEBHOOK }}\n\n  deploy-production:\n    runs-on: ubuntu-latest\n    needs: deploy-staging\n    if: startsWith(github.ref, 'refs/tags/v')\n    environment:\n      name: production\n      url: https://example.com\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v4\n\n      - name: Deploy to production\n        run: |\n          echo \"Deploying to production...\"\n          # Add deployment commands here\n\n      - name: Create GitHub Release\n        uses: softprops/action-gh-release@v1\n        with:\n          generate_release_notes: true\n```\n\n## Required Secrets\n\nDocument required GitHub secrets:\n```markdown\n## GitHub Secrets Required\n\n| Secret | Description | Required For |\n|--------|-------------|--------------|\n| `GITHUB_TOKEN` | Auto-provided | Package registry |\n| `AZURE_CREDENTIALS` | Azure service principal | Azure deployment |\n| `AWS_ACCESS_KEY_ID` | AWS credentials | AWS deployment |\n| `AWS_SECRET_ACCESS_KEY` | AWS credentials | AWS deployment |\n| `SLACK_WEBHOOK` | Slack webhook URL | Notifications |\n| `SONAR_TOKEN` | SonarQube token | Code quality |\n```\n\n## Output\n\n```markdown\n## CI/CD Pipelines Created\n\n### Workflows Created\n| Workflow | Trigger | Purpose |\n|----------|---------|---------|\n| build.yml | Push/PR | Build, test, coverage |\n| security.yml | Push/Weekly | Security scanning |\n| docker.yml | Push to main/tags | Docker image build |\n| deploy.yml | After docker build | Deploy to environments |\n\n### Branch Protection Recommended\n- Require status checks: build, security\n- Require PR reviews before merge\n- Require up-to-date branches\n\n### Next Steps\n1. Add required secrets to repository settings\n2. Configure branch protection rules\n3. Set up environments (staging, production)\n4. Configure deployment targets\n```\n\n## Example\n\n```\nUser: /add-cicd --provider github --deploy azure --environments staging,production --story ACF-055\n\nClaude: Creating GitHub Actions CI/CD workflows...\n\nDetected project structure:\n- Solution: OrderService.sln\n- Test projects: UnitTests, IntegrationTests, ArchitectureTests\n- Docker: Dockerfile present\n- Target: Azure App Service\n\nCreating workflows:\n1. .github/workflows/build.yml (build, test, coverage)\n2. .github/workflows/security.yml (vulnerability scanning)\n3. .github/workflows/docker.yml (container build)\n4. .github/workflows/deploy.yml (staging ‚Üí production)\n\nRequired secrets:\n- AZURE_WEBAPP_PUBLISH_PROFILE_STAGING\n- AZURE_WEBAPP_PUBLISH_PROFILE_PRODUCTION\n- SLACK_WEBHOOK (optional)\n\nCI/CD pipelines created successfully.\n\nNext: Add secrets in GitHub repository settings ‚Üí Settings ‚Üí Secrets\n```\n"
    },
    "add-auth": {
      "prompt": "# /add-auth - Add JWT Authentication\n\nAdd JWT authentication and authorization to ASP.NET Core applications.\n\n## Usage\n```\n/add-auth [options]\n```\n\nOptions:\n- `--refresh-tokens` - Include refresh token support\n- `--roles` - Include role-based authorization\n- `--claims` - Include claims-based authorization\n- `--story <ACF-###>` - Link to story ID\n\n## Instructions\n\nWhen invoked:\n\n### 1. Analyze Project Structure\n\nVerify:\n- Clean Architecture layers exist\n- Infrastructure project for security implementation\n- Application project for auth commands/queries\n- API project for controllers and middleware\n\n### 2. Create Authentication Structure\n\n```\nsrc/{{ProjectName}}.Infrastructure/Security/\n‚îú‚îÄ‚îÄ Jwt/\n‚îÇ   ‚îú‚îÄ‚îÄ IJwtTokenGenerator.cs\n‚îÇ   ‚îú‚îÄ‚îÄ JwtTokenGenerator.cs\n‚îÇ   ‚îî‚îÄ‚îÄ JwtSettings.cs\n‚îú‚îÄ‚îÄ Password/\n‚îÇ   ‚îú‚îÄ‚îÄ IPasswordHasher.cs\n‚îÇ   ‚îî‚îÄ‚îÄ PasswordHasher.cs\n‚îî‚îÄ‚îÄ Extensions/\n    ‚îî‚îÄ‚îÄ AuthenticationExtensions.cs\n\nsrc/{{ProjectName}}.Application/Authentication/\n‚îú‚îÄ‚îÄ Commands/\n‚îÇ   ‚îú‚îÄ‚îÄ Register/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RegisterCommand.cs\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RegisterCommandHandler.cs\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ RegisterCommandValidator.cs\n‚îÇ   ‚îú‚îÄ‚îÄ Login/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginCommand.cs\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginCommandHandler.cs\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LoginCommandValidator.cs\n‚îÇ   ‚îî‚îÄ‚îÄ RefreshToken/\n‚îÇ       ‚îú‚îÄ‚îÄ RefreshTokenCommand.cs\n‚îÇ       ‚îî‚îÄ‚îÄ RefreshTokenCommandHandler.cs\n‚îî‚îÄ‚îÄ DTOs/\n    ‚îú‚îÄ‚îÄ AuthResponse.cs\n    ‚îú‚îÄ‚îÄ LoginRequest.cs\n    ‚îî‚îÄ‚îÄ RegisterRequest.cs\n\nsrc/{{ProjectName}}.Api/Controllers/\n‚îî‚îÄ‚îÄ AuthController.cs\n```\n\n### 3. Generate JWT Token Generator\n\n**IJwtTokenGenerator.cs**:\n```csharp\nnamespace {{Namespace}}.Infrastructure.Security.Jwt;\n\npublic interface IJwtTokenGenerator\n{\n    string GenerateAccessToken(Guid userId, string email, IList<string> roles);\n    string GenerateRefreshToken();\n}\n```\n\n**JwtTokenGenerator.cs**:\n```csharp\nusing System.IdentityModel.Tokens.Jwt;\nusing System.Security.Claims;\nusing System.Security.Cryptography;\nusing System.Text;\nusing Microsoft.Extensions.Options;\nusing Microsoft.IdentityModel.Tokens;\n\nnamespace {{Namespace}}.Infrastructure.Security.Jwt;\n\npublic class JwtTokenGenerator : IJwtTokenGenerator\n{\n    private readonly JwtSettings _jwtSettings;\n\n    public JwtTokenGenerator(IOptions<JwtSettings> jwtSettings)\n    {\n        _jwtSettings = jwtSettings.Value;\n    }\n\n    public string GenerateAccessToken(Guid userId, string email, IList<string> roles)\n    {\n        var key = new SymmetricSecurityKey(\n            Encoding.UTF8.GetBytes(_jwtSettings.Secret));\n\n        var credentials = new SigningCredentials(\n            key, SecurityAlgorithms.HmacSha256);\n\n        var claims = new List<Claim>\n        {\n            new(JwtRegisteredClaimNames.Sub, userId.ToString()),\n            new(JwtRegisteredClaimNames.Email, email),\n            new(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString()),\n            new(ClaimTypes.NameIdentifier, userId.ToString())\n        };\n\n        claims.AddRange(roles.Select(role =>\n            new Claim(ClaimTypes.Role, role)));\n\n        var token = new JwtSecurityToken(\n            issuer: _jwtSettings.Issuer,\n            audience: _jwtSettings.Audience,\n            claims: claims,\n            expires: DateTime.UtcNow.AddMinutes(_jwtSettings.AccessTokenExpiryMinutes),\n            signingCredentials: credentials\n        );\n\n        return new JwtSecurityTokenHandler().WriteToken(token);\n    }\n\n    public string GenerateRefreshToken()\n    {\n        var randomNumber = new byte[64];\n        using var rng = RandomNumberGenerator.Create();\n        rng.GetBytes(randomNumber);\n        return Convert.ToBase64String(randomNumber);\n    }\n}\n```\n\n**JwtSettings.cs**:\n```csharp\nnamespace {{Namespace}}.Infrastructure.Security.Jwt;\n\npublic class JwtSettings\n{\n    public const string SectionName = \"JwtSettings\";\n\n    public string Secret { get; set; } = string.Empty;\n    public string Issuer { get; set; } = string.Empty;\n    public string Audience { get; set; } = string.Empty;\n    public int AccessTokenExpiryMinutes { get; set; } = 60;\n    public int RefreshTokenExpiryDays { get; set; } = 7;\n}\n```\n\n### 4. Generate Password Hasher\n\n**IPasswordHasher.cs**:\n```csharp\nnamespace {{Namespace}}.Infrastructure.Security.Password;\n\npublic interface IPasswordHasher\n{\n    string HashPassword(string password);\n    bool VerifyPassword(string password, string hashedPassword);\n}\n```\n\n**PasswordHasher.cs**:\n```csharp\nusing System.Security.Cryptography;\n\nnamespace {{Namespace}}.Infrastructure.Security.Password;\n\npublic class PasswordHasher : IPasswordHasher\n{\n    private const int SaltSize = 16;\n    private const int HashSize = 32;\n    private const int Iterations = 100000;\n    private static readonly HashAlgorithmName Algorithm = HashAlgorithmName.SHA256;\n\n    public string HashPassword(string password)\n    {\n        var salt = RandomNumberGenerator.GetBytes(SaltSize);\n        var hash = Rfc2898DeriveBytes.Pbkdf2(\n            password, salt, Iterations, Algorithm, HashSize);\n\n        return $\"{Convert.ToBase64String(salt)}.{Convert.ToBase64String(hash)}\";\n    }\n\n    public bool VerifyPassword(string password, string hashedPassword)\n    {\n        var parts = hashedPassword.Split('.');\n        if (parts.Length != 2) return false;\n\n        var salt = Convert.FromBase64String(parts[0]);\n        var hash = Convert.FromBase64String(parts[1]);\n\n        var computedHash = Rfc2898DeriveBytes.Pbkdf2(\n            password, salt, Iterations, Algorithm, HashSize);\n\n        return CryptographicOperations.FixedTimeEquals(hash, computedHash);\n    }\n}\n```\n\n### 5. Generate Authentication Extension\n\n**AuthenticationExtensions.cs**:\n```csharp\nusing System.Text;\nusing Microsoft.AspNetCore.Authentication.JwtBearer;\nusing Microsoft.Extensions.Configuration;\nusing Microsoft.Extensions.DependencyInjection;\nusing Microsoft.IdentityModel.Tokens;\nusing {{Namespace}}.Infrastructure.Security.Jwt;\nusing {{Namespace}}.Infrastructure.Security.Password;\n\nnamespace {{Namespace}}.Infrastructure.Security.Extensions;\n\npublic static class AuthenticationExtensions\n{\n    public static IServiceCollection AddJwtAuthentication(\n        this IServiceCollection services,\n        IConfiguration configuration)\n    {\n        var jwtSettings = new JwtSettings();\n        configuration.Bind(JwtSettings.SectionName, jwtSettings);\n        services.Configure<JwtSettings>(configuration.GetSection(JwtSettings.SectionName));\n\n        services.AddScoped<IJwtTokenGenerator, JwtTokenGenerator>();\n        services.AddScoped<IPasswordHasher, PasswordHasher>();\n\n        services.AddAuthentication(options =>\n        {\n            options.DefaultAuthenticateScheme = JwtBearerDefaults.AuthenticationScheme;\n            options.DefaultChallengeScheme = JwtBearerDefaults.AuthenticationScheme;\n        })\n        .AddJwtBearer(options =>\n        {\n            options.TokenValidationParameters = new TokenValidationParameters\n            {\n                ValidateIssuer = true,\n                ValidateAudience = true,\n                ValidateLifetime = true,\n                ValidateIssuerSigningKey = true,\n                ValidIssuer = jwtSettings.Issuer,\n                ValidAudience = jwtSettings.Audience,\n                IssuerSigningKey = new SymmetricSecurityKey(\n                    Encoding.UTF8.GetBytes(jwtSettings.Secret)),\n                ClockSkew = TimeSpan.Zero\n            };\n        });\n\n        services.AddAuthorization(options =>\n        {\n            options.AddPolicy(\"AdminOnly\", policy =>\n                policy.RequireRole(\"Admin\"));\n\n            options.AddPolicy(\"UserOrAdmin\", policy =>\n                policy.RequireRole(\"User\", \"Admin\"));\n        });\n\n        return services;\n    }\n}\n```\n\n### 6. Generate Login Command\n\n**LoginCommand.cs**:\n```csharp\nusing MediatR;\nusing {{Namespace}}.Application.Authentication.DTOs;\nusing {{Namespace}}.Domain.Common;\n\nnamespace {{Namespace}}.Application.Authentication.Commands.Login;\n\npublic record LoginCommand(string Email, string Password) : IRequest<Result<AuthResponse>>;\n```\n\n**LoginCommandHandler.cs**:\n```csharp\nusing MediatR;\nusing {{Namespace}}.Application.Authentication.DTOs;\nusing {{Namespace}}.Domain.Common;\nusing {{Namespace}}.Domain.Repositories;\nusing {{Namespace}}.Infrastructure.Security.Jwt;\nusing {{Namespace}}.Infrastructure.Security.Password;\n\nnamespace {{Namespace}}.Application.Authentication.Commands.Login;\n\npublic class LoginCommandHandler : IRequestHandler<LoginCommand, Result<AuthResponse>>\n{\n    private readonly IUserRepository _userRepository;\n    private readonly IJwtTokenGenerator _jwtTokenGenerator;\n    private readonly IPasswordHasher _passwordHasher;\n\n    public LoginCommandHandler(\n        IUserRepository userRepository,\n        IJwtTokenGenerator jwtTokenGenerator,\n        IPasswordHasher passwordHasher)\n    {\n        _userRepository = userRepository;\n        _jwtTokenGenerator = jwtTokenGenerator;\n        _passwordHasher = passwordHasher;\n    }\n\n    public async Task<Result<AuthResponse>> Handle(\n        LoginCommand request,\n        CancellationToken cancellationToken)\n    {\n        var user = await _userRepository.GetByEmailAsync(request.Email, cancellationToken);\n\n        if (user is null)\n            return Result<AuthResponse>.Failure(\"Invalid credentials\");\n\n        if (!_passwordHasher.VerifyPassword(request.Password, user.PasswordHash))\n            return Result<AuthResponse>.Failure(\"Invalid credentials\");\n\n        var roles = await _userRepository.GetRolesAsync(user.Id, cancellationToken);\n        var accessToken = _jwtTokenGenerator.GenerateAccessToken(user.Id, user.Email, roles);\n        var refreshToken = _jwtTokenGenerator.GenerateRefreshToken();\n\n        // Store refresh token (implement based on your needs)\n        user.SetRefreshToken(refreshToken, DateTime.UtcNow.AddDays(7));\n        await _userRepository.UpdateAsync(user, cancellationToken);\n\n        return Result<AuthResponse>.Success(new AuthResponse(\n            accessToken,\n            refreshToken,\n            DateTime.UtcNow.AddMinutes(60)));\n    }\n}\n```\n\n### 7. Generate Auth Controller\n\n**AuthController.cs**:\n```csharp\nusing MediatR;\nusing Microsoft.AspNetCore.Authorization;\nusing Microsoft.AspNetCore.Mvc;\nusing {{Namespace}}.Application.Authentication.Commands.Login;\nusing {{Namespace}}.Application.Authentication.Commands.Register;\nusing {{Namespace}}.Application.Authentication.Commands.RefreshToken;\nusing {{Namespace}}.Application.Authentication.DTOs;\n\nnamespace {{Namespace}}.Api.Controllers;\n\n[ApiController]\n[Route(\"api/[controller]\")]\n[Produces(\"application/json\")]\npublic class AuthController : ControllerBase\n{\n    private readonly IMediator _mediator;\n\n    public AuthController(IMediator mediator)\n    {\n        _mediator = mediator;\n    }\n\n    /// <summary>\n    /// Register a new user.\n    /// </summary>\n    [HttpPost(\"register\")]\n    [AllowAnonymous]\n    [ProducesResponseType(typeof(AuthResponse), StatusCodes.Status201Created)]\n    [ProducesResponseType(typeof(ProblemDetails), StatusCodes.Status400BadRequest)]\n    public async Task<IActionResult> Register(\n        [FromBody] RegisterRequest request,\n        CancellationToken ct)\n    {\n        var command = new RegisterCommand(request.Email, request.Password, request.Name);\n        var result = await _mediator.Send(command, ct);\n\n        if (result.IsFailure)\n            return BadRequest(result.Error);\n\n        return CreatedAtAction(nameof(Register), result.Value);\n    }\n\n    /// <summary>\n    /// Login with email and password.\n    /// </summary>\n    [HttpPost(\"login\")]\n    [AllowAnonymous]\n    [ProducesResponseType(typeof(AuthResponse), StatusCodes.Status200OK)]\n    [ProducesResponseType(typeof(ProblemDetails), StatusCodes.Status401Unauthorized)]\n    public async Task<IActionResult> Login(\n        [FromBody] LoginRequest request,\n        CancellationToken ct)\n    {\n        var command = new LoginCommand(request.Email, request.Password);\n        var result = await _mediator.Send(command, ct);\n\n        if (result.IsFailure)\n            return Unauthorized(result.Error);\n\n        return Ok(result.Value);\n    }\n\n    /// <summary>\n    /// Refresh access token.\n    /// </summary>\n    [HttpPost(\"refresh\")]\n    [AllowAnonymous]\n    [ProducesResponseType(typeof(AuthResponse), StatusCodes.Status200OK)]\n    [ProducesResponseType(typeof(ProblemDetails), StatusCodes.Status401Unauthorized)]\n    public async Task<IActionResult> RefreshToken(\n        [FromBody] RefreshTokenRequest request,\n        CancellationToken ct)\n    {\n        var command = new RefreshTokenCommand(request.RefreshToken);\n        var result = await _mediator.Send(command, ct);\n\n        if (result.IsFailure)\n            return Unauthorized(result.Error);\n\n        return Ok(result.Value);\n    }\n}\n```\n\n### 8. Update appsettings.json\n\nAdd JWT configuration:\n```json\n{\n  \"JwtSettings\": {\n    \"Secret\": \"your-256-bit-secret-key-minimum-32-characters\",\n    \"Issuer\": \"https://yourdomain.com\",\n    \"Audience\": \"https://yourdomain.com\",\n    \"AccessTokenExpiryMinutes\": 60,\n    \"RefreshTokenExpiryDays\": 7\n  }\n}\n```\n\n## Security Checklist\n\n- [ ] Secret key is at least 256 bits (32 characters)\n- [ ] Secret stored in environment variable or secrets manager\n- [ ] Password hashing uses modern algorithm (PBKDF2/Argon2)\n- [ ] Token expiry is reasonable (1 hour access, 7 days refresh)\n- [ ] Refresh token rotation implemented\n- [ ] HTTPS required in production\n- [ ] Rate limiting on auth endpoints\n\n## Output\n\n```markdown\n## JWT Authentication Added\n\n### Files Created\n**Infrastructure Layer:**\n- Security/Jwt/IJwtTokenGenerator.cs\n- Security/Jwt/JwtTokenGenerator.cs\n- Security/Jwt/JwtSettings.cs\n- Security/Password/IPasswordHasher.cs\n- Security/Password/PasswordHasher.cs\n- Security/Extensions/AuthenticationExtensions.cs\n\n**Application Layer:**\n- Authentication/Commands/Login/LoginCommand.cs\n- Authentication/Commands/Login/LoginCommandHandler.cs\n- Authentication/Commands/Register/RegisterCommand.cs\n- Authentication/Commands/Register/RegisterCommandHandler.cs\n- Authentication/DTOs/AuthResponse.cs\n- Authentication/DTOs/LoginRequest.cs\n- Authentication/DTOs/RegisterRequest.cs\n\n**API Layer:**\n- Controllers/AuthController.cs\n\n### Configuration Required\nAdd to appsettings.json (use secrets in production):\n```json\n{\n  \"JwtSettings\": {\n    \"Secret\": \"your-256-bit-secret\",\n    \"Issuer\": \"https://yourdomain.com\",\n    \"Audience\": \"https://yourdomain.com\"\n  }\n}\n```\n\n### Registration\nAdd to Program.cs:\n```csharp\nbuilder.Services.AddJwtAuthentication(builder.Configuration);\n```\n\n### Usage\n- POST /api/auth/register - Register new user\n- POST /api/auth/login - Get access token\n- POST /api/auth/refresh - Refresh access token\n```\n\n## Example\n\n```\nUser: /add-auth --refresh-tokens --roles --story ACF-060\n\nClaude: Adding JWT authentication with refresh tokens and role-based authorization...\n\nCreating security infrastructure:\n1. JWT token generator with refresh token support\n2. Password hasher (PBKDF2-SHA256)\n3. Authentication extension for DI\n\nCreating application layer:\n4. Register command with validation\n5. Login command with refresh token\n6. RefreshToken command\n\nCreating API layer:\n7. AuthController with endpoints\n\nJWT authentication added successfully.\n\nNext steps:\n1. Add JwtSettings to appsettings.json\n2. Call builder.Services.AddJwtAuthentication() in Program.cs\n3. Add User entity if not exists\n4. Implement IUserRepository\n```\n"
    }
  }
}