version: '3.8'

# Development-specific overrides
# Usage: docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

services:
  frontend:
    build:
      context: .
      dockerfile: Dockerfile.dev
    volumes:
      - .:/app
      - /app/node_modules
      - /app/.next
    environment:
      - NODE_ENV=development
      - NEXT_PUBLIC_API_URL=http://localhost:5000/api
    ports:
      - "3000:3000"

  api:
    image: projectname-api:dev
    ports:
      - "5000:8080"
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ConnectionStrings__DefaultConnection=Host=db;Database=projectname;Username=projectname;Password=projectname
      - ConnectionStrings__Redis=redis:6379
      - Jwt__Secret=dev-secret-key-min-32-characters-long
      - CORS__AllowedOrigins=http://localhost:3000

  db:
    ports:
      - "5432:5432"

  redis:
    ports:
      - "6379:6379"

  # pgAdmin for database management (dev only)
  pgadmin:
    image: dpage/pgadmin4:latest
    ports:
      - "5050:80"
    environment:
      - PGADMIN_DEFAULT_EMAIL=admin@example.com
      - PGADMIN_DEFAULT_PASSWORD=admin
    depends_on:
      - db
    networks:
      - app-network
    profiles:
      - tools
