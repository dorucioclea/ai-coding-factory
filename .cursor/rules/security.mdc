---
description: Security rules for .NET and TypeScript - OWASP Top 10, input validation, secrets management
globs: ["**/*.cs", "**/*.ts", "**/*.tsx", "**/*.json", "**/*.yaml"]
alwaysApply: true
---

# Security Rules for Cursor

## Never Do
- Hardcode secrets, API keys, tokens, or passwords
- Concatenate user input into SQL queries
- Use `dangerouslySetInnerHTML` without sanitization
- Store tokens in localStorage (use httpOnly cookies)
- Log passwords or sensitive data
- Expose stack traces to users

## Always Do
- Validate all user inputs (Zod for TS, FluentValidation for .NET)
- Use parameterized queries or ORM
- Implement authorization checks on every endpoint
- Use IConfiguration/.env for secrets
- Sanitize HTML before rendering
- Add security headers (CSP, X-Frame-Options)

## Input Validation

### TypeScript
```typescript
import { z } from 'zod'
const schema = z.object({
  email: z.string().email(),
  age: z.number().int().min(0).max(150)
})
const validated = schema.parse(input)
```

### .NET
```csharp
public class Validator : AbstractValidator<Dto>
{
    public Validator()
    {
        RuleFor(x => x.Email).NotEmpty().EmailAddress();
        RuleFor(x => x.Age).InclusiveBetween(0, 150);
    }
}
```

## Before PR Merge
- [ ] No hardcoded secrets
- [ ] All inputs validated
- [ ] Authorization checks present
- [ ] SQL injection prevented
- [ ] XSS prevented
- [ ] Dependencies scanned (`npm audit` / `dotnet list package --vulnerable`)
