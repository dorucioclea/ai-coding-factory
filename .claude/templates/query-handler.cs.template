// CQRS Query Handler Template
// Story: {{StoryId}}
// Generated by Claude Code

using MediatR;
using Microsoft.Extensions.Logging;
using {{Namespace}}.Domain.Repositories;

namespace {{Namespace}}.Application.Queries.{{Feature}};

// Query
public record {{QueryName}}Query(
    {{QueryProperties}}
) : IRequest<{{ReturnType}}?>;

// Handler
public class {{QueryName}}Handler : IRequestHandler<{{QueryName}}Query, {{ReturnType}}?>
{
    private readonly I{{EntityName}}Repository _repository;
    private readonly ILogger<{{QueryName}}Handler> _logger;

    public {{QueryName}}Handler(
        I{{EntityName}}Repository repository,
        ILogger<{{QueryName}}Handler> logger)
    {
        _repository = repository;
        _logger = logger;
    }

    public async Task<{{ReturnType}}?> Handle(
        {{QueryName}}Query request,
        CancellationToken cancellationToken)
    {
        _logger.LogInformation(
            "Handling {{QueryName}} query for {EntityId}",
            request./* EntityId property */);

        var entity = await _repository.GetByIdAsync(
            request./* EntityId property */,
            cancellationToken);

        if (entity is null)
        {
            _logger.LogWarning(
                "Entity not found for {{QueryName}} query: {EntityId}",
                request./* EntityId property */);
            return null;
        }

        return entity.ToDto();
    }
}
